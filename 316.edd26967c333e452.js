(self.webpackChunkshell=self.webpackChunkshell||[]).push([[316],{4316:(V,g,a)=>{a.r(g),a.d(g,{bootstrap:()=>B});var C=a(1194),f=a(3319),m=a(5315),y=a(467),t=a(5565),w=a(7412),b=a(1913);const E=["container"];let j=(()=>{class o{constructor(){this.name=""}ngAfterViewInit(){var e=this;return(0,y.A)(function*(){const n=w.A.map(({remoteName:s,exposedModule:u})=>({remoteName:s,exposedModule:u})).find(({remoteName:s})=>s===e.name);if(!n)return;const r=yield(0,b.loadRemoteModule)(n);e.remoteContainer.createComponent(r.AppComponent)})()}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-mfe-wrapper"]],viewQuery:function(n,r){if(1&n&&t.\u0275\u0275viewQuery(E,7,t.ViewContainerRef),2&n){let s;t.\u0275\u0275queryRefresh(s=t.\u0275\u0275loadQuery())&&(r.remoteContainer=s.first)}},inputs:{name:"name"},standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:4,vars:0,consts:[["container",""]],template:function(n,r){1&n&&(t.\u0275\u0275elementStart(0,"p"),t.\u0275\u0275text(1,"mfe-wrapper works!"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainer(2,null,0))},changeDetection:0})}}return o})();var c=a(1663);let I=(()=>{class o{constructor(e){this.http=e}login(){window.location.href="http://localhost:4000/auth/login"}logout(){window.location.href="http://localhost:4000/auth/logout"}getUserProfile(){return this.http.get("http://localhost:4000/auth/me",{withCredentials:!0})}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275inject(c.HttpClient))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var k=a(8662);function F(o,d){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div")(1,"p"),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"button",6),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const r=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(r.logout())}),t.\u0275\u0275text(4,"Logout"),t.\u0275\u0275elementEnd()()}if(2&o){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("Welcome, ",e.user.name||e.user.email,"")}}function T(o,d){if(1&o){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",6),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const r=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(r.login())}),t.\u0275\u0275text(1,"Login"),t.\u0275\u0275elementEnd()}}let R=(()=>{class o{constructor(e,n){this.auth=e,this.k=n,this.title="shell-module",this.user=null,this.mfe1="pokemon"}ngOnInit(){this.fetchUser()}login(){this.auth.login()}logout(){this.auth.logout()}fetchUser(){this.auth.getUserProfile().subscribe(e=>this.user=e)}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275directiveInject(I),t.\u0275\u0275directiveInject(k.AuthService))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-root"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:11,vars:3,consts:[["loginTemplate",""],["routerLink","/funny"],["routerLink","/lazy"],[4,"ngIf","ngIfElse"],["id","main"],[3,"name"],[3,"click"]],template:function(n,r){if(1&n&&(t.\u0275\u0275elementStart(0,"div")(1,"a",1),t.\u0275\u0275text(2,"Funny"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"a",2),t.\u0275\u0275text(4,"Lazy Load"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(5,F,5,1,"div",3)(6,T,2,0,"ng-template",null,0,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementStart(8,"section",4),t.\u0275\u0275element(9,"router-outlet"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(10,"app-mfe-wrapper",5)),2&n){const s=t.\u0275\u0275reference(7);t.\u0275\u0275advance(5),t.\u0275\u0275property("ngIf",r.user)("ngIfElse",s),t.\u0275\u0275advance(5),t.\u0275\u0275property("name",r.mfe1)}},dependencies:[f.RouterOutlet,m.CommonModule,m.NgIf,f.RouterLink,j]})}}return o})();var v=a(8049),i=a(4866);let z=(()=>{class o{constructor(e){this.$http=e,this.$masterSet=new i.BehaviorSubject([]),this.$loadMoreEvent=new i.BehaviorSubject(""),this.url="https://pokeapi.co/api/v2/pokemon/?offset=0&limit=20",this.$http.get(this.url).pipe((0,i.tap)(({next:n})=>{this.next=n}),(0,i.map)(({results:n})=>n)).subscribe(n=>this.$masterSet.next(n)),this.$loadMoreEvent.pipe((0,i.debounceTime)(500)).subscribe(n=>{"loadMore"===n&&this.loadMore()})}loadMore(){this.next&&this.$http.get(this.next).pipe((0,i.tap)(({next:e})=>{this.next=e}),(0,i.map)(({results:e})=>e)).subscribe(e=>{this.$masterSet.next([...this.$masterSet.value,...e])})}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275inject(c.HttpClient))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),A=(()=>{class o{constructor(e){this.zone=e}start(e){this.eventSource=new EventSource(e);const n=this.eventSource;return new i.Observable(r=>{const s=(0,i.fromEvent)(n,"message").subscribe(u=>{this.zone.run(()=>r.next(u.data))});return n.onerror=u=>{this.zone.run(()=>r.error(u))},()=>{s.unsubscribe(),n.close()}})}stop(){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0)}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275inject(t.NgZone))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function L(o,d){if(1&o&&(t.\u0275\u0275elementStart(0,"li"),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&o){const e=d.$implicit;t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(e.name)}}let M=(()=>{class o{constructor(e,n,r){this.pokemonService=e,this.destroyRef=n,this.sseService=r,this.messages=[],(0,i.fromEvent)(window,"scroll").pipe((0,v.takeUntilDestroyed)(this.destroyRef),(0,i.map)(()=>window.scrollY+window.innerHeight>=document.body.scrollHeight),(0,i.distinctUntilChanged)(),(0,i.filter)(s=>!0===s)).subscribe(()=>{this.pokemonService.$loadMoreEvent.next("loadMore")}),console.log("LazyloadComponent constructed")}referId(e,n){return n.name}ngOnInit(){}start(){this.sseService.start("https://stream.wikimedia.org/v2/stream/recentchange").pipe((0,v.takeUntilDestroyed)(this.destroyRef)).subscribe({next:e=>{console.log("SSE:",e),this.messages.push(e)},error:e=>console.error("SSE error",e)})}stop(){console.log("SSE stopped"),this.sseService.stop()}ngOnDestroy(){console.log("LazyloadComponent destroyed")}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275directiveInject(z),t.\u0275\u0275directiveInject(t.DestroyRef),t.\u0275\u0275directiveInject(A))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-lazyload"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:9,vars:4,consts:[[1,"px-4","py-2","bg-green-500","text-white","rounded","mr-2",3,"click"],[1,"px-4","py-2","bg-red-500","text-white","rounded",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(n,r){1&n&&(t.\u0275\u0275elementStart(0,"p"),t.\u0275\u0275text(1,"lazyload works!"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(2,"button",0),t.\u0275\u0275listener("click",function(){return r.start()}),t.\u0275\u0275text(3,"Start"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"button",1),t.\u0275\u0275listener("click",function(){return r.stop()}),t.\u0275\u0275text(5,"Stop"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"ul"),t.\u0275\u0275template(7,L,2,1,"li",2),t.\u0275\u0275pipe(8,"async"),t.\u0275\u0275elementEnd()),2&n&&(t.\u0275\u0275advance(7),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(8,2,r.pokemonService.$masterSet))("ngForTrackBy",r.referId))},dependencies:[m.CommonModule,m.NgForOf,m.AsyncPipe]})}}return o})();var O=a(762),$=a.n(O);let P=(()=>{class o{constructor(){this.emitter=$()();const e=new Event("EventBusServiceCreated");this.onePlusNEvents=new i.ReplaySubject(100),this.onePlusNEvents.next(e.type),this.emitter.on("*",n=>this.onePlusNEvents.next(n))}sendEvent(e){this.emitter.emit(e)}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();const N=[{path:"lazy",component:M},{path:"funny",component:(()=>{class o{constructor(e,n){this.eventBus=e,this.destroyRef=n,this.eventBus.onePlusNEvents.pipe((0,v.takeUntilDestroyed)(this.destroyRef),(0,i.filter)(r=>"JOJO"===r)).subscribe(this.catchJojo)}catchJojo(e){console.log("PUTIN!!")}static{this.\u0275fac=function(n){return new(n||o)(t.\u0275\u0275directiveInject(P),t.\u0275\u0275directiveInject(t.DestroyRef))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:o,selectors:[["app-funny"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:2,vars:0,template:function(n,r){1&n&&(t.\u0275\u0275elementStart(0,"p"),t.\u0275\u0275text(1,"funny works!"),t.\u0275\u0275elementEnd())}})}}return o})()}],U=(o,d)=>new i.Observable(e=>{let n;return(0,y.A)(function*(){const{urlWithParams:s}=o,S=yield caches.open("http"),h=yield S.match(s);if(h){let l;console.log("Serve from Cache for",s);try{l=yield h.clone().json()}catch{l=yield h.clone().text()}return e.next(new c.HttpResponse({body:l,status:h.status||200,url:o.urlWithParams})),void e.complete()}var l;n=d(o).subscribe({next:(l=(0,y.A)(function*(p){if(console.log("Cache miss for ",s),e.next(p),p instanceof c.HttpResponse&&p.ok){const x=new Response(JSON.stringify(p.body),{headers:{"Content-Type":"application/json"},status:p.status,statusText:p.statusText});yield S.put(o.urlWithParams,x)}}),function(x){return l.apply(this,arguments)}),error:l=>e.error(l),complete:()=>e.complete()})})(),()=>n?.unsubscribe()});function B(){return(0,C.bootstrapApplication)(R,{providers:[(0,f.provideRouter)(N),(0,c.provideHttpClient)((0,c.withFetch)(),(0,c.withInterceptors)([U]))]})}}}]);