(self.webpackChunkshell=self.webpackChunkshell||[]).push([[316],{4316:(W,b,i)=>{i.r(b),i.d(b,{bootstrap:()=>H});var C=i(1194),g=i(467),h=i(3319),f=i(5315),t=i(5565),S=i(7412),w=i(1913);const I=["container"];let k=(()=>{class n{constructor(){this.name=""}ngAfterViewInit(){var e=this;return(0,g.A)(function*(){const o=S.A.map(({remoteName:s,exposedModule:c})=>({remoteName:s,exposedModule:c})).find(({remoteName:s})=>s===e.name);if(!o)return;const r=yield(0,w.loadRemoteModule)(o);e.remoteContainer.createComponent(r.AppComponent)})()}static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-mfe-wrapper"]],viewQuery:function(o,r){if(1&o&&t.\u0275\u0275viewQuery(I,7,t.ViewContainerRef),2&o){let s;t.\u0275\u0275queryRefresh(s=t.\u0275\u0275loadQuery())&&(r.remoteContainer=s.first)}},inputs:{name:"name"},standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:4,vars:0,consts:[["container",""]],template:function(o,r){1&o&&(t.\u0275\u0275elementStart(0,"p"),t.\u0275\u0275text(1,"mfe-wrapper works!"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainer(2,null,0))},changeDetection:0})}}return n})();var a=i(4866),p=i(1663);let E=(()=>{class n{constructor(e){this.http=e}login(){window.location.href="http://localhost:4000/auth/login"}logout(){window.location.href="http://localhost:4000/auth/logout"}getUserProfile(){return this.http.get("http://localhost:4000/auth/me",{withCredentials:!0})}static{this.\u0275fac=function(o){return new(o||n)(t.\u0275\u0275inject(p.HttpClient))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var j=i(8662);function A(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"span",11),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&n){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" Welcome, ",e.userInfo.name||e.userInfo.email||"User","! ")}}function T(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",12),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const r=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(r.login())}),t.\u0275\u0275text(1," Login with Zitadel "),t.\u0275\u0275elementEnd()}}function P(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",13),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const r=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(r.logout())}),t.\u0275\u0275text(1," Logout "),t.\u0275\u0275elementEnd()}}function R(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div")(1,"p"),t.\u0275\u0275text(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"button",14),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const r=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(r.logout())}),t.\u0275\u0275text(4,"Logout"),t.\u0275\u0275elementEnd()()}if(2&n){const e=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1("Welcome, ",e.user.name||e.user.email,"")}}function F(n,l){if(1&n){const e=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",14),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(e);const r=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(r.login())}),t.\u0275\u0275text(1,"Login"),t.\u0275\u0275elementEnd()}}let M=(()=>{class n{constructor(e,o,r,s){this.auth2=e,this.auth=o,this.route=r,this.router=s,this.title="shell-module",this.user=null,this.mfe1="pokemon",this.isAuthenticated=!1,this.userInfo=null,this.message="Processing authentication...",this.isProcessing=!0}ngOnInit(){var e=this;return(0,g.A)(function*(){let o=null,r=null,s=null;const c=yield(0,a.firstValueFrom)(e.route.queryParams);if(console.log("Hey Jude"," param =",c," code = ",c.code),c&&Object.keys(c).length>0)o=c.code??null,r=c.state??null,s=c.error??null;else{const u=new URLSearchParams(window.location.search);o=u.get("code"),r=u.get("state"),s=u.get("error")}if(s)return e.message=`Authentication failed: ${s}`,e.isProcessing=!1,void setTimeout(()=>e.router.navigate(["/"]),3e3);if(o&&r)try{(yield e.auth.handleCallback(o,r))?(e.message="Authentication successful! Redirecting...",e.isProcessing=!1,setTimeout(()=>e.router.navigate(["/"]),1500)):(e.message="Authentication failed. Redirecting...",e.isProcessing=!1,setTimeout(()=>e.router.navigate(["/"]),3e3))}catch{e.message="Authentication failed (exception). Redirecting...",e.isProcessing=!1,setTimeout(()=>e.router.navigate(["/"]),3e3)}else e.message="Invalid callback parameters. Redirecting...",e.isProcessing=!1,setTimeout(()=>e.router.navigate(["/"]),3e3)})()}login(){this.auth.login()}logout(){this.auth.logout()}fetchUser(){}static{this.\u0275fac=function(o){return new(o||n)(t.\u0275\u0275directiveInject(E),t.\u0275\u0275directiveInject(j.AuthService),t.\u0275\u0275directiveInject(h.ActivatedRoute),t.\u0275\u0275directiveInject(h.Router))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-root"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:23,vars:6,consts:[["loginTemplate",""],[1,"auth-header"],[1,"auth-info"],["class","user-name",4,"ngIf"],["class","auth-button",3,"click",4,"ngIf"],["class","auth-button logout-button",3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],["id","main"],["routerLink","/funny"],["routerLink","/lazy"],[3,"name"],[1,"user-name"],[1,"auth-button",3,"click"],[1,"auth-button","logout-button",3,"click"],[3,"click"]],template:function(o,r){if(1&o&&(t.\u0275\u0275elementStart(0,"div",1)(1,"div")(2,"strong"),t.\u0275\u0275text(3,"Pokemon App"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"div",2),t.\u0275\u0275template(5,A,2,1,"span",3)(6,T,2,0,"button",4)(7,P,2,0,"button",5),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(8,R,5,1,"div",6)(9,F,2,0,"ng-template",null,0,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementStart(11,"section",7)(12,"h3"),t.\u0275\u0275text(13,"Start of router content"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(14,"router-outlet"),t.\u0275\u0275elementStart(15,"h3"),t.\u0275\u0275text(16,"End of router content"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(17,"div")(18,"a",8),t.\u0275\u0275text(19,"Funny"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(20,"a",9),t.\u0275\u0275text(21,"Lazy Load"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275element(22,"app-mfe-wrapper",10)),2&o){const s=t.\u0275\u0275reference(10);t.\u0275\u0275advance(5),t.\u0275\u0275property("ngIf",r.isAuthenticated&&r.userInfo),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",!r.isAuthenticated),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",r.isAuthenticated),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",r.user)("ngIfElse",s),t.\u0275\u0275advance(14),t.\u0275\u0275property("name",r.mfe1)}},dependencies:[h.RouterOutlet,f.CommonModule,f.NgIf,h.RouterLink,k],styles:[".auth-header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;background:#fff;padding:1rem 2rem;border-bottom:1px solid var(--gray-400);display:flex;justify-content:space-between;align-items:center;z-index:1000;box-shadow:0 2px 4px #0000001a}.auth-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.user-name[_ngcontent-%COMP%]{color:var(--gray-900);font-weight:500}.auth-button[_ngcontent-%COMP%]{background:var(--bright-blue);color:#fff;border:none;padding:.5rem 1.5rem;border-radius:.5rem;font-size:.875rem;font-weight:500;cursor:pointer;transition:background .3s ease}.auth-button[_ngcontent-%COMP%]:hover{background:var(--electric-violet)}.logout-button[_ngcontent-%COMP%]{background:var(--hot-red)}.logout-button[_ngcontent-%COMP%]:hover{background:var(--orange-red)}"]})}}return n})();var y=i(8049);let O=(()=>{class n{constructor(e){this.$http=e,this.$masterSet=new a.BehaviorSubject([]),this.$loadMoreEvent=new a.BehaviorSubject(""),this.url="https://pokeapi.co/api/v2/pokemon/?offset=0&limit=20",this.$http.get(this.url).pipe((0,a.tap)(({next:o})=>{this.next=o}),(0,a.map)(({results:o})=>o)).subscribe(o=>this.$masterSet.next(o)),this.$loadMoreEvent.pipe((0,a.debounceTime)(500)).subscribe(o=>{"loadMore"===o&&this.loadMore()})}loadMore(){this.next&&this.$http.get(this.next).pipe((0,a.tap)(({next:e})=>{this.next=e}),(0,a.map)(({results:e})=>e)).subscribe(e=>{this.$masterSet.next([...this.$masterSet.value,...e])})}static{this.\u0275fac=function(o){return new(o||n)(t.\u0275\u0275inject(p.HttpClient))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),z=(()=>{class n{constructor(e){this.zone=e}start(e){this.eventSource=new EventSource(e);const o=this.eventSource;return new a.Observable(r=>{const s=(0,a.fromEvent)(o,"message").subscribe(c=>{this.zone.run(()=>r.next(c.data))});return o.onerror=c=>{this.zone.run(()=>r.error(c))},()=>{s.unsubscribe(),o.close()}})}stop(){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0)}static{this.\u0275fac=function(o){return new(o||n)(t.\u0275\u0275inject(t.NgZone))}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function L(n,l){if(1&n&&(t.\u0275\u0275elementStart(0,"li"),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&n){const e=l.$implicit;t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(e.name)}}let V=(()=>{class n{constructor(e,o,r){this.pokemonService=e,this.destroyRef=o,this.sseService=r,this.messages=[],(0,a.fromEvent)(window,"scroll").pipe((0,y.takeUntilDestroyed)(this.destroyRef),(0,a.map)(()=>window.scrollY+window.innerHeight>=document.body.scrollHeight),(0,a.distinctUntilChanged)(),(0,a.filter)(s=>!0===s)).subscribe(()=>{this.pokemonService.$loadMoreEvent.next("loadMore")}),console.log("LazyloadComponent constructed")}referId(e,o){return o.name}ngOnInit(){}start(){this.sseService.start("https://stream.wikimedia.org/v2/stream/recentchange").pipe((0,y.takeUntilDestroyed)(this.destroyRef)).subscribe({next:e=>{console.log("SSE:",e),this.messages.push(e)},error:e=>console.error("SSE error",e)})}stop(){console.log("SSE stopped"),this.sseService.stop()}ngOnDestroy(){console.log("LazyloadComponent destroyed")}static{this.\u0275fac=function(o){return new(o||n)(t.\u0275\u0275directiveInject(O),t.\u0275\u0275directiveInject(t.DestroyRef),t.\u0275\u0275directiveInject(z))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-lazyload"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:9,vars:4,consts:[[1,"px-4","py-2","bg-green-500","text-white","rounded","mr-2",3,"click"],[1,"px-4","py-2","bg-red-500","text-white","rounded",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(o,r){1&o&&(t.\u0275\u0275elementStart(0,"p"),t.\u0275\u0275text(1,"lazyload works!"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(2,"button",0),t.\u0275\u0275listener("click",function(){return r.start()}),t.\u0275\u0275text(3,"Start"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"button",1),t.\u0275\u0275listener("click",function(){return r.stop()}),t.\u0275\u0275text(5,"Stop"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"ul"),t.\u0275\u0275template(7,L,2,1,"li",2),t.\u0275\u0275pipe(8,"async"),t.\u0275\u0275elementEnd()),2&o&&(t.\u0275\u0275advance(7),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind1(8,2,r.pokemonService.$masterSet))("ngForTrackBy",r.referId))},dependencies:[f.CommonModule,f.NgForOf,f.AsyncPipe]})}}return n})();var _=i(762),$=i.n(_);let N=(()=>{class n{constructor(){this.emitter=$()();const e=new Event("EventBusServiceCreated");this.onePlusNEvents=new a.ReplaySubject(100),this.onePlusNEvents.next(e.type),this.emitter.on("*",o=>this.onePlusNEvents.next(o))}sendEvent(e){this.emitter.emit(e)}static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275prov=t.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const U=[{path:"lazy",component:V},{path:"funny",component:(()=>{class n{constructor(e,o){this.eventBus=e,this.destroyRef=o,this.eventBus.onePlusNEvents.pipe((0,y.takeUntilDestroyed)(this.destroyRef),(0,a.filter)(r=>"JOJO"===r)).subscribe(this.catchJojo)}catchJojo(e){console.log("PUTIN!!")}static{this.\u0275fac=function(o){return new(o||n)(t.\u0275\u0275directiveInject(N),t.\u0275\u0275directiveInject(t.DestroyRef))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-funny"]],standalone:!0,features:[t.\u0275\u0275StandaloneFeature],decls:2,vars:0,template:function(o,r){1&o&&(t.\u0275\u0275elementStart(0,"p"),t.\u0275\u0275text(1,"funny works!"),t.\u0275\u0275elementEnd())}})}}return n})()},{path:"auth-callback",loadComponent:()=>i.e(472).then(i.bind(i,4472)).then(n=>n.AuthCallbackComponent)}],B=(n,l)=>new a.Observable(e=>{let o;return(0,g.A)(function*(){const{urlWithParams:s}=n,u=yield caches.open("http"),v=yield u.match(s);if(v){let m;console.log("Serve from Cache for",s);try{m=yield v.clone().json()}catch{m=yield v.clone().text()}return e.next(new p.HttpResponse({body:m,status:v.status||200,url:n.urlWithParams})),void e.complete()}var m;o=l(n).subscribe({next:(m=(0,g.A)(function*(d){if(console.log("Cache miss for ",s),e.next(d),d instanceof p.HttpResponse&&d.ok){const x=new Response(JSON.stringify(d.body),{headers:{"Content-Type":"application/json"},status:d.status,statusText:d.statusText});yield u.put(n.urlWithParams,x)}}),function(x){return m.apply(this,arguments)}),error:m=>e.error(m),complete:()=>e.complete()})})(),()=>o?.unsubscribe()});function H(){return(0,C.bootstrapApplication)(M,{providers:[(0,h.provideRouter)(U),(0,p.provideHttpClient)((0,p.withFetch)(),(0,p.withInterceptors)([B]))]})}}}]);