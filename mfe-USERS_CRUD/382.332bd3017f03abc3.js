(self.webpackChunkmfe_USERS_CRUD=self.webpackChunkmfe_USERS_CRUD||[]).push([[382,1],{9001:(A,m,e)=>{e.r(m),e.d(m,{AuthService:()=>y,CoreServicesComponent:()=>p,CoreServicesService:()=>a,OrganizationService:()=>w,ProductCategory:()=>I,RoleManagementService:()=>x,RoleService:()=>_,SalesDataService:()=>U,SalesStatus:()=>O,SystemRole:()=>b,TeamService:()=>K,UserRole:()=>f,UserService:()=>C});var o=e(4332);let a=(()=>{class v{constructor(){}static{this.\u0275fac=function(t){return new(t||v)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})();var h=e(467),n=e(3425),l=e(4230);let y=(()=>{class v{constructor(r){this.http=r,this.id="auth of pokemon",this.ISSUER_BASE_URL="https://topfix-wrczmn.us1.zitadel.cloud",this.CLIENT_ID="336777344075263315",this.REDIRECT_URI="https://opensourcekd.github.io/pokemon/#/auth-callback",this.SCOPE="openid profile email",this.TOKEN_KEY="zitadel_token",this.USER_INFO_KEY="zitadel_user_info",this.userSubject=new n.BehaviorSubject(this.getUserInfoFromStorage()),this.user$=this.userSubject.asObservable(),console.log("In constructor of auth service in pokemon")}login(r){r&&console.log(`[AuthService] Logged in: ${r}`),this.redirectToZitadelLogin()}redirectToZitadelLogin(){const r=new URL(`${this.ISSUER_BASE_URL}/oauth/v2/authorize`),t=this.generateRandomState(),d=this.generateCodeVerifier();sessionStorage.setItem("oauth_state",t),sessionStorage.setItem("code_verifier",d),r.searchParams.append("client_id",this.CLIENT_ID),r.searchParams.append("redirect_uri",this.REDIRECT_URI),r.searchParams.append("response_type","code"),r.searchParams.append("scope",this.SCOPE),r.searchParams.append("state",t),window.location.href=r.toString()}handleCallback(r,t){var d=this;return(0,h.A)(function*(){const S=sessionStorage.getItem("oauth_state");if(t!==S)return console.error("State mismatch - possible CSRF attack"),!1;try{const R=yield d.exchangeCodeForToken(r);d.setToken(R.access_token);const z=d.decodeIdToken(R.id_token);return d.setUserInfo(z),sessionStorage.removeItem("oauth_state"),sessionStorage.removeItem("code_verifier"),!0}catch(R){return console.error("Error exchanging code for token:",R),!1}})()}exchangeCodeForToken(r){var t=this;return(0,h.A)(function*(){const d=`${t.ISSUER_BASE_URL}/oauth/v2/token`,S=new URLSearchParams({grant_type:"authorization_code",code:r,redirect_uri:t.REDIRECT_URI,client_id:t.CLIENT_ID}),R=yield fetch(d,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:S.toString()});if(!R.ok)throw new Error(`Token exchange failed: ${R.statusText}`);return R.json()})()}decodeIdToken(r){try{const t=r.split(".")[1],d=JSON.parse(atob(t));return{sub:d.sub,name:d.name,email:d.email}}catch(t){return console.error("Error decoding ID token:",t),{sub:""}}}logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_INFO_KEY),this.userSubject.next(null)}getToken(){return localStorage.getItem(this.TOKEN_KEY)}setToken(r){localStorage.setItem(this.TOKEN_KEY,r)}isAuthenticated(){return!!this.getToken()}getUser(){return this.userSubject.value}getUserInfoFromStorage(){const r=localStorage.getItem(this.USER_INFO_KEY);return r?JSON.parse(r):null}setUserInfo(r){localStorage.setItem(this.USER_INFO_KEY,JSON.stringify(r)),this.userSubject.next(r)}generateRandomState(){const r=new Uint8Array(32);return crypto.getRandomValues(r),Array.from(r,t=>t.toString(16).padStart(2,"0")).join("")}generateCodeVerifier(){const r=new Uint8Array(32);return crypto.getRandomValues(r),Array.from(r,t=>t.toString(16).padStart(2,"0")).join("")}static{this.\u0275fac=function(t){return new(t||v)(o.\u0275\u0275inject(l.HttpClient))}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})(),p=(()=>{class v{static{this.\u0275fac=function(t){return new(t||v)}}static{this.\u0275cmp=o.\u0275\u0275defineComponent({type:v,selectors:[["org-core-services"]],standalone:!0,features:[o.\u0275\u0275StandaloneFeature],decls:2,vars:0,template:function(t,d){1&t&&(o.\u0275\u0275elementStart(0,"p"),o.\u0275\u0275text(1," core-services works! "),o.\u0275\u0275elementEnd())}})}}return v})();var f=function(v){return v.SUPER_ADMIN="super-admin",v.ORG_ADMIN="org-admin",v.TEAM_LEAD="team-lead",v.SALES_EXECUTIVE="sales-executive",v}(f||{});let _=(()=>{class v{constructor(r){this.currentUserSubject=new n.BehaviorSubject(this.getDummyUser()),this.currentUser$=this.currentUserSubject.asObservable(),this.dataService=r}getCurrentUser(){return this.currentUserSubject.value}setCurrentUser(r){this.currentUserSubject.next(r)}hasRole(r){return this.getCurrentUser()?.role===r}hasAnyRole(r){const t=this.getCurrentUser();return!!t&&r.includes(t.role)}isAdmin(){return this.hasAnyRole([f.SUPER_ADMIN,f.ORG_ADMIN])}isTeamLeadOrHigher(){return this.hasAnyRole([f.SUPER_ADMIN,f.ORG_ADMIN,f.TEAM_LEAD])}getAllUsers(){return[{id:"user-1",name:"John Admin",email:"john.admin@company.com",role:f.SUPER_ADMIN},{id:"user-2",name:"Sarah Manager",email:"sarah.manager@company.com",role:f.ORG_ADMIN},{id:"user-3",name:"Mike Lead",email:"mike.lead@company.com",role:f.TEAM_LEAD,teamId:"team-1"},{id:"user-4",name:"Alice Sales",email:"alice.sales@company.com",role:f.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"},{id:"user-5",name:"Bob Sales",email:"bob.sales@company.com",role:f.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"},{id:"user-6",name:"Carol Sales",email:"carol.sales@company.com",role:f.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"}]}getViewableUsers(){const r=this.getCurrentUser();if(!r)return[];const t=this.getAllUsers();return this.isTeamLeadOrHigher()?t.filter(d=>d.role===f.SALES_EXECUTIVE||d.id===r.id):t.filter(d=>d.id===r.id)}getDummyUser(){return{id:"user-4",name:"Alice Sales",email:"alice.sales@company.com",role:f.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"}}static{this.\u0275fac=function(t){return new(t||v)(o.\u0275\u0275inject("DataService",8))}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})();var E=e(3103),O=function(v){return v.COMPLETED="completed",v.PENDING="pending",v.CANCELLED="cancelled",v}(O||{}),I=function(v){return v.ELECTRONICS="Electronics",v.SOFTWARE="Software",v.SERVICES="Services",v.HARDWARE="Hardware",v}(I||{});let U=(()=>{class v{constructor(r){this.dummySalesData=this.generateDummyData(),this.dataService=r}getSalesHistory(r,t,d){if(this.dataService)return this.dataService.getSalesHistory(r,t,d);let S=this.dummySalesData.filter(R=>R.salesExecutiveId===r);return t&&(S=S.filter(R=>R.date>=t)),d&&(S=S.filter(R=>R.date<=d)),(0,n.of)(S).pipe((0,E.c)(300))}getSalesSummary(r){if(this.dataService)return this.dataService.getSalesSummary(r);const t=this.dummySalesData.filter(S=>S.salesExecutiveId===r),d={totalSales:t.filter(S=>S.status===O.COMPLETED).reduce((S,R)=>S+R.amount,0),totalCommission:t.filter(S=>S.status===O.COMPLETED).reduce((S,R)=>S+R.commission,0),completedCount:t.filter(S=>S.status===O.COMPLETED).length,pendingCount:t.filter(S=>S.status===O.PENDING).length,cancelledCount:t.filter(S=>S.status===O.CANCELLED).length};return(0,n.of)(d).pipe((0,E.c)(300))}getAllSales(){return this.dataService?this.dataService.getAllSales():(0,n.of)(this.dummySalesData).pipe((0,E.c)(300))}generateDummyData(){const r=[{name:"Enterprise Software License",category:I.SOFTWARE,basePrice:5e4},{name:"Cloud Storage Solution",category:I.SERVICES,basePrice:25e3},{name:"Server Hardware",category:I.HARDWARE,basePrice:35e3},{name:"IoT Device Package",category:I.ELECTRONICS,basePrice:15e3},{name:"Consulting Services",category:I.SERVICES,basePrice:2e4},{name:"Mobile App Development",category:I.SOFTWARE,basePrice:45e3},{name:"Security Suite",category:I.SOFTWARE,basePrice:3e4},{name:"Network Infrastructure",category:I.HARDWARE,basePrice:6e4}],t=["Acme Corporation","Tech Innovations Inc","Global Solutions Ltd","Digital Dynamics","Future Systems","Smart Technologies","Enterprise Solutions","Cloud Masters"],d=["North","South","East","West","Central"],S=[{id:"user-4",name:"Alice Sales"},{id:"user-5",name:"Bob Sales"},{id:"user-6",name:"Carol Sales"}],R=[O.COMPLETED,O.COMPLETED,O.COMPLETED,O.PENDING,O.CANCELLED],z=[];let G=1;for(let V=0;V<50;V++){const X=S[V%S.length],Z=r[Math.floor(Math.random()*r.length)],q=t[Math.floor(Math.random()*t.length)],ee=d[Math.floor(Math.random()*d.length)],te=R[Math.floor(Math.random()*R.length)],k=Z.basePrice+(1e4*Math.random()-5e3),re=.05*k,J=new Date;J.setDate(J.getDate()-Math.floor(180*Math.random())),z.push({id:"sale-"+G++,salesExecutiveId:X.id,salesExecutiveName:X.name,productName:Z.name,productCategory:Z.category,amount:Math.round(k),commission:Math.round(re),status:te,date:J,clientName:q,region:ee})}return z.sort((V,X)=>X.date.getTime()-V.date.getTime())}static{this.\u0275fac=function(t){return new(t||v)(o.\u0275\u0275inject("DataService",8))}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})();var b=function(v){return v.SUPER_ADMIN="super-admin",v.ORG_ADMIN="org-admin",v.TEAM_LEAD="team-lead",v.MEMBER="member",v}(b||{});let w=(()=>{class v{constructor(){this.organizations=[{id:"org-1",name:"Acme Corporation",description:"Leading technology solutions provider",createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),isActive:!0,settings:{timezone:"America/New_York",currency:"USD",locale:"en-US"}},{id:"org-2",name:"Global Enterprises",description:"International business solutions",createdAt:new Date("2024-02-01"),updatedAt:new Date("2024-02-01"),isActive:!0,settings:{timezone:"Europe/London",currency:"GBP",locale:"en-GB"}}],this.organizationsSubject=new n.BehaviorSubject(this.organizations),this.organizations$=this.organizationsSubject.asObservable()}getAll(){return(0,n.of)(this.organizations).pipe((0,E.c)(300))}getById(r){const t=this.organizations.find(d=>d.id===r);return(0,n.of)(t).pipe((0,E.c)(300))}create(r){const t={...r,id:`org-${Date.now()}`,createdAt:new Date,updatedAt:new Date};return this.organizations.push(t),this.organizationsSubject.next(this.organizations),(0,n.of)(t).pipe((0,E.c)(300))}update(r,t){const d=this.organizations.findIndex(S=>S.id===r);return-1!==d?(this.organizations[d]={...this.organizations[d],...t,updatedAt:new Date},this.organizationsSubject.next(this.organizations),(0,n.of)(this.organizations[d]).pipe((0,E.c)(300))):(0,n.of)(null).pipe((0,E.c)(300))}delete(r){const t=this.organizations.findIndex(d=>d.id===r);return-1!==t?(this.organizations[t].isActive=!1,this.organizations[t].updatedAt=new Date,this.organizationsSubject.next(this.organizations),(0,n.of)(!0).pipe((0,E.c)(300))):(0,n.of)(!1).pipe((0,E.c)(300))}static{this.\u0275fac=function(t){return new(t||v)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})(),K=(()=>{class v{constructor(){this.teams=[{id:"team-1",name:"Engineering Team",description:"Software development team",organizationId:"org-1",leadId:"user-3",createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15"),isActive:!0},{id:"team-2",name:"Sales Team",description:"Customer acquisition and sales",organizationId:"org-1",leadId:"user-5",createdAt:new Date("2024-01-20"),updatedAt:new Date("2024-01-20"),isActive:!0},{id:"team-3",name:"Support Team",description:"Customer support and success",organizationId:"org-2",leadId:"user-7",createdAt:new Date("2024-02-10"),updatedAt:new Date("2024-02-10"),isActive:!0}],this.teamsSubject=new n.BehaviorSubject(this.teams),this.teams$=this.teamsSubject.asObservable()}getAll(){return(0,n.of)(this.teams).pipe((0,E.c)(300))}getByOrganization(r){const t=this.teams.filter(d=>d.organizationId===r);return(0,n.of)(t).pipe((0,E.c)(300))}getById(r){const t=this.teams.find(d=>d.id===r);return(0,n.of)(t).pipe((0,E.c)(300))}create(r){const t={...r,id:`team-${Date.now()}`,createdAt:new Date,updatedAt:new Date};return this.teams.push(t),this.teamsSubject.next(this.teams),(0,n.of)(t).pipe((0,E.c)(300))}update(r,t){const d=this.teams.findIndex(S=>S.id===r);return-1!==d?(this.teams[d]={...this.teams[d],...t,updatedAt:new Date},this.teamsSubject.next(this.teams),(0,n.of)(this.teams[d]).pipe((0,E.c)(300))):(0,n.of)(null).pipe((0,E.c)(300))}delete(r){const t=this.teams.findIndex(d=>d.id===r);return-1!==t?(this.teams[t].isActive=!1,this.teams[t].updatedAt=new Date,this.teamsSubject.next(this.teams),(0,n.of)(!0).pipe((0,E.c)(300))):(0,n.of)(!1).pipe((0,E.c)(300))}static{this.\u0275fac=function(t){return new(t||v)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})(),C=(()=>{class v{constructor(){this.users=[{id:"user-1",name:"John Admin",email:"john.admin@acme.com",organizationId:"org-1",teamId:"team-1",roleId:"role-1",isActive:!0,createdAt:new Date("2024-01-05"),updatedAt:new Date("2024-01-05"),zitadelUserId:"zitadel-user-1"},{id:"user-2",name:"Sarah Manager",email:"sarah.manager@acme.com",organizationId:"org-1",teamId:"team-1",roleId:"role-2",isActive:!0,createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-10"),zitadelUserId:"zitadel-user-2"},{id:"user-3",name:"Mike Lead",email:"mike.lead@acme.com",organizationId:"org-1",teamId:"team-1",roleId:"role-3",isActive:!0,createdAt:new Date("2024-01-12"),updatedAt:new Date("2024-01-12"),zitadelUserId:"zitadel-user-3"},{id:"user-4",name:"Alice Developer",email:"alice.dev@acme.com",organizationId:"org-1",teamId:"team-1",roleId:"role-4",isActive:!0,createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15"),zitadelUserId:"zitadel-user-4"},{id:"user-5",name:"Bob Sales",email:"bob.sales@acme.com",organizationId:"org-1",teamId:"team-2",roleId:"role-3",isActive:!0,createdAt:new Date("2024-01-18"),updatedAt:new Date("2024-01-18"),zitadelUserId:"zitadel-user-5"},{id:"user-6",name:"Carol Sales Rep",email:"carol.sales@acme.com",organizationId:"org-1",teamId:"team-2",roleId:"role-4",isActive:!0,createdAt:new Date("2024-01-20"),updatedAt:new Date("2024-01-20"),zitadelUserId:"zitadel-user-6"},{id:"user-7",name:"Dave Support Lead",email:"dave.support@global.com",organizationId:"org-2",teamId:"team-3",roleId:"role-3",isActive:!0,createdAt:new Date("2024-02-10"),updatedAt:new Date("2024-02-10"),zitadelUserId:"zitadel-user-7"},{id:"user-8",name:"Emma Support",email:"emma.support@global.com",organizationId:"org-2",teamId:"team-3",roleId:"role-4",isActive:!0,createdAt:new Date("2024-02-12"),updatedAt:new Date("2024-02-12"),zitadelUserId:"zitadel-user-8"}],this.usersSubject=new n.BehaviorSubject(this.users),this.users$=this.usersSubject.asObservable()}getAll(){return(0,n.of)(this.users).pipe((0,E.c)(300))}getByOrganization(r){const t=this.users.filter(d=>d.organizationId===r);return(0,n.of)(t).pipe((0,E.c)(300))}getByTeam(r){const t=this.users.filter(d=>d.teamId===r);return(0,n.of)(t).pipe((0,E.c)(300))}getById(r){const t=this.users.find(d=>d.id===r);return(0,n.of)(t).pipe((0,E.c)(300))}create(r){const t={...r,id:`user-${Date.now()}`,createdAt:new Date,updatedAt:new Date};return this.users.push(t),this.usersSubject.next(this.users),(0,n.of)(t).pipe((0,E.c)(300))}update(r,t){const d=this.users.findIndex(S=>S.id===r);return-1!==d?(this.users[d]={...this.users[d],...t,updatedAt:new Date},this.usersSubject.next(this.users),(0,n.of)(this.users[d]).pipe((0,E.c)(300))):(0,n.of)(null).pipe((0,E.c)(300))}delete(r){const t=this.users.findIndex(d=>d.id===r);return-1!==t?(this.users[t].isActive=!1,this.users[t].updatedAt=new Date,this.usersSubject.next(this.users),(0,n.of)(!0).pipe((0,E.c)(300))):(0,n.of)(!1).pipe((0,E.c)(300))}static{this.\u0275fac=function(t){return new(t||v)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})(),x=(()=>{class v{constructor(){this.roles=[{id:"role-1",name:"Super Admin",description:"Full system access",permissions:["*"],isSystemRole:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"role-2",name:"Organization Admin",description:"Full access within organization",permissions:["org:*","team:*","user:*"],isSystemRole:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"role-3",name:"Team Lead",description:"Manage team and team members",permissions:["team:read","team:update","user:read","user:update"],isSystemRole:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"role-4",name:"Member",description:"Basic member access",permissions:["user:read"],isSystemRole:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")}],this.rolesSubject=new n.BehaviorSubject(this.roles),this.roles$=this.rolesSubject.asObservable()}getAll(){return(0,n.of)(this.roles).pipe((0,E.c)(300))}getById(r){const t=this.roles.find(d=>d.id===r);return(0,n.of)(t).pipe((0,E.c)(300))}getSystemRoles(){const r=this.roles.filter(t=>t.isSystemRole);return(0,n.of)(r).pipe((0,E.c)(300))}getCustomRoles(){const r=this.roles.filter(t=>!t.isSystemRole);return(0,n.of)(r).pipe((0,E.c)(300))}create(r){const t={...r,id:`role-${Date.now()}`,createdAt:new Date,updatedAt:new Date};return this.roles.push(t),this.rolesSubject.next(this.roles),(0,n.of)(t).pipe((0,E.c)(300))}update(r,t){const d=this.roles.findIndex(S=>S.id===r);return-1===d||this.roles[d].isSystemRole?(0,n.of)(null).pipe((0,E.c)(300)):(this.roles[d]={...this.roles[d],...t,updatedAt:new Date},this.rolesSubject.next(this.roles),(0,n.of)(this.roles[d]).pipe((0,E.c)(300)))}delete(r){const t=this.roles.findIndex(d=>d.id===r);return-1===t||this.roles[t].isSystemRole?(0,n.of)(!1).pipe((0,E.c)(300)):(this.roles.splice(t,1),this.rolesSubject.next(this.roles),(0,n.of)(!0).pipe((0,E.c)(300)))}static{this.\u0275fac=function(t){return new(t||v)}}static{this.\u0275prov=o.\u0275\u0275defineInjectable({token:v,factory:v.\u0275fac,providedIn:"root"})}}return v})()},1985:(A,m,e)=>{e.d(m,{c:()=>f});var o=e(7707),a=e(3961),h=e(3494),n=e(1203),l=e(1026),y=e(8071),p=e(9786);let f=(()=>{class I{constructor(b){b&&(this._subscribe=b)}lift(b){const w=new I;return w.source=this,w.operator=b,w}subscribe(b,w,K){const C=function O(I){return I&&I instanceof o.vU||function E(I){return I&&(0,y.T)(I.next)&&(0,y.T)(I.error)&&(0,y.T)(I.complete)}(I)&&(0,a.Uv)(I)}(b)?b:new o.Ms(b,w,K);return(0,p.Y)(()=>{const{operator:x,source:v}=this;C.add(x?x.call(C,v):v?this._subscribe(C):this._trySubscribe(C))}),C}_trySubscribe(b){try{return this._subscribe(b)}catch(w){b.error(w)}}forEach(b,w){return new(w=_(w))((K,C)=>{const x=new o.Ms({next:v=>{try{b(v)}catch(T){C(T),x.unsubscribe()}},error:C,complete:K});this.subscribe(x)})}_subscribe(b){var w;return null===(w=this.source)||void 0===w?void 0:w.subscribe(b)}[h.s](){return this}pipe(...b){return(0,n.m)(b)(this)}toPromise(b){return new(b=_(b))((w,K)=>{let C;this.subscribe(x=>C=x,x=>K(x),()=>w(C))})}}return I.create=U=>new I(U),I})();function _(I){var U;return null!==(U=I??l.$.Promise)&&void 0!==U?U:Promise}},8399:(A,m,e)=>{e.d(m,{_:()=>a});var o=e(6129);class a{constructor(n,l=a.now){this.schedulerActionCtor=n,this.now=l}schedule(n,l=0,y){return new this.schedulerActionCtor(this,n).schedule(y,l)}}a.now=o.U.now},7707:(A,m,e)=>{e.d(m,{Ms:()=>K,vU:()=>I});var o=e(8071),a=e(3961),h=e(1026),n=e(5334),l=e(5343);const y=_("C",void 0,void 0);function _(r,t,d){return{kind:r,value:t,error:d}}var E=e(9270),O=e(9786);class I extends a.yU{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,(0,a.Uv)(t)&&t.add(this)):this.destination=T}static create(t,d,S){return new K(t,d,S)}next(t){this.isStopped?v(function f(r){return _("N",r,void 0)}(t),this):this._next(t)}error(t){this.isStopped?v(function p(r){return _("E",void 0,r)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?v(y,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const U=Function.prototype.bind;function b(r,t){return U.call(r,t)}class w{constructor(t){this.partialObserver=t}next(t){const{partialObserver:d}=this;if(d.next)try{d.next(t)}catch(S){C(S)}}error(t){const{partialObserver:d}=this;if(d.error)try{d.error(t)}catch(S){C(S)}else C(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(d){C(d)}}}class K extends I{constructor(t,d,S){let R;if(super(),(0,o.T)(t)||!t)R={next:t??void 0,error:d??void 0,complete:S??void 0};else{let z;this&&h.$.useDeprecatedNextContext?(z=Object.create(t),z.unsubscribe=()=>this.unsubscribe(),R={next:t.next&&b(t.next,z),error:t.error&&b(t.error,z),complete:t.complete&&b(t.complete,z)}):R=t}this.destination=new w(R)}}function C(r){h.$.useDeprecatedSynchronousErrorHandling?(0,O.l)(r):(0,n.m)(r)}function v(r,t){const{onStoppedNotification:d}=h.$;d&&E.f.setTimeout(()=>d(r,t))}const T={closed:!0,next:l.l,error:function x(r){throw r},complete:l.l}},3961:(A,m,e)=>{e.d(m,{Kn:()=>l,Uv:()=>y,yU:()=>n});var o=e(8071),a=e(4079),h=e(7908);class n{constructor(_){this.initialTeardown=_,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let _;if(!this.closed){this.closed=!0;const{_parentage:E}=this;if(E)if(this._parentage=null,Array.isArray(E))for(const U of E)U.remove(this);else E.remove(this);const{initialTeardown:O}=this;if((0,o.T)(O))try{O()}catch(U){_=U instanceof a.Z?U.errors:[U]}const{_finalizers:I}=this;if(I){this._finalizers=null;for(const U of I)try{p(U)}catch(b){_=_??[],b instanceof a.Z?_=[..._,...b.errors]:_.push(b)}}if(_)throw new a.Z(_)}}add(_){var E;if(_&&_!==this)if(this.closed)p(_);else{if(_ instanceof n){if(_.closed||_._hasParent(this))return;_._addParent(this)}(this._finalizers=null!==(E=this._finalizers)&&void 0!==E?E:[]).push(_)}}_hasParent(_){const{_parentage:E}=this;return E===_||Array.isArray(E)&&E.includes(_)}_addParent(_){const{_parentage:E}=this;this._parentage=Array.isArray(E)?(E.push(_),E):E?[E,_]:_}_removeParent(_){const{_parentage:E}=this;E===_?this._parentage=null:Array.isArray(E)&&(0,h.o)(E,_)}remove(_){const{_finalizers:E}=this;E&&(0,h.o)(E,_),_ instanceof n&&_._removeParent(this)}}n.EMPTY=(()=>{const f=new n;return f.closed=!0,f})();const l=n.EMPTY;function y(f){return f instanceof n||f&&"closed"in f&&(0,o.T)(f.remove)&&(0,o.T)(f.add)&&(0,o.T)(f.unsubscribe)}function p(f){(0,o.T)(f)?f():f.unsubscribe()}},1026:(A,m,e)=>{e.d(m,{$:()=>o});const o={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2688:(A,m,e)=>{e.d(m,{x:()=>n});var o=e(9131),a=e(9326),h=e(9724);function n(...l){return(0,o.K)()((0,h.H)(l,(0,a.lI)(l)))}},983:(A,m,e)=>{e.d(m,{I:()=>h,w:()=>a});var o=e(1985);const a=new o.c(l=>l.complete());function h(l){return l?function n(l){return new o.c(y=>l.schedule(()=>y.complete()))}(l):a}},9724:(A,m,e)=>{e.d(m,{H:()=>h});var o=e(5894),a=e(8750);function h(n,l){return l?(0,o.c)(n,l):(0,a.Tg)(n)}},8750:(A,m,e)=>{e.d(m,{Tg:()=>U});var o=e(1635),a=e(7441),h=e(9858),n=e(1985),l=e(5055),y=e(7953),p=e(591),f=e(5397),_=e(5196),E=e(8071),O=e(5334),I=e(3494);function U(r){if(r instanceof n.c)return r;if(null!=r){if((0,l.l)(r))return function b(r){return new n.c(t=>{const d=r[I.s]();if((0,E.T)(d.subscribe))return d.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if((0,a.X)(r))return function w(r){return new n.c(t=>{for(let d=0;d<r.length&&!t.closed;d++)t.next(r[d]);t.complete()})}(r);if((0,h.y)(r))return function K(r){return new n.c(t=>{r.then(d=>{t.closed||(t.next(d),t.complete())},d=>t.error(d)).then(null,O.m)})}(r);if((0,y.T)(r))return x(r);if((0,f.x)(r))return function C(r){return new n.c(t=>{for(const d of r)if(t.next(d),t.closed)return;t.complete()})}(r);if((0,_.U)(r))return function v(r){return x((0,_.C)(r))}(r)}throw(0,p.L)(r)}function x(r){return new n.c(t=>{(function T(r,t){var d,S,R,z;return(0,o.sH)(this,void 0,void 0,function*(){try{for(d=(0,o.xN)(r);!(S=yield d.next()).done;)if(t.next(S.value),t.closed)return}catch(G){R={error:G}}finally{try{S&&!S.done&&(z=d.return)&&(yield z.call(d))}finally{if(R)throw R.error}}t.complete()})})(r,t).catch(d=>t.error(d))})}},1807:(A,m,e)=>{e.d(m,{O:()=>l});var o=e(1985),a=e(3236),h=e(9470),n=e(8211);function l(y=0,p,f=a.b){let _=-1;return null!=p&&((0,h.m)(p)?f=p:_=p),new o.c(E=>{let O=(0,n.v)(y)?+y-f.now():y;O<0&&(O=0);let I=0;return f.schedule(function(){E.closed||(E.next(I++),0<=_?this.schedule(void 0,_):E.complete())},O)})}},4360:(A,m,e)=>{e.d(m,{H:()=>h,_:()=>a});var o=e(7707);function a(n,l,y,p,f){return new h(n,l,y,p,f)}class h extends o.vU{constructor(l,y,p,f,_,E){super(l),this.onFinalize=_,this.shouldUnsubscribe=E,this._next=y?function(O){try{y(O)}catch(I){l.error(I)}}:super._next,this._error=f?function(O){try{f(O)}catch(I){l.error(I)}finally{this.unsubscribe()}}:super._error,this._complete=p?function(){try{p()}catch(O){l.error(O)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var l;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:y}=this;super.unsubscribe(),!y&&(null===(l=this.onFinalize)||void 0===l||l.call(this))}}}},9131:(A,m,e)=>{e.d(m,{K:()=>a});var o=e(6365);function a(){return(0,o.U)(1)}},3103:(A,m,e)=>{e.d(m,{c:()=>n});var o=e(3236),a=e(3183),h=e(1807);function n(l,y=o.E){const p=(0,h.O)(l,y);return(0,a.o)(()=>p)}},3183:(A,m,e)=>{e.d(m,{o:()=>p});var o=e(2688),a=e(6697),h=e(3557),n=e(3703),l=e(3028),y=e(8750);function p(f,_){return _?E=>(0,o.x)(_.pipe((0,a.s)(1),(0,h.w)()),E.pipe(p(f))):(0,l.Z)((E,O)=>(0,y.Tg)(f(E,O)).pipe((0,a.s)(1),(0,n.u)(E)))}},3557:(A,m,e)=>{e.d(m,{w:()=>n});var o=e(9974),a=e(4360),h=e(5343);function n(){return(0,o.N)((l,y)=>{l.subscribe((0,a._)(y,h.l))})}},6354:(A,m,e)=>{e.d(m,{T:()=>h});var o=e(9974),a=e(4360);function h(n,l){return(0,o.N)((y,p)=>{let f=0;y.subscribe((0,a._)(p,_=>{p.next(n.call(l,_,f++))}))})}},3703:(A,m,e)=>{e.d(m,{u:()=>a});var o=e(6354);function a(h){return(0,o.T)(()=>h)}},6365:(A,m,e)=>{e.d(m,{U:()=>h});var o=e(3028),a=e(3669);function h(n=1/0){return(0,o.Z)(a.D,n)}},5412:(A,m,e)=>{e.d(m,{h:()=>n});var o=e(8750),a=e(5225),h=e(4360);function n(l,y,p,f,_,E,O,I){const U=[];let b=0,w=0,K=!1;const C=()=>{K&&!U.length&&!b&&y.complete()},x=T=>b<f?v(T):U.push(T),v=T=>{E&&y.next(T),b++;let r=!1;(0,o.Tg)(p(T,w++)).subscribe((0,h._)(y,t=>{_?.(t),E?x(t):y.next(t)},()=>{r=!0},void 0,()=>{if(r)try{for(b--;U.length&&b<f;){const t=U.shift();O?(0,a.N)(y,O,()=>v(t)):v(t)}C()}catch(t){y.error(t)}}))};return l.subscribe((0,h._)(y,x,()=>{K=!0,C()})),()=>{I?.()}}},3028:(A,m,e)=>{e.d(m,{Z:()=>y});var o=e(6354),a=e(8750),h=e(9974),n=e(5412),l=e(8071);function y(p,f,_=1/0){return(0,l.T)(f)?y((E,O)=>(0,o.T)((I,U)=>f(E,I,O,U))((0,a.Tg)(p(E,O))),_):("number"==typeof f&&(_=f),(0,h.N)((E,O)=>(0,n.h)(E,O,p,_)))}},941:(A,m,e)=>{e.d(m,{Q:()=>n});var o=e(5225),a=e(9974),h=e(4360);function n(l,y=0){return(0,a.N)((p,f)=>{p.subscribe((0,h._)(f,_=>(0,o.N)(f,l,()=>f.next(_),y),()=>(0,o.N)(f,l,()=>f.complete(),y),_=>(0,o.N)(f,l,()=>f.error(_),y)))})}},6745:(A,m,e)=>{e.d(m,{_:()=>a});var o=e(9974);function a(h,n=0){return(0,o.N)((l,y)=>{y.add(h.schedule(()=>l.subscribe(y),n))})}},6697:(A,m,e)=>{e.d(m,{s:()=>n});var o=e(983),a=e(9974),h=e(4360);function n(l){return l<=0?()=>o.w:(0,a.N)((y,p)=>{let f=0;y.subscribe((0,h._)(p,_=>{++f<=l&&(p.next(_),l<=f&&p.complete())}))})}},7119:(A,m,e)=>{e.d(m,{S:()=>l});var o=e(1985),a=e(4761),h=e(8071),n=e(5225);function l(y,p){return new o.c(f=>{let _;return(0,n.N)(f,p,()=>{_=y[a.l](),(0,n.N)(f,p,()=>{let E,O;try{({value:E,done:O}=_.next())}catch(I){return void f.error(I)}O?f.complete():f.next(E)},0,!0)}),()=>(0,h.T)(_?.return)&&_.return()})}},5894:(A,m,e)=>{e.d(m,{c:()=>v});var o=e(8750),a=e(941),h=e(6745),y=e(1985),f=e(7119),_=e(5225);function E(T,r){if(!T)throw new Error("Iterable cannot be null");return new y.c(t=>{(0,_.N)(t,r,()=>{const d=T[Symbol.asyncIterator]();(0,_.N)(t,r,()=>{d.next().then(S=>{S.done?t.complete():t.next(S.value)})},0,!0)})})}var O=e(5055),I=e(9858),U=e(7441),b=e(5397),w=e(7953),K=e(591),C=e(5196);function v(T,r){if(null!=T){if((0,O.l)(T))return function n(T,r){return(0,o.Tg)(T).pipe((0,h._)(r),(0,a.Q)(r))}(T,r);if((0,U.X)(T))return function p(T,r){return new y.c(t=>{let d=0;return r.schedule(function(){d===T.length?t.complete():(t.next(T[d++]),t.closed||this.schedule())})})}(T,r);if((0,I.y)(T))return function l(T,r){return(0,o.Tg)(T).pipe((0,h._)(r),(0,a.Q)(r))}(T,r);if((0,w.T)(T))return E(T,r);if((0,b.x)(T))return(0,f.S)(T,r);if((0,C.U)(T))return function x(T,r){return E((0,C.C)(T),r)}(T,r)}throw(0,K.L)(T)}},6780:(A,m,e)=>{e.d(m,{R:()=>l});var o=e(3961);class a extends o.yU{constructor(p,f){super()}schedule(p,f=0){return this}}const h={setInterval(y,p,...f){const{delegate:_}=h;return _?.setInterval?_.setInterval(y,p,...f):setInterval(y,p,...f)},clearInterval(y){const{delegate:p}=h;return(p?.clearInterval||clearInterval)(y)},delegate:void 0};var n=e(7908);class l extends a{constructor(p,f){super(p,f),this.scheduler=p,this.work=f,this.pending=!1}schedule(p,f=0){var _;if(this.closed)return this;this.state=p;const E=this.id,O=this.scheduler;return null!=E&&(this.id=this.recycleAsyncId(O,E,f)),this.pending=!0,this.delay=f,this.id=null!==(_=this.id)&&void 0!==_?_:this.requestAsyncId(O,this.id,f),this}requestAsyncId(p,f,_=0){return h.setInterval(p.flush.bind(p,this),_)}recycleAsyncId(p,f,_=0){if(null!=_&&this.delay===_&&!1===this.pending)return f;null!=f&&h.clearInterval(f)}execute(p,f){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const _=this._execute(p,f);if(_)return _;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(p,f){let E,_=!1;try{this.work(p)}catch(O){_=!0,E=O||new Error("Scheduled action threw falsy error")}if(_)return this.unsubscribe(),E}unsubscribe(){if(!this.closed){const{id:p,scheduler:f}=this,{actions:_}=f;this.work=this.state=this.scheduler=null,this.pending=!1,(0,n.o)(_,this),null!=p&&(this.id=this.recycleAsyncId(f,p,null)),this.delay=null,super.unsubscribe()}}}},707:(A,m,e)=>{e.d(m,{q:()=>a});var o=e(8399);class a extends o._{constructor(n,l=o._.now){super(n,l),this.actions=[],this._active=!1}flush(n){const{actions:l}=this;if(this._active)return void l.push(n);let y;this._active=!0;do{if(y=n.execute(n.state,n.delay))break}while(n=l.shift());if(this._active=!1,y){for(;n=l.shift();)n.unsubscribe();throw y}}}},3236:(A,m,e)=>{e.d(m,{E:()=>h,b:()=>n});var o=e(6780);const h=new(e(707).q)(o.R),n=h},6129:(A,m,e)=>{e.d(m,{U:()=>o});const o={now:()=>(o.delegate||Date).now(),delegate:void 0}},9270:(A,m,e)=>{e.d(m,{f:()=>o});const o={setTimeout(a,h,...n){const{delegate:l}=o;return l?.setTimeout?l.setTimeout(a,h,...n):setTimeout(a,h,...n)},clearTimeout(a){const{delegate:h}=o;return(h?.clearTimeout||clearTimeout)(a)},delegate:void 0}},4761:(A,m,e)=>{e.d(m,{l:()=>a});const a=function o(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},3494:(A,m,e)=>{e.d(m,{s:()=>o});const o="function"==typeof Symbol&&Symbol.observable||"@@observable"},4079:(A,m,e)=>{e.d(m,{Z:()=>a});const a=(0,e(1853).L)(h=>function(l){h(this),this.message=l?`${l.length} errors occurred during unsubscription:\n${l.map((y,p)=>`${p+1}) ${y.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=l})},9326:(A,m,e)=>{e.d(m,{R0:()=>y,lI:()=>l,ms:()=>n});var o=e(8071),a=e(9470);function h(p){return p[p.length-1]}function n(p){return(0,o.T)(h(p))?p.pop():void 0}function l(p){return(0,a.m)(h(p))?p.pop():void 0}function y(p,f){return"number"==typeof h(p)?p.pop():f}},7908:(A,m,e)=>{function o(a,h){if(a){const n=a.indexOf(h);0<=n&&a.splice(n,1)}}e.d(m,{o:()=>o})},1853:(A,m,e)=>{function o(a){const n=a(l=>{Error.call(l),l.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}e.d(m,{L:()=>o})},9786:(A,m,e)=>{e.d(m,{Y:()=>h,l:()=>n});var o=e(1026);let a=null;function h(l){if(o.$.useDeprecatedSynchronousErrorHandling){const y=!a;if(y&&(a={errorThrown:!1,error:null}),l(),y){const{errorThrown:p,error:f}=a;if(a=null,p)throw f}}else l()}function n(l){o.$.useDeprecatedSynchronousErrorHandling&&a&&(a.errorThrown=!0,a.error=l)}},5225:(A,m,e)=>{function o(a,h,n,l=0,y=!1){const p=h.schedule(function(){n(),y?a.add(this.schedule(null,l)):this.unsubscribe()},l);if(a.add(p),!y)return p}e.d(m,{N:()=>o})},3669:(A,m,e)=>{function o(a){return a}e.d(m,{D:()=>o})},7441:(A,m,e)=>{e.d(m,{X:()=>o});const o=a=>a&&"number"==typeof a.length&&"function"!=typeof a},7953:(A,m,e)=>{e.d(m,{T:()=>a});var o=e(8071);function a(h){return Symbol.asyncIterator&&(0,o.T)(h?.[Symbol.asyncIterator])}},8211:(A,m,e)=>{function o(a){return a instanceof Date&&!isNaN(a)}e.d(m,{v:()=>o})},8071:(A,m,e)=>{function o(a){return"function"==typeof a}e.d(m,{T:()=>o})},5055:(A,m,e)=>{e.d(m,{l:()=>h});var o=e(3494),a=e(8071);function h(n){return(0,a.T)(n[o.s])}},5397:(A,m,e)=>{e.d(m,{x:()=>h});var o=e(4761),a=e(8071);function h(n){return(0,a.T)(n?.[o.l])}},9858:(A,m,e)=>{e.d(m,{y:()=>a});var o=e(8071);function a(h){return(0,o.T)(h?.then)}},5196:(A,m,e)=>{e.d(m,{C:()=>h,U:()=>n});var o=e(1635),a=e(8071);function h(l){return(0,o.AQ)(this,arguments,function*(){const p=l.getReader();try{for(;;){const{value:f,done:_}=yield(0,o.N3)(p.read());if(_)return yield(0,o.N3)(void 0);yield yield(0,o.N3)(f)}}finally{p.releaseLock()}})}function n(l){return(0,a.T)(l?.getReader)}},9470:(A,m,e)=>{e.d(m,{m:()=>a});var o=e(8071);function a(h){return h&&(0,o.T)(h.schedule)}},9974:(A,m,e)=>{e.d(m,{N:()=>h,S:()=>a});var o=e(8071);function a(n){return(0,o.T)(n?.lift)}function h(n){return l=>{if(a(l))return l.lift(function(y){try{return n(y,this)}catch(p){this.error(p)}});throw new TypeError("Unable to lift unknown Observable type")}}},5343:(A,m,e)=>{function o(){}e.d(m,{l:()=>o})},1203:(A,m,e)=>{e.d(m,{F:()=>a,m:()=>h});var o=e(3669);function a(...n){return h(n)}function h(n){return 0===n.length?o.D:1===n.length?n[0]:function(y){return n.reduce((p,f)=>f(p),y)}}},5334:(A,m,e)=>{e.d(m,{m:()=>h});var o=e(1026),a=e(9270);function h(n){a.f.setTimeout(()=>{const{onUnhandledError:l}=o.$;if(!l)throw n;l(n)})}},591:(A,m,e)=>{function o(a){return new TypeError(`You provided ${null!==a&&"object"==typeof a?"an invalid object":`'${a}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}e.d(m,{L:()=>o})},467:(A,m,e)=>{function o(h,n,l,y,p,f,_){try{var E=h[f](_),O=E.value}catch(I){return void l(I)}E.done?n(O):Promise.resolve(O).then(y,p)}function a(h){return function(){var n=this,l=arguments;return new Promise(function(y,p){var f=h.apply(n,l);function _(O){o(f,y,p,_,E,"next",O)}function E(O){o(f,y,p,_,E,"throw",O)}_(void 0)})}}e.d(m,{A:()=>a})},1635:(A,m,e)=>{function I(s,i,c,u){return new(c||(c=Promise))(function(D,P){function L(W){try{M(u.next(W))}catch(j){P(j)}}function N(W){try{M(u.throw(W))}catch(j){P(j)}}function M(W){W.done?D(W.value):function g(D){return D instanceof c?D:new c(function(P){P(D)})}(W.value).then(L,N)}M((u=u.apply(s,i||[])).next())})}function r(s){return this instanceof r?(this.v=s,this):new r(s)}function t(s,i,c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g,u=c.apply(s,i||[]),D=[];return g=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),L("next"),L("throw"),L("return",function P(B){return function(F){return Promise.resolve(F).then(B,j)}}),g[Symbol.asyncIterator]=function(){return this},g;function L(B,F){u[B]&&(g[B]=function($){return new Promise(function(H,Y){D.push([B,$,H,Y])>1||N(B,$)})},F&&(g[B]=F(g[B])))}function N(B,F){try{!function M(B){B.value instanceof r?Promise.resolve(B.value.v).then(W,j):Q(D[0][2],B)}(u[B](F))}catch($){Q(D[0][3],$)}}function W(B){N("next",B)}function j(B){N("throw",B)}function Q(B,F){B(F),D.shift(),D.length&&N(D[0][0],D[0][1])}}function S(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c,i=s[Symbol.asyncIterator];return i?i.call(s):(s=function K(s){var i="function"==typeof Symbol&&Symbol.iterator,c=i&&s[i],u=0;if(c)return c.call(s);if(s&&"number"==typeof s.length)return{next:function(){return s&&u>=s.length&&(s=void 0),{value:s&&s[u++],done:!s}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}(s),c={},u("next"),u("throw"),u("return"),c[Symbol.asyncIterator]=function(){return this},c);function u(D){c[D]=s[D]&&function(P){return new Promise(function(L,N){!function g(D,P,L,N){Promise.resolve(N).then(function(M){D({value:M,done:L})},P)}(L,N,(P=s[D](P)).done,P.value)})}}}e.d(m,{AQ:()=>t,N3:()=>r,sH:()=>I,xN:()=>S}),"function"==typeof SuppressedError&&SuppressedError}}]);