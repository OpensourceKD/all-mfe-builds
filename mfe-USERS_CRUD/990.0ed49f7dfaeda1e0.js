(self.webpackChunkmfe_USERS_CRUD=self.webpackChunkmfe_USERS_CRUD||[]).push([[990,609],{6609:(F,P,d)=>{d.r(P),d.d(P,{AUTH0_CONFIG:()=>bo,Auth0ApiService:()=>yn,AuthService:()=>Ni,CoreServicesComponent:()=>za,CoreServicesService:()=>v,EventBusService:()=>Wi,OrganizationService:()=>Fa,ProductCategory:()=>it,RoleManagementService:()=>Ga,RoleService:()=>Ha,STORAGE_CONFIG:()=>rt,STORAGE_KEYS:()=>ot,SalesDataService:()=>Ja,SalesStatus:()=>Fe,SystemRole:()=>zi,TeamService:()=>Ba,UserRole:()=>Ce,UserService:()=>Va,getStorageItem:()=>Gt,removeStorageItem:()=>_o,setStorageItem:()=>go});var f=d(4332);let v=(()=>{class n{constructor(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var u=d(467),p=d(3425);function w(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]])}return e}"function"==typeof SuppressedError&&SuppressedError;var D=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},C={},R={};Object.defineProperty(R,"__esModule",{value:!0});var S=function(){function n(){var t=this;this.locked=new Map,this.addToLocked=function(e,r){var o=t.locked.get(e);void 0===o?t.locked.set(e,void 0===r?[]:[r]):void 0!==r&&(o.unshift(r),t.locked.set(e,o))},this.isLocked=function(e){return t.locked.has(e)},this.lock=function(e){return new Promise(function(r,o){t.isLocked(e)?t.addToLocked(e,r):(t.addToLocked(e),r())})},this.unlock=function(e){var r=t.locked.get(e);if(void 0!==r&&0!==r.length){var o=r.pop();t.locked.set(e,r),void 0!==o&&setTimeout(o,0)}else t.locked.delete(e)}}return n.getInstance=function(){return void 0===n.instance&&(n.instance=new n),n.instance},n}();R.default=function(){return S.getInstance()};var K=D&&D.__awaiter||function(n,t,e,r){return new(e||(e=Promise))(function(o,i){function s(h){try{c(r.next(h))}catch(l){i(l)}}function a(h){try{c(r.throw(h))}catch(l){i(l)}}function c(h){h.done?o(h.value):new e(function(l){l(h.value)}).then(s,a)}c((r=r.apply(n,t||[])).next())})},J=D&&D.__generator||function(n,t){var e,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(c){return function(h){return function(l){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,r=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){s=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){s.label=l[1];break}if(6===l[0]&&s.label<o[1]){s.label=o[1],o=l;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(l);break}o[2]&&s.ops.pop(),s.trys.pop();continue}l=t.call(n,s)}catch(m){l=[6,m],r=0}finally{e=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([c,h])}}},V=D;Object.defineProperty(C,"__esModule",{value:!0});var te=R,Y={key:function(n){return K(V,void 0,void 0,function(){return J(this,function(t){throw new Error("Unsupported")})})},getItem:function(n){return K(V,void 0,void 0,function(){return J(this,function(t){throw new Error("Unsupported")})})},clear:function(){return K(V,void 0,void 0,function(){return J(this,function(n){return[2,window.localStorage.clear()]})})},removeItem:function(n){return K(V,void 0,void 0,function(){return J(this,function(t){throw new Error("Unsupported")})})},setItem:function(n,t){return K(V,void 0,void 0,function(){return J(this,function(e){throw new Error("Unsupported")})})},keySync:function(n){return window.localStorage.key(n)},getItemSync:function(n){return window.localStorage.getItem(n)},clearSync:function(){return window.localStorage.clear()},removeItemSync:function(n){return window.localStorage.removeItem(n)},setItemSync:function(n,t){return window.localStorage.setItem(n,t)}};function se(n){return new Promise(function(t){return setTimeout(t,n)})}function pe(n){for(var e="",r=0;r<n;r++)e+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz"[Math.floor(61*Math.random())];return e}var ue=function(){function n(t){this.acquiredIatSet=new Set,this.storageHandler=void 0,this.id=Date.now().toString()+pe(15),this.acquireLock=this.acquireLock.bind(this),this.releaseLock=this.releaseLock.bind(this),this.releaseLock__private__=this.releaseLock__private__.bind(this),this.waitForSomethingToChange=this.waitForSomethingToChange.bind(this),this.refreshLockWhileAcquired=this.refreshLockWhileAcquired.bind(this),this.storageHandler=t,void 0===n.waiters&&(n.waiters=[])}return n.prototype.acquireLock=function(t,e){return void 0===e&&(e=5e3),K(this,void 0,void 0,function(){var r,o,i,s,a,c,h;return J(this,function(l){switch(l.label){case 0:r=Date.now()+pe(4),o=Date.now()+e,i="browser-tabs-lock-key-"+t,s=void 0===this.storageHandler?Y:this.storageHandler,l.label=1;case 1:return Date.now()<o?[4,se(30)]:[3,8];case 2:return l.sent(),null!==s.getItemSync(i)?[3,5]:(a=this.id+"-"+t+"-"+r,[4,se(Math.floor(25*Math.random()))]);case 3:return l.sent(),s.setItemSync(i,JSON.stringify({id:this.id,iat:r,timeoutKey:a,timeAcquired:Date.now(),timeRefreshed:Date.now()})),[4,se(30)];case 4:return l.sent(),null!==(c=s.getItemSync(i))&&(h=JSON.parse(c)).id===this.id&&h.iat===r?(this.acquiredIatSet.add(r),this.refreshLockWhileAcquired(i,r),[2,!0]):[3,7];case 5:return n.lockCorrector(void 0===this.storageHandler?Y:this.storageHandler),[4,this.waitForSomethingToChange(o)];case 6:l.sent(),l.label=7;case 7:return r=Date.now()+pe(4),[3,1];case 8:return[2,!1]}})})},n.prototype.refreshLockWhileAcquired=function(t,e){return K(this,void 0,void 0,function(){var r=this;return J(this,function(o){return setTimeout(function(){return K(r,void 0,void 0,function(){var i,s,a;return J(this,function(c){switch(c.label){case 0:return[4,te.default().lock(e)];case 1:return c.sent(),this.acquiredIatSet.has(e)?null===(s=(i=void 0===this.storageHandler?Y:this.storageHandler).getItemSync(t))?(te.default().unlock(e),[2]):((a=JSON.parse(s)).timeRefreshed=Date.now(),i.setItemSync(t,JSON.stringify(a)),te.default().unlock(e),this.refreshLockWhileAcquired(t,e),[2]):(te.default().unlock(e),[2])}})})},1e3),[2]})})},n.prototype.waitForSomethingToChange=function(t){return K(this,void 0,void 0,function(){return J(this,function(e){switch(e.label){case 0:return[4,new Promise(function(r){var o=!1,i=Date.now(),s=!1;function a(){if(s||(window.removeEventListener("storage",a),n.removeFromWaiting(a),clearTimeout(c),s=!0),!o){o=!0;var h=50-(Date.now()-i);h>0?setTimeout(r,h):r(null)}}window.addEventListener("storage",a),n.addToWaiting(a);var c=setTimeout(a,Math.max(0,t-Date.now()))})];case 1:return e.sent(),[2]}})})},n.addToWaiting=function(t){this.removeFromWaiting(t),void 0!==n.waiters&&n.waiters.push(t)},n.removeFromWaiting=function(t){void 0!==n.waiters&&(n.waiters=n.waiters.filter(function(e){return e!==t}))},n.notifyWaiters=function(){void 0!==n.waiters&&n.waiters.slice().forEach(function(t){return t()})},n.prototype.releaseLock=function(t){return K(this,void 0,void 0,function(){return J(this,function(e){switch(e.label){case 0:return[4,this.releaseLock__private__(t)];case 1:return[2,e.sent()]}})})},n.prototype.releaseLock__private__=function(t){return K(this,void 0,void 0,function(){var e,r,o,i;return J(this,function(s){switch(s.label){case 0:return null===(o=(e=void 0===this.storageHandler?Y:this.storageHandler).getItemSync(r="browser-tabs-lock-key-"+t))?[2]:(i=JSON.parse(o)).id!==this.id?[3,2]:[4,te.default().lock(i.iat)];case 1:s.sent(),this.acquiredIatSet.delete(i.iat),e.removeItemSync(r),te.default().unlock(i.iat),n.notifyWaiters(),s.label=2;case 2:return[2]}})})},n.lockCorrector=function(t){for(var e=Date.now()-5e3,r=t,o=[],i=0;;){var s=r.keySync(i);if(null===s)break;o.push(s),i++}for(var a=!1,c=0;c<o.length;c++){var h=o[c];if(h.includes("browser-tabs-lock-key")){var l=r.getItemSync(h);if(null!==l){var m=JSON.parse(l);(void 0===m.timeRefreshed&&m.timeAcquired<e||void 0!==m.timeRefreshed&&m.timeRefreshed<e)&&(r.removeItemSync(h),a=!0)}}}a&&n.notifyWaiters()},n.waiters=void 0,n}(),fe=C.default=ue;const ye={timeoutInSeconds:60},q={name:"auth0-spa-js",version:"2.13.0"},W=()=>Date.now();class x extends Error{constructor(t,e){super(e),this.error=t,this.error_description=e,Object.setPrototypeOf(this,x.prototype)}static fromPayload(t){let{error:e,error_description:r}=t;return new x(e,r)}}class X extends x{constructor(t,e,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(t,e),this.state=r,this.appState=o,Object.setPrototypeOf(this,X.prototype)}}class de extends x{constructor(t,e,r,o){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;super(t,e),this.connection=r,this.state=o,this.appState=i,Object.setPrototypeOf(this,de.prototype)}}class Te extends x{constructor(){super("timeout","Timeout"),Object.setPrototypeOf(this,Te.prototype)}}class Ue extends Te{constructor(t){super(),this.popup=t,Object.setPrototypeOf(this,Ue.prototype)}}class Be extends x{constructor(t){super("cancelled","Popup closed"),this.popup=t,Object.setPrototypeOf(this,Be.prototype)}}class Zt extends x{constructor(){super("popup_open","Unable to open a popup for loginWithPopup - window.open returned `null`"),Object.setPrototypeOf(this,Zt.prototype)}}class wt extends x{constructor(t,e,r,o){super(t,e),this.mfa_token=r,this.mfa_requirements=o,Object.setPrototypeOf(this,wt.prototype)}}class Ut extends x{constructor(t,e){super("missing_refresh_token","Missing Refresh Token (audience: '".concat(jt(t,["default"]),"', scope: '").concat(jt(e),"')")),this.audience=t,this.scope=e,Object.setPrototypeOf(this,Ut.prototype)}}class Xt extends x{constructor(t,e){super("missing_scopes","Missing requested scopes after refresh (audience: '".concat(jt(t,["default"]),"', missing scope: '").concat(jt(e),"')")),this.audience=t,this.scope=e,Object.setPrototypeOf(this,Xt.prototype)}}class Mt extends x{constructor(t){super("use_dpop_nonce","Server rejected DPoP proof: wrong nonce"),this.newDpopNonce=t,Object.setPrototypeOf(this,Mt.prototype)}}function jt(n){return n&&!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).includes(n)?n:""}const Lt=()=>window.crypto,bt=()=>{let t="";return Array.from(Lt().getRandomValues(new Uint8Array(43))).forEach(e=>t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~."[e%66]),t},Yt=n=>btoa(n),Ao=[{key:"name",type:["string"]},{key:"version",type:["string","number"]},{key:"env",type:["object"]}],y=function(n){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.keys(n).reduce((e,r)=>{if(t&&"env"===r)return e;const o=Ao.find(i=>i.key===r);return o&&o.type.includes(typeof n[r])&&(e[r]=n[r]),e},{})},_=n=>{var r,{clientId:t}=n,e=w(n,["clientId"]);return new URLSearchParams((r=Object.assign({client_id:t},e),Object.keys(r).filter(o=>void 0!==r[o]).reduce((o,i)=>Object.assign(Object.assign({},o),{[i]:r[i]}),{}))).toString()},b=function(){var n=(0,u.A)(function*(t){return yield Lt().subtle.digest({name:"SHA-256"},(new TextEncoder).encode(t))});return function(e){return n.apply(this,arguments)}}(),A=n=>{return t=n.replace(/_/g,"/").replace(/-/g,"+"),decodeURIComponent(atob(t).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""));var t},M=n=>{const t=new Uint8Array(n);return(e=>{const r={"+":"-","/":"_","=":""};return e.replace(/[+/=]/g,o=>r[o])})(window.btoa(String.fromCharCode(...Array.from(t))))},j=new TextEncoder,Z=new TextDecoder;function re(n){return"string"==typeof n?j.encode(n):Z.decode(n)}function Ae(n){if("number"!=typeof n.modulusLength||n.modulusLength<2048)throw new xe(`${n.name} modulusLength must be at least 2048 bits`)}function he(){return(he=(0,u.A)(function*(n,t,e){if(!1===e.usages.includes("sign"))throw new TypeError('private CryptoKey instances used for signing assertions must include "sign" in their "usages"');const r=`${Ve(re(JSON.stringify(n)))}.${Ve(re(JSON.stringify(t)))}`;return`${r}.${Ve(yield crypto.subtle.sign(function(o){switch(o.algorithm.name){case"ECDSA":return{name:o.algorithm.name,hash:"SHA-256"};case"RSA-PSS":return Ae(o.algorithm),{name:o.algorithm.name,saltLength:32};case"RSASSA-PKCS1-v1_5":return Ae(o.algorithm),{name:o.algorithm.name};case"Ed25519":return{name:o.algorithm.name}}throw new oe}(e),e,re(r)))}`})).apply(this,arguments)}let ge;function Ve(n){return ge(n)}ge=Uint8Array.prototype.toBase64?n=>(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),n.toBase64({alphabet:"base64url",omitPadding:!0})):t=>{t instanceof ArrayBuffer&&(t=new Uint8Array(t));const e=[];for(let r=0;r<t.byteLength;r+=32768)e.push(String.fromCharCode.apply(null,t.subarray(r,r+32768)));return btoa(e.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")};class oe extends Error{constructor(t){var e;super(t??"operation not supported"),this.name=this.constructor.name,null===(e=Error.captureStackTrace)||void 0===e||e.call(Error,this,this.constructor)}}class xe extends Error{constructor(t){var e;super(t),this.name=this.constructor.name,null===(e=Error.captureStackTrace)||void 0===e||e.call(Error,this,this.constructor)}}function je(n){switch(n.algorithm.name){case"RSA-PSS":return function(t){if("SHA-256"===t.algorithm.hash.name)return"PS256";throw new oe("unsupported RsaHashedKeyAlgorithm hash name")}(n);case"RSASSA-PKCS1-v1_5":return function(t){if("SHA-256"===t.algorithm.hash.name)return"RS256";throw new oe("unsupported RsaHashedKeyAlgorithm hash name")}(n);case"ECDSA":return function(t){if("P-256"===t.algorithm.namedCurve)return"ES256";throw new oe("unsupported EcKeyAlgorithm namedCurve")}(n);case"Ed25519":return"Ed25519";default:throw new oe("unsupported CryptoKey algorithm name")}}function Ne(n){return n instanceof CryptoKey}function $e(n){return Ne(n)&&"public"===n.type}function zn(){return zn=(0,u.A)(function*(n,t,e,r,o,i){const s=n?.privateKey,a=n?.publicKey;if(!Ne(c=s)||"private"!==c.type)throw new TypeError('"keypair.privateKey" must be a private CryptoKey');var c;if(!$e(a))throw new TypeError('"keypair.publicKey" must be a public CryptoKey');if(!0!==a.extractable)throw new TypeError('"keypair.publicKey.extractable" must be true');if("string"!=typeof t)throw new TypeError('"htu" must be a string');if("string"!=typeof e)throw new TypeError('"htm" must be a string');if(void 0!==r&&"string"!=typeof r)throw new TypeError('"nonce" must be a string or undefined');if(void 0!==o&&"string"!=typeof o)throw new TypeError('"accessToken" must be a string or undefined');if(void 0!==i&&("object"!=typeof i||null===i||Array.isArray(i)))throw new TypeError('"additional" must be an object');return function Q(n,t,e){return he.apply(this,arguments)}({alg:je(s),typ:"dpop+jwt",jwk:yield Eo(a)},Object.assign(Object.assign({},i),{iat:Math.floor(Date.now()/1e3),jti:crypto.randomUUID(),htm:e,nonce:r,htu:t,ath:o?Ve(yield crypto.subtle.digest("SHA-256",re(o))):void 0}),s)}),zn.apply(this,arguments)}function Eo(n){return Hn.apply(this,arguments)}function Hn(){return(Hn=(0,u.A)(function*(n){const{kty:t,e,n:r,x:o,y:i,crv:s}=yield crypto.subtle.exportKey("jwk",n);return{kty:t,crv:s,e,n:r,x:o,y:i}})).apply(this,arguments)}const Bi=["authorization_code","refresh_token","urn:ietf:params:oauth:grant-type:token-exchange","http://auth0.com/oauth/grant-type/mfa-oob","http://auth0.com/oauth/grant-type/mfa-otp","http://auth0.com/oauth/grant-type/mfa-recovery-code"];const Xi=function(){var n=(0,u.A)(function*(t,e){const r=yield fetch(t,e);return{ok:r.ok,json:yield r.json(),headers:(o=r.headers,[...o].reduce((i,s)=>{let[a,c]=s;return i[a]=c,i},{}))};var o});return function(e,r){return n.apply(this,arguments)}}(),Yi=function(){var n=(0,u.A)(function*(t,e,r){const o=new AbortController;let i;return e.signal=o.signal,Promise.race([Xi(t,e),new Promise((s,a)=>{i=setTimeout(()=>{o.abort(),a(new Error("Timeout when executing 'fetch'"))},r)})]).finally(()=>{clearTimeout(i)})});return function(e,r,o){return n.apply(this,arguments)}}(),$i=function(){var n=(0,u.A)(function*(t,e,r,o,i,s,a,c){return h={auth:{audience:e,scope:r},timeout:i,fetchUrl:t,fetchOptions:o,useFormData:a,useMrrt:c},l=s,new Promise(function(m,T){const g=new MessageChannel;g.port1.onmessage=function(k){k.data.error?T(new Error(k.data.error)):m(k.data),g.port1.close()},l.postMessage(h,[g.port2])});var h,l});return function(e,r,o,i,s,a,c,h){return n.apply(this,arguments)}}(),Qi=function(){var n=(0,u.A)(function*(t,e,r,o,i,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1e4;return i?$i(t,e,r,o,a,i,s,arguments.length>7?arguments[7]:void 0):Yi(t,o,a)});return function(e,r,o,i,s,a){return n.apply(this,arguments)}}();function So(n,t,e,r,o,i,s,a,c,h){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,u.A)(function*(n,t,e,r,o,i,s,a,c,h){if(c){const z=yield c.generateProof({url:n,method:o.method||"GET",nonce:yield c.getNonce()});o.headers=Object.assign(Object.assign({},o.headers),{dpop:z})}let l,m=null;for(let z=0;z<3;z++)try{l=yield Qi(n,e,r,o,i,s,t,a),m=null;break}catch(B){m=B}if(m)throw m;const T=l.json,{error:g,error_description:k}=T,O=w(T,["error","error_description"]),{headers:E,ok:I}=l;let U;if(c&&(U=E["dpop-nonce"],U&&(yield c.setNonce(U))),!I){const z=k||"HTTP error. Unable to fetch ".concat(n);if("mfa_required"===g)throw new wt(g,z,O.mfa_token,O.mfa_requirements);if("missing_refresh_token"===g)throw new Ut(e,r);if("use_dpop_nonce"===g){if(!c||!U||h)throw new Mt(U);return So(n,t,e,r,o,i,s,a,c,!0)}throw new x(g||"request_error",z)}return O})).apply(this,arguments)}function Fn(){return(Fn=(0,u.A)(function*(n,t){var{baseUrl:e,timeout:r,audience:o,scope:i,auth0Client:s,useFormData:a,useMrrt:c,dpop:h}=n,l=w(n,["baseUrl","timeout","audience","scope","auth0Client","useFormData","useMrrt","dpop"]);const m="urn:ietf:params:oauth:grant-type:token-exchange"===l.grant_type,T="refresh_token"===l.grant_type&&c,g=Object.assign(Object.assign(Object.assign(Object.assign({},l),m&&o&&{audience:o}),m&&i&&{scope:i}),T&&{audience:o,scope:i}),k=a?_(g):JSON.stringify(g),O=Bi.includes(l.grant_type);return yield So("".concat(e,"/oauth/token"),r,o||"default",i,{method:"POST",body:k,headers:{"Content-Type":a?"application/x-www-form-urlencoded":"application/json","Auth0-Client":btoa(JSON.stringify(y(s||q)))}},t,a,c,O?h:void 0)})).apply(this,arguments)}const gn=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return(n=>Array.from(new Set(n)))(t.filter(Boolean).join(" ").trim().split(/\s+/)).join(" ")},_n=(n,t,e)=>{let r;return e&&(r=n[e]),r||(r=n.default),gn(r,t)};class ze{constructor(t){let r=arguments.length>2?arguments[2]:void 0;this.prefix=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"@@auth0spajs@@",this.suffix=r,this.clientId=t.clientId,this.scope=t.scope,this.audience=t.audience}toKey(){return[this.prefix,this.clientId,this.audience,this.scope,this.suffix].filter(Boolean).join("::")}static fromKey(t){const[e,r,o,i]=t.split("::");return new ze({clientId:r,scope:i,audience:o},e)}static fromCacheEntry(t){const{scope:e,audience:r,client_id:o}=t;return new ze({scope:e,audience:r,clientId:o})}}class ts{set(t,e){localStorage.setItem(t,JSON.stringify(e))}get(t){const e=window.localStorage.getItem(t);if(e)try{return JSON.parse(e)}catch{return}}remove(t){localStorage.removeItem(t)}allKeys(){return Object.keys(window.localStorage).filter(t=>t.startsWith("@@auth0spajs@@"))}}class To{constructor(){this.enclosedCache=function(){let t={};return{set(e,r){t[e]=r},get(e){const r=t[e];if(r)return r},remove(e){delete t[e]},allKeys:()=>Object.keys(t)}}()}}class ns{constructor(t,e,r){this.cache=t,this.keyManifest=e,this.nowProvider=r||W}setIdToken(t,e,r){var o=this;return(0,u.A)(function*(){var i;const s=o.getIdTokenCacheKey(t);yield o.cache.set(s,{id_token:e,decodedToken:r}),yield null===(i=o.keyManifest)||void 0===i?void 0:i.add(s)})()}getIdToken(t){var e=this;return(0,u.A)(function*(){const r=yield e.cache.get(e.getIdTokenCacheKey(t.clientId));if(!r&&t.scope&&t.audience){const o=yield e.get(t);return o&&o.id_token&&o.decodedToken?{id_token:o.id_token,decodedToken:o.decodedToken}:void 0}if(r)return{id_token:r.id_token,decodedToken:r.decodedToken}})()}get(t){var e=arguments,r=this;return(0,u.A)(function*(){let o=e.length>1&&void 0!==e[1]?e[1]:0,i=e.length>2&&void 0!==e[2]&&e[2],s=e.length>3?e[3]:void 0;var a;let c=yield r.cache.get(t.toKey());if(!c){const m=yield r.getCacheKeys();if(!m)return;const T=r.matchExistingCacheKey(t,m);if(T&&(c=yield r.cache.get(T)),!c&&i&&"cache-only"!==s)return r.getEntryWithRefreshToken(t,m)}if(!c)return;const h=yield r.nowProvider(),l=Math.floor(h/1e3);return c.expiresAt-o<l?c.body.refresh_token?r.modifiedCachedEntry(c,t):(yield r.cache.remove(t.toKey()),void(yield null===(a=r.keyManifest)||void 0===a?void 0:a.remove(t.toKey()))):c.body})()}modifiedCachedEntry(t,e){var r=this;return(0,u.A)(function*(){return t.body={refresh_token:t.body.refresh_token,audience:t.body.audience,scope:t.body.scope},yield r.cache.set(e.toKey(),t),{refresh_token:t.body.refresh_token,audience:t.body.audience,scope:t.body.scope}})()}set(t){var e=this;return(0,u.A)(function*(){var r;const o=new ze({clientId:t.client_id,scope:t.scope,audience:t.audience}),i=yield e.wrapCacheEntry(t);yield e.cache.set(o.toKey(),i),yield null===(r=e.keyManifest)||void 0===r?void 0:r.add(o.toKey())})()}remove(t,e,r){var o=this;return(0,u.A)(function*(){const i=new ze({clientId:t,scope:r,audience:e});yield o.cache.remove(i.toKey())})()}clear(t){var e=this;return(0,u.A)(function*(){var r;const o=yield e.getCacheKeys();o&&(yield o.filter(i=>!t||i.includes(t)).reduce(function(){var i=(0,u.A)(function*(s,a){yield s,yield e.cache.remove(a)});return function(s,a){return i.apply(this,arguments)}}(),Promise.resolve()),yield null===(r=e.keyManifest)||void 0===r?void 0:r.clear())})()}wrapCacheEntry(t){var e=this;return(0,u.A)(function*(){const r=yield e.nowProvider();return{body:t,expiresAt:Math.floor(r/1e3)+t.expires_in}})()}getCacheKeys(){var t=this;return(0,u.A)(function*(){var e;return t.keyManifest?null===(e=yield t.keyManifest.get())||void 0===e?void 0:e.keys:t.cache.allKeys?t.cache.allKeys():void 0})()}getIdTokenCacheKey(t){return new ze({clientId:t},"@@auth0spajs@@","@@user@@").toKey()}matchExistingCacheKey(t,e){return e.filter(r=>{var o;const i=ze.fromKey(r),s=new Set(i.scope&&i.scope.split(" ")),a=(null===(o=t.scope)||void 0===o?void 0:o.split(" "))||[],c=i.scope&&a.reduce((h,l)=>h&&s.has(l),!0);return"@@auth0spajs@@"===i.prefix&&i.clientId===t.clientId&&i.audience===t.audience&&c})[0]}getEntryWithRefreshToken(t,e){var r=this;return(0,u.A)(function*(){var o;for(const i of e){const s=ze.fromKey(i);if("@@auth0spajs@@"===s.prefix&&s.clientId===t.clientId){const a=yield r.cache.get(i);if(null!==(o=a?.body)&&void 0!==o&&o.refresh_token)return r.modifiedCachedEntry(a,t)}}})()}updateEntry(t,e){var r=this;return(0,u.A)(function*(){var o;const i=yield r.getCacheKeys();if(i)for(const s of i){const a=yield r.cache.get(s);if((null===(o=a?.body)||void 0===o?void 0:o.refresh_token)===t){const c=Object.assign(Object.assign({},a.body),{refresh_token:e});yield r.set(c)}}})()}}class rs{constructor(t,e,r){this.storage=t,this.clientId=e,this.cookieDomain=r,this.storageKey="".concat("a0.spajs.txs",".").concat(this.clientId)}create(t){this.storage.save(this.storageKey,t,{daysUntilExpire:1,cookieDomain:this.cookieDomain})}get(){return this.storage.get(this.storageKey)}remove(){this.storage.remove(this.storageKey,{cookieDomain:this.cookieDomain})}}const $t=n=>"number"==typeof n,os=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"];var Qt=D&&D.__assign||function(){return Qt=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},Qt.apply(this,arguments)};function qt(n,t){if(!t)return"";var e="; "+n;return!0===t?e:e+"="+t}function ko(n,t,e){document.cookie=function ss(n,t,e){return encodeURIComponent(n).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/\(/g,"%28").replace(/\)/g,"%29")+"="+encodeURIComponent(t).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)+function(r){if("number"==typeof r.expires){var o=new Date;o.setMilliseconds(o.getMilliseconds()+864e5*r.expires),r.expires=o}return qt("Expires",r.expires?r.expires.toUTCString():"")+qt("Domain",r.domain)+qt("Path",r.path)+qt("Secure",r.secure)+qt("SameSite",r.sameSite)}(e)}(n,t,Qt({path:"/"},e))}var Po=ko,Io=function(n,t){ko(n,"",Qt(Qt({},t),{expires:-1}))};const Kt={get(n){const t=function(n){return function as(){return function(n){for(var t={},e=n?n.split("; "):[],r=/(%[\dA-F]{2})+/gi,o=0;o<e.length;o++){var i=e[o].split("="),s=i.slice(1).join("=");'"'===s.charAt(0)&&(s=s.slice(1,-1));try{t[i[0].replace(r,decodeURIComponent)]=s.replace(r,decodeURIComponent)}catch{}}return t}(document.cookie)}()[n]}(n);if(void 0!==t)return JSON.parse(t)},save(n,t,e){let r={};"https:"===window.location.protocol&&(r={secure:!0,sameSite:"none"}),e?.daysUntilExpire&&(r.expires=e.daysUntilExpire),e?.cookieDomain&&(r.domain=e.cookieDomain),Po(n,JSON.stringify(t),r)},remove(n,t){let e={};t?.cookieDomain&&(e.domain=t.cookieDomain),Io(n,e)}},us={get:n=>Kt.get(n)||Kt.get("".concat("_legacy_").concat(n)),save(n,t,e){let r={};"https:"===window.location.protocol&&(r={secure:!0}),e?.daysUntilExpire&&(r.expires=e.daysUntilExpire),e?.cookieDomain&&(r.domain=e.cookieDomain),Po("".concat("_legacy_").concat(n),JSON.stringify(t),r),Kt.save(n,t,e)},remove(n,t){let e={};t?.cookieDomain&&(e.domain=t.cookieDomain),Io(n,e),Kt.remove(n,t),Kt.remove("".concat("_legacy_").concat(n),t)}},ls={get(n){if(typeof sessionStorage>"u")return;const t=sessionStorage.getItem(n);return null!=t?JSON.parse(t):void 0},save(n,t){sessionStorage.setItem(n,JSON.stringify(t))},remove(n){sessionStorage.removeItem(n)}};var At,n;(n=At||(At={})).Code="code",n.ConnectCode="connect_code";var Bn,hs=function(n){return Bn=Bn||function ds(n,t,e){var r=void 0===t?null:t,o=function(c,h){var l=atob(c);if(h){for(var m=new Uint8Array(l.length),T=0,g=l.length;T<g;++T)m[T]=l.charCodeAt(T);return String.fromCharCode.apply(null,new Uint16Array(m.buffer))}return l}(n,void 0!==e&&e),i=o.indexOf("\n",10)+1,s=o.substring(i)+(r?"//# sourceMappingURL="+r:""),a=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(a)}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7Y2xhc3MgZSBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKHQscil7c3VwZXIociksdGhpcy5lcnJvcj10LHRoaXMuZXJyb3JfZGVzY3JpcHRpb249cixPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxlLnByb3RvdHlwZSl9c3RhdGljIGZyb21QYXlsb2FkKHQpe2xldHtlcnJvcjpyLGVycm9yX2Rlc2NyaXB0aW9uOnN9PXQ7cmV0dXJuIG5ldyBlKHIscyl9fWNsYXNzIHQgZXh0ZW5kcyBle2NvbnN0cnVjdG9yKGUscyl7c3VwZXIoIm1pc3NpbmdfcmVmcmVzaF90b2tlbiIsIk1pc3NpbmcgUmVmcmVzaCBUb2tlbiAoYXVkaWVuY2U6ICciLmNvbmNhdChyKGUsWyJkZWZhdWx0Il0pLCInLCBzY29wZTogJyIpLmNvbmNhdChyKHMpLCInKSIpKSx0aGlzLmF1ZGllbmNlPWUsdGhpcy5zY29wZT1zLE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLHQucHJvdG90eXBlKX19ZnVuY3Rpb24gcihlKXtsZXQgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06W107cmV0dXJuIGUmJiF0LmluY2x1ZGVzKGUpP2U6IiJ9ImZ1bmN0aW9uIj09dHlwZW9mIFN1cHByZXNzZWRFcnJvciYmU3VwcHJlc3NlZEVycm9yO2NvbnN0IHM9ZT0+e3ZhcntjbGllbnRJZDp0fT1lLHI9ZnVuY3Rpb24oZSx0KXt2YXIgcj17fTtmb3IodmFyIHMgaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxzKSYmdC5pbmRleE9mKHMpPDAmJihyW3NdPWVbc10pO2lmKG51bGwhPWUmJiJmdW5jdGlvbiI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihzPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxzLmxlbmd0aDtvKyspdC5pbmRleE9mKHNbb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLHNbb10pJiYocltzW29dXT1lW3Nbb11dKX1yZXR1cm4gcn0oZSxbImNsaWVudElkIl0pO3JldHVybiBuZXcgVVJMU2VhcmNoUGFyYW1zKChlPT5PYmplY3Qua2V5cyhlKS5maWx0ZXIoKHQ9PnZvaWQgMCE9PWVbdF0pKS5yZWR1Y2UoKCh0LHIpPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tyXTplW3JdfSkpLHt9KSkoT2JqZWN0LmFzc2lnbih7Y2xpZW50X2lkOnR9LHIpKSkudG9TdHJpbmcoKX07bGV0IG89e307Y29uc3Qgbj0oZSx0KT0+IiIuY29uY2F0KGUsInwiKS5jb25jYXQodCk7YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsKGFzeW5jIGU9PntsZXQgcixjLHtkYXRhOnt0aW1lb3V0OmksYXV0aDphLGZldGNoVXJsOmYsZmV0Y2hPcHRpb25zOmwsdXNlRm9ybURhdGE6cCx1c2VNcnJ0Omh9LHBvcnRzOlt1XX09ZSxkPXt9O2NvbnN0e2F1ZGllbmNlOmcsc2NvcGU6eX09YXx8e307dHJ5e2NvbnN0IGU9cD8oZT0+e2NvbnN0IHQ9bmV3IFVSTFNlYXJjaFBhcmFtcyhlKSxyPXt9O3JldHVybiB0LmZvckVhY2goKChlLHQpPT57clt0XT1lfSkpLHJ9KShsLmJvZHkpOkpTT04ucGFyc2UobC5ib2R5KTtpZighZS5yZWZyZXNoX3Rva2VuJiYicmVmcmVzaF90b2tlbiI9PT1lLmdyYW50X3R5cGUpe2lmKGM9KChlLHQpPT5vW24oZSx0KV0pKGcseSksIWMmJmgpe2NvbnN0IGU9by5sYXRlc3RfcmVmcmVzaF90b2tlbix0PSgoZSx0KT0+e2NvbnN0IHI9T2JqZWN0LmtleXMobykuZmluZCgocj0+e2lmKCJsYXRlc3RfcmVmcmVzaF90b2tlbiIhPT1yKXtjb25zdCBzPSgoZSx0KT0+dC5zdGFydHNXaXRoKCIiLmNvbmNhdChlLCJ8IikpKSh0LHIpLG89ci5zcGxpdCgifCIpWzFdLnNwbGl0KCIgIiksbj1lLnNwbGl0KCIgIikuZXZlcnkoKGU9Pm8uaW5jbHVkZXMoZSkpKTtyZXR1cm4gcyYmbn19KSk7cmV0dXJuISFyfSkoeSxnKTtlJiYhdCYmKGM9ZSl9aWYoIWMpdGhyb3cgbmV3IHQoZyx5KTtsLmJvZHk9cD9zKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7cmVmcmVzaF90b2tlbjpjfSkpOkpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7cmVmcmVzaF90b2tlbjpjfSkpfWxldCBhLGs7ImZ1bmN0aW9uIj09dHlwZW9mIEFib3J0Q29udHJvbGxlciYmKGE9bmV3IEFib3J0Q29udHJvbGxlcixsLnNpZ25hbD1hLnNpZ25hbCk7dHJ5e2s9YXdhaXQgUHJvbWlzZS5yYWNlKFsoaj1pLG5ldyBQcm9taXNlKChlPT5zZXRUaW1lb3V0KGUsaikpKSksZmV0Y2goZixPYmplY3QuYXNzaWduKHt9LGwpKV0pfWNhdGNoKGUpe3JldHVybiB2b2lkIHUucG9zdE1lc3NhZ2Uoe2Vycm9yOmUubWVzc2FnZX0pfWlmKCFrKXJldHVybiBhJiZhLmFib3J0KCksdm9pZCB1LnBvc3RNZXNzYWdlKHtlcnJvcjoiVGltZW91dCB3aGVuIGV4ZWN1dGluZyAnZmV0Y2gnIn0pO189ay5oZWFkZXJzLGQ9Wy4uLl9dLnJlZHVjZSgoKGUsdCk9PntsZXRbcixzXT10O3JldHVybiBlW3JdPXMsZX0pLHt9KSxyPWF3YWl0IGsuanNvbigpLHIucmVmcmVzaF90b2tlbj8oaCYmKG8ubGF0ZXN0X3JlZnJlc2hfdG9rZW49ci5yZWZyZXNoX3Rva2VuLE89YyxiPXIucmVmcmVzaF90b2tlbixPYmplY3QuZW50cmllcyhvKS5mb3JFYWNoKChlPT57bGV0W3Qscl09ZTtyPT09TyYmKG9bdF09Yil9KSkpLCgoZSx0LHIpPT57b1tuKHQscildPWV9KShyLnJlZnJlc2hfdG9rZW4sZyx5KSxkZWxldGUgci5yZWZyZXNoX3Rva2VuKTooKGUsdCk9PntkZWxldGUgb1tuKGUsdCldfSkoZyx5KSx1LnBvc3RNZXNzYWdlKHtvazprLm9rLGpzb246cixoZWFkZXJzOmR9KX1jYXRjaChlKXt1LnBvc3RNZXNzYWdlKHtvazohMSxqc29uOntlcnJvcjplLmVycm9yLGVycm9yX2Rlc2NyaXB0aW9uOmUubWVzc2FnZX0saGVhZGVyczpkfSl9dmFyIE8sYixfLGp9KSl9KCk7Cgo=",null,!1),new Worker(Bn,n)};const Vn={},Co=function(){var n=(0,u.A)(function*(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;for(let r=0;r<e;r++)if(yield t())return!0;return!1});return function(e){return n.apply(this,arguments)}}();class ps{constructor(t,e){this.cache=t,this.clientId=e,this.manifestKey=this.createManifestKeyFrom(this.clientId)}add(t){var e=this;return(0,u.A)(function*(){var r;const o=new Set((null===(r=yield e.cache.get(e.manifestKey))||void 0===r?void 0:r.keys)||[]);o.add(t),yield e.cache.set(e.manifestKey,{keys:[...o]})})()}remove(t){var e=this;return(0,u.A)(function*(){const r=yield e.cache.get(e.manifestKey);if(r){const o=new Set(r.keys);return o.delete(t),o.size>0?yield e.cache.set(e.manifestKey,{keys:[...o]}):yield e.cache.remove(e.manifestKey)}})()}get(){return this.cache.get(this.manifestKey)}clear(){return this.cache.remove(this.manifestKey)}createManifestKeyFrom(t){return"".concat("@@auth0spajs@@","::").concat(t)}}const fs={memory:()=>(new To).enclosedCache,localstorage:()=>new ts},Do=n=>fs[n],Uo=n=>{const{openUrl:t,onRedirect:e}=n,r=w(n,["openUrl","onRedirect"]);return Object.assign(Object.assign({},r),{openUrl:!1===t||t?t:e})},Mo=(n,t)=>{const e=t?.split(" ")||[];return(n?.split(" ")||[]).every(r=>e.includes(r))},Et={NONCE:"nonce",KEYPAIR:"keypair"};class ms{constructor(t){this.clientId=t}getVersion(){return 1}createDbHandle(){const t=window.indexedDB.open("auth0-spa-js",this.getVersion());return new Promise((e,r)=>{t.onupgradeneeded=()=>Object.values(Et).forEach(o=>t.result.createObjectStore(o)),t.onerror=()=>r(t.error),t.onsuccess=()=>e(t.result)})}getDbHandle(){var t=this;return(0,u.A)(function*(){return t.dbHandle||(t.dbHandle=yield t.createDbHandle()),t.dbHandle})()}executeDbRequest(t,e,r){var o=this;return(0,u.A)(function*(){const i=r((yield o.getDbHandle()).transaction(t,e).objectStore(t));return new Promise((s,a)=>{i.onsuccess=()=>s(i.result),i.onerror=()=>a(i.error)})})()}buildKey(t){const e=t?"_".concat(t):"auth0";return"".concat(this.clientId,"::").concat(e)}setNonce(t,e){return this.save(Et.NONCE,this.buildKey(e),t)}setKeyPair(t){return this.save(Et.KEYPAIR,this.buildKey(),t)}save(t,e,r){var o=this;return(0,u.A)(function*(){yield o.executeDbRequest(t,"readwrite",i=>i.put(r,e))})()}findNonce(t){return this.find(Et.NONCE,this.buildKey(t))}findKeyPair(){return this.find(Et.KEYPAIR,this.buildKey())}find(t,e){return this.executeDbRequest(t,"readonly",r=>r.get(e))}deleteBy(t,e){var r=this;return(0,u.A)(function*(){const o=yield r.executeDbRequest(t,"readonly",i=>i.getAllKeys());o?.filter(e).map(i=>r.executeDbRequest(t,"readwrite",s=>s.delete(i)))})()}deleteByClientId(t,e){return this.deleteBy(t,r=>"string"==typeof r&&r.startsWith("".concat(e,"::")))}clearNonces(){return this.deleteByClientId(Et.NONCE,this.clientId)}clearKeyPairs(){return this.deleteByClientId(Et.KEYPAIR,this.clientId)}}class ys{constructor(t){this.storage=new ms(t)}getNonce(t){return this.storage.findNonce(t)}setNonce(t,e){return this.storage.setNonce(t,e)}getOrGenerateKeyPair(){var t=this;return(0,u.A)(function*(){let e=yield t.storage.findKeyPair();return e||(e=yield function Vi(){return(n=(0,u.A)(function*(t,e){var r;let o;if("string"!=typeof t||0===t.length)throw new TypeError('"alg" must be a non-empty string');switch(t){case"PS256":o={name:"RSA-PSS",hash:"SHA-256",modulusLength:2048,publicExponent:new Uint8Array([1,0,1])};break;case"RS256":o={name:"RSASSA-PKCS1-v1_5",hash:"SHA-256",modulusLength:2048,publicExponent:new Uint8Array([1,0,1])};break;case"ES256":o={name:"ECDSA",namedCurve:"P-256"};break;case"Ed25519":o={name:"Ed25519"};break;default:throw new oe}return crypto.subtle.generateKey(o,null!==(r=e?.extractable)&&void 0!==r&&r,["sign","verify"])}),function(t,e){return n.apply(this,arguments)})("ES256",{extractable:!1});var n}(),yield t.storage.setKeyPair(e)),e})()}generateProof(t){var e=this;return(0,u.A)(function*(){const r=yield e.getOrGenerateKeyPair();return function Zi(n){let{keyPair:t,url:e,method:r,nonce:o,accessToken:i}=n;return function Fi(n,t,e,r,o,i){return zn.apply(this,arguments)}(t,function(a){const c=new URL(a);return c.search="",c.hash="",c.href}(e),r,o,i)}(Object.assign({keyPair:r},t))})()}calculateThumbprint(){var t=this;return(0,u.A)(function*(){return function Gi(n){return(t=(0,u.A)(function*(e){if(!$e(e))throw new TypeError('"publicKey" must be a public CryptoKey');if(!0!==e.extractable)throw new TypeError('"publicKey.extractable" must be true');const r=yield Eo(e);let o;switch(r.kty){case"EC":o={crv:r.crv,kty:r.kty,x:r.x,y:r.y};break;case"OKP":o={crv:r.crv,kty:r.kty,x:r.x};break;case"RSA":o={e:r.e,kty:r.kty,n:r.n};break;default:throw new oe("unsupported JWK kty")}return Ve(yield crypto.subtle.digest({name:"SHA-256"},re(JSON.stringify(o))))}),function(e){return t.apply(this,arguments)})(n.publicKey);var t}(yield t.getOrGenerateKeyPair())})()}clear(){var t=this;return(0,u.A)(function*(){yield Promise.all([t.storage.clearNonces(),t.storage.clearKeyPairs()])})()}}var Wt;!function(n){n.Bearer="Bearer",n.DPoP="DPoP"}(Wt||(Wt={}));class gs{constructor(t,e){this.hooks=e,this.config=Object.assign(Object.assign({},t),{fetch:t.fetch||(typeof window>"u"?fetch:window.fetch.bind(window))})}isAbsoluteUrl(t){return/^(https?:)?\/\//i.test(t)}buildUrl(t,e){if(e){if(this.isAbsoluteUrl(e))return e;if(t)return"".concat(t.replace(/\/?\/$/,""),"/").concat(e.replace(/^\/+/,""))}throw new TypeError("`url` must be absolute or `baseUrl` non-empty.")}getAccessToken(t){return this.config.getAccessToken?this.config.getAccessToken(t):this.hooks.getAccessToken(t)}extractUrl(t){return"string"==typeof t?t:t instanceof URL?t.href:t.url}buildBaseRequest(t,e){if(!this.config.baseUrl)return new Request(t,e);const r=this.buildUrl(this.config.baseUrl,this.extractUrl(t)),o=t instanceof Request?new Request(r,t):r;return new Request(o,e)}setAuthorizationHeader(t,e){t.headers.set("authorization","".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wt.Bearer," ").concat(e))}setDpopProofHeader(t,e){var r=this;return(0,u.A)(function*(){if(!r.config.dpopNonceId)return;const o=yield r.hooks.getDpopNonce(),i=yield r.hooks.generateDpopProof({accessToken:e,method:t.method,nonce:o,url:t.url});t.headers.set("dpop",i)})()}prepareRequest(t,e){var r=this;return(0,u.A)(function*(){const o=yield r.getAccessToken(e);let i,s;"string"==typeof o?(i=r.config.dpopNonceId?Wt.DPoP:Wt.Bearer,s=o):(i=o.token_type,s=o.access_token),r.setAuthorizationHeader(t,s,i),i===Wt.DPoP&&(yield r.setDpopProofHeader(t,s))})()}getHeader(t,e){return Array.isArray(t)?new Headers(t).get(e)||"":"function"==typeof t.get?t.get(e)||"":t[e]||""}hasUseDpopNonceError(t){if(401!==t.status)return!1;const e=this.getHeader(t.headers,"www-authenticate");return e.includes("invalid_dpop_nonce")||e.includes("use_dpop_nonce")}handleResponse(t,e){var r=this;return(0,u.A)(function*(){const o=r.getHeader(t.headers,"dpop-nonce");if(o&&(yield r.hooks.setDpopNonce(o)),!r.hasUseDpopNonceError(t))return t;if(!o||!e.onUseDpopNonceError)throw new Mt(o);return e.onUseDpopNonceError()})()}internalFetchWithAuth(t,e,r,o){var i=this;return(0,u.A)(function*(){const s=i.buildBaseRequest(t,e);yield i.prepareRequest(s,o);const a=yield i.config.fetch(s);return i.handleResponse(a,r)})()}fetchWithAuth(t,e,r){const o={onUseDpopNonceError:()=>this.internalFetchWithAuth(t,e,Object.assign(Object.assign({},o),{onUseDpopNonceError:void 0}),r)};return this.internalFetchWithAuth(t,e,o,r)}}class _s{constructor(t,e){this.myAccountFetcher=t,this.apiBase=e}connectAccount(t){var e=this;return(0,u.A)(function*(){const r=yield e.myAccountFetcher.fetchWithAuth("".concat(e.apiBase,"v1/connected-accounts/connect"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e._handleResponse(r)})()}completeAccount(t){var e=this;return(0,u.A)(function*(){const r=yield e.myAccountFetcher.fetchWithAuth("".concat(e.apiBase,"v1/connected-accounts/complete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e._handleResponse(r)})()}_handleResponse(t){return(0,u.A)(function*(){let e;try{e=yield t.text(),e=JSON.parse(e)}catch(r){throw new vn({type:"invalid_json",status:t.status,title:"Invalid JSON response",detail:e||String(r)})}if(t.ok)return e;throw new vn(e)})()}}class vn extends Error{constructor(t){let{type:e,status:r,title:o,detail:i,validation_errors:s}=t;super(i),this.name="MyAccountApiError",this.type=e,this.status=r,this.title=o,this.detail=i,this.validation_errors=s,Object.setPrototypeOf(this,vn.prototype)}}const vs={otp:{authenticatorTypes:["otp"]},sms:{authenticatorTypes:["oob"],oobChannels:["sms"]},email:{authenticatorTypes:["oob"],oobChannels:["email"]},push:{authenticatorTypes:["oob"],oobChannels:["auth0"]},voice:{authenticatorTypes:["oob"],oobChannels:["voice"]}};function jo(n,t){this.v=n,this.k=t}function _e(n,t,e){if("function"==typeof n?n===t:n.has(t))return arguments.length<3?t:e;throw new TypeError("Private element is not present on this object")}function Es(n){return new jo(n,0)}function Lo(n,t){if(t.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function N(n,t){return n.get(_e(n,t))}function be(n,t,e){Lo(n,t),t.set(n,e)}function me(n,t,e){return n.set(_e(n,t),e),e}function H(n,t,e){return(t="symbol"==typeof(o=function(i){if("object"!=typeof i||!i)return i;var a=i[Symbol.toPrimitive];if(void 0!==a){var c=a.call(i,"string");if("object"!=typeof c)return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}(t))?o:o+"")in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n;var o}function Ko(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),e.push.apply(e,r)}return e}function G(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?Ko(Object(e),!0).forEach(function(r){H(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):Ko(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function Wo(n,t){if(null==n)return{};var e,r,o=function(s,a){if(null==s)return{};var c={};for(var h in s)if({}.hasOwnProperty.call(s,h)){if(-1!==a.indexOf(h))continue;c[h]=s[h]}return c}(n,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(r=0;r<i.length;r++)-1===t.indexOf(e=i[r])&&{}.propertyIsEnumerable.call(n,e)&&(o[e]=n[e])}return o}function en(n){var t,e;function r(i,s){try{var a=n[i](s),c=a.value,h=c instanceof jo;Promise.resolve(h?c.v:c).then(function(l){if(h){var m="return"===i?"return":"next";if(!c.k||l.done)return r(m,l);l=n[m](l).value}o(a.done?"return":"normal",l)},function(l){r("throw",l)})}catch(l){o("throw",l)}}function o(i,s){switch(i){case"return":t.resolve({value:s,done:!0});break;case"throw":t.reject(s);break;default:t.resolve({value:s,done:!1})}(t=t.next)?r(t.key,t.arg):e=null}this._invoke=function(i,s){return new Promise(function(a,c){var h={key:i,arg:s,resolve:a,reject:c,next:null};e?e=e.next=h:(t=e=h,r(i,s))})},"function"!=typeof n.return&&(this.return=void 0)}var wn,Gn;let Zn;function Nt(n,t){if(null==n)return!1;try{return n instanceof t||Object.getPrototypeOf(n)[Symbol.toStringTag]===t.prototype[Symbol.toStringTag]}catch{return!1}}function ae(n,t,e){const r=new TypeError(n,{cause:e});return Object.assign(r,{code:t}),r}en.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},en.prototype.next=function(n){return this._invoke("next",n)},en.prototype.throw=function(n){return this._invoke("throw",n)},en.prototype.return=function(n){return this._invoke("return",n)},(typeof navigator>"u"||null===(wn=navigator.userAgent)||void 0===wn||null===(Gn=wn.startsWith)||void 0===Gn||!Gn.call(wn,"Mozilla/5.0 "))&&(Zn="".concat("oauth4webapi","/").concat("v3.8.3"));const He=Symbol(),Xn=Symbol(),Yn=Symbol(),Ge=Symbol(),Ts=Symbol(),Qe=Symbol(),ks=new TextEncoder,Ps=new TextDecoder;function zt(n){return"string"==typeof n?ks.encode(n):Ps.decode(n)}let $n,No;function St(n){return"string"==typeof n?No(n):$n(n)}$n=Uint8Array.prototype.toBase64?n=>(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),n.toBase64({alphabet:"base64url",omitPadding:!0})):t=>{t instanceof ArrayBuffer&&(t=new Uint8Array(t));const e=[];for(let r=0;r<t.byteLength;r+=32768)e.push(String.fromCharCode.apply(null,t.subarray(r,r+32768)));return btoa(e.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},No=Uint8Array.fromBase64?n=>{try{return Uint8Array.fromBase64(n,{alphabet:"base64url"})}catch(t){throw ae("The input to be decoded is not correctly encoded.","ERR_INVALID_ARG_VALUE",t)}}:n=>{try{const t=atob(n.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}catch(t){throw ae("The input to be decoded is not correctly encoded.","ERR_INVALID_ARG_VALUE",t)}};class Le extends Error{constructor(t,e){var r;super(t,e),H(this,"code",void 0),this.name=this.constructor.name,this.code=fr,null===(r=Error.captureStackTrace)||void 0===r||r.call(Error,this,this.constructor)}}class Qn extends Error{constructor(t,e){var r;super(t,e),H(this,"code",void 0),this.name=this.constructor.name,null!=e&&e.code&&(this.code=e?.code),null===(r=Error.captureStackTrace)||void 0===r||r.call(Error,this,this.constructor)}}function $(n,t,e){return new Qn(n,{code:t,cause:e})}function bn(n){return null!==n&&"object"==typeof n&&!Array.isArray(n)}function An(n){Nt(n,Headers)&&(n=Object.fromEntries(n.entries()));const t=new Headers(n??{});if(Zn&&!t.has("user-agent")&&t.set("user-agent",Zn),t.has("authorization"))throw ae('"options.headers" must not include the "authorization" header name',"ERR_INVALID_ARG_VALUE");return t}function zo(n,t){if(void 0!==t){if("function"==typeof t&&(t=t(n.href)),!(t instanceof AbortSignal))throw ae('"options.signal" must return or be an instance of AbortSignal',"ERR_INVALID_ARG_TYPE");return t}}function Ho(n){return n.includes("//")?n.replace("//","/"):n}function qn(){return qn=(0,u.A)(function*(n,t){return(e=(0,u.A)(function*(r,o,i,s){if(!(r instanceof URL))throw ae('"'.concat(o,'" must be an instance of URL'),"ERR_INVALID_ARG_TYPE");tr(r,!0!==s?.[He]);const a=i(new URL(r.href)),c=An(s?.headers);return c.set("accept","application/json"),(s?.[Ge]||fetch)(a.href,{body:void 0,headers:Object.fromEntries(c.entries()),method:"GET",redirect:"manual",signal:zo(a,s?.signal)})}),function(r,o,i,s){return e.apply(this,arguments)})(n,"issuerIdentifier",e=>{switch(t?.algorithm){case void 0:case"oidc":(r=e).pathname=Ho("".concat(r.pathname,"/").concat(".well-known/openid-configuration"));break;case"oauth2":!function(r,o){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r.pathname="/"===r.pathname?o:Ho("".concat(o,"/").concat(i?r.pathname:r.pathname.replace(/(\/)$/,"")))}(e,".well-known/oauth-authorization-server");break;default:throw ae('"options.algorithm" must be "oidc" (default), or "oauth2"',"ERR_INVALID_ARG_VALUE")}var r;return e},t);var e}),qn.apply(this,arguments)}function dt(n,t,e,r,o){try{if("number"!=typeof n||!Number.isFinite(n))throw ae("".concat(e," must be a number"),"ERR_INVALID_ARG_TYPE",o);if(n>0)return;if(t){if(0!==n)throw ae("".concat(e," must be a non-negative number"),"ERR_INVALID_ARG_VALUE",o);return}throw ae("".concat(e," must be a positive number"),"ERR_INVALID_ARG_VALUE",o)}catch(i){throw r?$(i.message,r,o):i}}function ve(n,t,e,r){try{if("string"!=typeof n)throw ae("".concat(t," must be a string"),"ERR_INVALID_ARG_TYPE",r);if(0===n.length)throw ae("".concat(t," must not be empty"),"ERR_INVALID_ARG_VALUE",r)}catch(o){throw e?$(o.message,e,r):o}}function Jo(n){!function(t,e){if(Xo(t)!==e)throw function(r){let o='"response" content-type must be ';for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];if(s.length>2){const c=s.pop();o+="".concat(s.join(", "),", or ").concat(c)}else o+=2===s.length?"".concat(s[0]," or ").concat(s[1]):s[0];return $(o,Qo,r)}(t,e)}(n,"application/json")}function Fo(){return St(crypto.getRandomValues(new Uint8Array(32)))}function Os(n){switch(n.algorithm.name){case"RSA-PSS":return function(t){switch(t.algorithm.hash.name){case"SHA-256":return"PS256";case"SHA-384":return"PS384";case"SHA-512":return"PS512";default:throw new Le("unsupported RsaHashedKeyAlgorithm hash name",{cause:t})}}(n);case"RSASSA-PKCS1-v1_5":return function(t){switch(t.algorithm.hash.name){case"SHA-256":return"RS256";case"SHA-384":return"RS384";case"SHA-512":return"RS512";default:throw new Le("unsupported RsaHashedKeyAlgorithm hash name",{cause:t})}}(n);case"ECDSA":return function(t){switch(t.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512";default:throw new Le("unsupported EcKeyAlgorithm namedCurve",{cause:t})}}(n);case"Ed25519":case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return n.algorithm.name;case"EdDSA":return"Ed25519";default:throw new Le("unsupported CryptoKey algorithm name",{cause:n})}}function En(n){const t=n?.[Xn];return"number"==typeof t&&Number.isFinite(t)?t:0}function er(n){const t=n?.[Yn];return"number"==typeof t&&Number.isFinite(t)&&-1!==Math.sign(t)?t:30}function Sn(){return Math.floor(Date.now()/1e3)}function Ze(n){if("object"!=typeof n||null===n)throw ae('"as" must be an object',"ERR_INVALID_ARG_TYPE");ve(n.issuer,'"as.issuer"')}function Xe(n){if("object"!=typeof n||null===n)throw ae('"client" must be an object',"ERR_INVALID_ARG_TYPE");ve(n.client_id,'"client.client_id"')}function Bo(n){return ve(n,'"clientSecret"'),(t,e,r,o)=>{r.set("client_id",e.client_id),r.set("client_secret",n)}}const Cs=URL.parse?(n,t)=>URL.parse(n,t):(n,t)=>{try{return new URL(n,t)}catch{return null}};function tr(n,t){if(t&&"https:"!==n.protocol)throw $("only requests to HTTPS are allowed",qo,n);if("https:"!==n.protocol&&"http:"!==n.protocol)throw $("only HTTP and HTTPS requests are allowed",ei,n)}function tn(n,t,e,r){return function Vo(n,t,e,r){let o;if("string"!=typeof n||!(o=Cs(n)))throw $("authorization server metadata does not contain a valid ".concat(e?'"as.mtls_endpoint_aliases.'.concat(t,'"'):'"as.'.concat(t,'"')),void 0===n?Gs:Zs,{attribute:e?"mtls_endpoint_aliases.".concat(t):t});return tr(o,r),o}(e&&n.mtls_endpoint_aliases&&t in n.mtls_endpoint_aliases?n.mtls_endpoint_aliases[t]:n[t],t,e,r)}class Tn extends Error{constructor(t,e){var r;super(t,e),H(this,"cause",void 0),H(this,"code",void 0),H(this,"error",void 0),H(this,"status",void 0),H(this,"error_description",void 0),H(this,"response",void 0),this.name=this.constructor.name,this.code=Bs,this.cause=e.cause,this.error=e.cause.error,this.status=e.response.status,this.error_description=e.cause.error_description,Object.defineProperty(this,"response",{enumerable:!1,value:e.response}),null===(r=Error.captureStackTrace)||void 0===r||r.call(Error,this,this.constructor)}}class Go extends Error{constructor(t,e){var r,o;super(t,e),H(this,"cause",void 0),H(this,"code",void 0),H(this,"error",void 0),H(this,"error_description",void 0),this.name=this.constructor.name,this.code=Vs,this.cause=e.cause,this.error=e.cause.get("error"),this.error_description=null!==(r=e.cause.get("error_description"))&&void 0!==r?r:void 0,null===(o=Error.captureStackTrace)||void 0===o||o.call(Error,this,this.constructor)}}class nr extends Error{constructor(t,e){var r;super(t,e),H(this,"cause",void 0),H(this,"code",void 0),H(this,"response",void 0),H(this,"status",void 0),this.name=this.constructor.name,this.code=Fs,this.cause=e.cause,this.status=e.response.status,this.response=e.response,Object.defineProperty(this,"response",{enumerable:!1}),null===(r=Error.captureStackTrace)||void 0===r||r.call(Error,this,this.constructor)}}const Us=new RegExp("^[,\\s]*([a-zA-Z0-9!#$%&\\'\\*\\+\\-\\.\\^_`\\|~]+)"),Ms=new RegExp('^[,\\s]*([a-zA-Z0-9!#$%&\\\'\\*\\+\\-\\.\\^_`\\|~]+)\\s*=\\s*"((?:[^"\\\\]|\\\\[\\s\\S])*)"[,\\s]*(.*)'),js=new RegExp("^[,\\s]*([a-zA-Z0-9!#$%&\\'\\*\\+\\-\\.\\^_`\\|~]+)\\s*=\\s*([a-zA-Z0-9!#$%&\\'\\*\\+\\-\\.\\^_`\\|~]+)[,\\s]*(.*)"),Ls=new RegExp("^([a-zA-Z0-9\\-\\._\\~\\+\\/]+={0,2})(?:$|[,\\s])(.*)");function rr(n,t,e){return or.apply(this,arguments)}function or(){return or=(0,u.A)(function*(n,t,e){if(n.status!==t){let o;var r;throw function(i){let s;if(s=function(a){if(!Nt(a,Response))throw ae('"response" must be an instance of Response',"ERR_INVALID_ARG_TYPE");const c=a.headers.get("www-authenticate");if(null===c)return;const h=[];let l=c;for(;l;){var m;let T=l.match(Us);const g=null===(m=T)||void 0===m?void 0:m[1].toLowerCase();if(!g)return;const k=l.substring(T[0].length);if(k&&!k.match(/^[\s,]/))return;const O=k.match(/^\s+(.*)$/);l=O?O[1]:void 0;const I={};let U;if(O)for(;l;){let B,L;if(T=l.match(Ms)){if([,B,L,l]=T,L.includes("\\"))try{L=JSON.parse('"'.concat(L,'"'))}catch{}I[B.toLowerCase()]=L}else{if(!(T=l.match(js))){if(T=l.match(Ls)){if(Object.keys(I).length)break;[,U,l]=T;break}return}[,B,L,l]=T,I[B.toLowerCase()]=L}}else l=k||void 0;const z={scheme:g,parameters:I};U&&(z.token68=U),h.push(z)}return h.length?h:void 0}(i))throw new nr("server responded with a challenge in the WWW-Authenticate HTTP Header",{cause:s,response:i})}(n),(o=yield(i=(0,u.A)(function*(s){if(s.status>399&&s.status<500){on(s),Jo(s);try{const a=yield s.clone().json();if(bn(a)&&"string"==typeof a.error&&a.error.length)return a}catch{}}}),function(s){return i.apply(this,arguments)})(n))?(yield null===(r=n.body)||void 0===r?void 0:r.cancel(),new Tn("server responded with an error in the response body",{cause:o,response:n})):$('"response" is not a conform '.concat(e," response (unexpected HTTP status code)"),mr,n)}var i}),or.apply(this,arguments)}function Zo(n){if(!lr.has(n))throw ae('"options.DPoP" is not a valid DPoPHandle',"ERR_INVALID_ARG_VALUE")}function Xo(n){var t;return null===(t=n.headers.get("content-type"))||void 0===t?void 0:t.split(";")[0]}function ir(n,t,e,r,o,i,s){return sr.apply(this,arguments)}function sr(){return sr=(0,u.A)(function*(n,t,e,r,o,i,s){return yield e(n,t,o,i),i.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),(s?.[Ge]||fetch)(r.href,{body:o,headers:Object.fromEntries(i.entries()),method:"POST",redirect:"manual",signal:zo(r,s?.signal)})}),sr.apply(this,arguments)}function nn(n,t,e,r,o,i){return ar.apply(this,arguments)}function ar(){return ar=(0,u.A)(function*(n,t,e,r,o,i){var s;const a=tn(n,"token_endpoint",t.use_mtls_endpoint_aliases,!0!==i?.[He]);o.set("grant_type",r);const c=An(i?.headers);c.set("accept","application/json"),void 0!==i?.DPoP&&(Zo(i.DPoP),yield i.DPoP.addProof(a,c,"POST"));const h=yield ir(n,t,e,a,o,c,i);return null==i||null===(s=i.DPoP)||void 0===s||s.cacheNonce(h,a),h}),ar.apply(this,arguments)}const Yo=new WeakMap,Ks=new WeakMap;function cr(n){if(!n.id_token)return;const t=Yo.get(n);if(!t)throw ae('"ref" was already garbage collected or did not resolve from the proper sources',"ERR_INVALID_ARG_VALUE");return t}function Ht(n,t,e,r,o,i){return ur.apply(this,arguments)}function ur(){return ur=(0,u.A)(function*(n,t,e,r,o,i){if(Ze(n),Xe(t),!Nt(e,Response))throw ae('"response" must be an instance of Response',"ERR_INVALID_ARG_TYPE");yield rr(e,200,"Token Endpoint"),on(e);const s=yield Pn(e);if(ve(s.access_token,'"response" body "access_token" property',ne,{body:s}),ve(s.token_type,'"response" body "token_type" property',ne,{body:s}),s.token_type=s.token_type.toLowerCase(),void 0!==s.expires_in){let a="number"!=typeof s.expires_in?parseFloat(s.expires_in):s.expires_in;dt(a,!0,'"response" body "expires_in" property',ne,{body:s}),s.expires_in=a}if(void 0!==s.refresh_token&&ve(s.refresh_token,'"response" body "refresh_token" property',ne,{body:s}),void 0!==s.scope&&"string"!=typeof s.scope)throw $('"response" body "scope" property must be a string',ne,{body:s});if(void 0!==s.id_token){ve(s.id_token,'"response" body "id_token" property',ne,{body:s});const a=["aud","exp","iat","iss","sub"];!0===t.require_auth_time&&a.push("auth_time"),void 0!==t.default_max_age&&(dt(t.default_max_age,!0,'"client.default_max_age"'),a.push("auth_time")),null!=r&&r.length&&a.push(...r);const{claims:c,jwt:h}=yield(l=(0,u.A)(function*(m,T,g,k,O){let E,I,{0:U,1:z,length:B}=m.split(".");if(5===B){if(void 0===O)throw new Le("JWE decryption is not configured",{cause:m});m=yield O(m),({0:U,1:z,length:B}=m.split("."))}if(3!==B)throw $("Invalid JWT",ne,m);try{E=JSON.parse(zt(St(U)))}catch(ee){throw $("failed to parse JWT Header body as base64url encoded JSON",kn,ee)}if(!bn(E))throw $("JWT Header must be a top level object",ne,m);if(T(E),void 0!==E.crit)throw new Le('no JWT "crit" header parameter extensions are supported',{cause:{header:E}});try{I=JSON.parse(zt(St(z)))}catch(ee){throw $("failed to parse JWT Payload body as base64url encoded JSON",kn,ee)}if(!bn(I))throw $("JWT Payload must be a top level object",ne,m);const L=Sn()+g;if(void 0!==I.exp){if("number"!=typeof I.exp)throw $('unexpected JWT "exp" (expiration time) claim type',ne,{claims:I});if(I.exp<=L-k)throw $('unexpected JWT "exp" (expiration time) claim value, expiration is past current timestamp',rn,{claims:I,now:L,tolerance:k,claim:"exp"})}if(void 0!==I.iat&&"number"!=typeof I.iat)throw $('unexpected JWT "iat" (issued at) claim type',ne,{claims:I});if(void 0!==I.iss&&"string"!=typeof I.iss)throw $('unexpected JWT "iss" (issuer) claim type',ne,{claims:I});if(void 0!==I.nbf){if("number"!=typeof I.nbf)throw $('unexpected JWT "nbf" (not before) claim type',ne,{claims:I});if(I.nbf>L+k)throw $('unexpected JWT "nbf" (not before) claim value',rn,{claims:I,now:L,tolerance:k,claim:"nbf"})}if(void 0!==I.aud&&"string"!=typeof I.aud&&!Array.isArray(I.aud))throw $('unexpected JWT "aud" (audience) claim type',ne,{claims:I});return{header:E,claims:I,jwt:m}}),function(m,T,g,k,O){return l.apply(this,arguments)})(s.id_token,$s.bind(void 0,t.id_token_signed_response_alg,n.id_token_signing_alg_values_supported,"RS256"),En(t),er(t),o).then(Hs.bind(void 0,a)).then(Ns.bind(void 0,n)).then(Ws.bind(void 0,t.client_id));if(Array.isArray(c.aud)&&1!==c.aud.length){if(void 0===c.azp)throw $('ID Token "aud" (audience) claim includes additional untrusted audiences',at,{claims:c,claim:"aud"});if(c.azp!==t.client_id)throw $('unexpected ID Token "azp" (authorized party) claim value',at,{expected:t.client_id,claims:c,claim:"azp"})}void 0!==c.auth_time&&dt(c.auth_time,!0,'ID Token "auth_time" (authentication time)',ne,{claims:c}),Ks.set(e,h),Yo.set(s,c)}var l;if(void 0!==i?.[s.token_type])i[s.token_type](e,s);else if("dpop"!==s.token_type&&"bearer"!==s.token_type)throw new Le("unsupported `token_type` value",{cause:{body:s}});return s}),ur.apply(this,arguments)}function Ws(n,t){if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(n))throw $('unexpected JWT "aud" (audience) claim value',at,{expected:n,claims:t.claims,claim:"aud"})}else if(t.claims.aud!==n)throw $('unexpected JWT "aud" (audience) claim value',at,{expected:n,claims:t.claims,claim:"aud"});return t}function Ns(n,t){var e,r;const o=null!==(e=null===(r=n[ni])||void 0===r?void 0:r.call(n,t))&&void 0!==e?e:n.issuer;if(t.claims.iss!==o)throw $('unexpected JWT "iss" (issuer) claim value',at,{expected:o,claims:t.claims,claim:"iss"});return t}const lr=new WeakSet,$o=Symbol(),zs={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation",auth_time:"authentication time"};function Hs(n,t){for(const e of n)if(void 0===t.claims[e])throw $('JWT "'.concat(e,'" (').concat(zs[e],") claim missing"),ne,{claims:t.claims});return t}const dr=Symbol(),hr=Symbol();function pr(){return pr=(0,u.A)(function*(n,t,e,r){return"string"==typeof r?.expectedNonce||"number"==typeof r?.maxAge||null!=r&&r.requireIdToken?(o=(0,u.A)(function*(i,s,a,c,h,l,m){const T=[];switch(c){case void 0:c=dr;break;case dr:break;default:ve(c,'"expectedNonce" argument'),T.push("nonce")}switch(null!=h||(h=s.default_max_age),h){case void 0:h=hr;break;case hr:break;default:dt(h,!0,'"maxAge" argument'),T.push("auth_time")}const g=yield Ht(i,s,a,T,l,m);ve(g.id_token,'"response" body "id_token" property',ne,{body:g});const k=cr(g);if(h!==hr){const O=Sn()+En(s),E=er(s);if(k.auth_time+h<O-E)throw $("too much time has elapsed since the last End-User authentication",rn,{claims:k,now:O,tolerance:E,claim:"auth_time"})}if(c===dr){if(void 0!==k.nonce)throw $('unexpected ID Token "nonce" claim value',at,{expected:void 0,claims:k,claim:"nonce"})}else if(k.nonce!==c)throw $('unexpected ID Token "nonce" claim value',at,{expected:c,claims:k,claim:"nonce"});return g}),function(i,s,a,c,h,l,m){return o.apply(this,arguments)})(n,t,e,r.expectedNonce,r.maxAge,r[Qe],r.recognizedTokenTypes):function(){var o=(0,u.A)(function*(i,s,a,c,h){const l=yield Ht(i,s,a,void 0,c,h),m=cr(l);if(m){if(void 0!==s.default_max_age){dt(s.default_max_age,!0,'"client.default_max_age"');const T=Sn()+En(s),g=er(s);if(m.auth_time+s.default_max_age<T-g)throw $("too much time has elapsed since the last End-User authentication",rn,{claims:m,now:T,tolerance:g,claim:"auth_time"})}if(void 0!==m.nonce)throw $('unexpected ID Token "nonce" claim value',at,{expected:void 0,claims:m,claim:"nonce"})}return l});return function(i,s,a,c,h){return o.apply(this,arguments)}}()(n,t,e,r?.[Qe],r?.recognizedTokenTypes);var o}),pr.apply(this,arguments)}const Fs="OAUTH_WWW_AUTHENTICATE_CHALLENGE",Bs="OAUTH_RESPONSE_BODY_ERROR",fr="OAUTH_UNSUPPORTED_OPERATION",Vs="OAUTH_AUTHORIZATION_RESPONSE_ERROR",kn="OAUTH_PARSE_ERROR",ne="OAUTH_INVALID_RESPONSE",Qo="OAUTH_RESPONSE_IS_NOT_JSON",mr="OAUTH_RESPONSE_IS_NOT_CONFORM",qo="OAUTH_HTTP_REQUEST_FORBIDDEN",ei="OAUTH_REQUEST_PROTOCOL_FORBIDDEN",rn="OAUTH_JWT_TIMESTAMP_CHECK_FAILED",at="OAUTH_JWT_CLAIM_COMPARISON_FAILED",yr="OAUTH_JSON_ATTRIBUTE_COMPARISON_FAILED",Gs="OAUTH_MISSING_SERVER_METADATA",Zs="OAUTH_INVALID_SERVER_METADATA";function on(n){if(n.bodyUsed)throw ae('"response" body has been used already',"ERR_INVALID_ARG_VALUE")}function ti(n){const{algorithm:t}=n;if("number"!=typeof t.modulusLength||t.modulusLength<2048)throw new Le("unsupported ".concat(t.name," modulusLength"),{cause:n})}function Xs(n){const{algorithm:t}=n;switch(t.namedCurve){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new Le("unsupported ECDSA namedCurve",{cause:n})}}function gr(){return gr=(0,u.A)(function*(n){if("POST"!==n.method)throw ae("form_post responses are expected to use the POST method","ERR_INVALID_ARG_VALUE",{cause:n});if("application/x-www-form-urlencoded"!==Xo(n))throw ae("form_post responses are expected to use the application/x-www-form-urlencoded content-type","ERR_INVALID_ARG_VALUE",{cause:n});return(t=(0,u.A)(function*(e){if(e.bodyUsed)throw ae("form_post Request instances must contain a readable body","ERR_INVALID_ARG_VALUE",{cause:e});return e.text()}),function(e){return t.apply(this,arguments)})(n);var t}),gr.apply(this,arguments)}function $s(n,t,e,r){if(void 0===n)if(Array.isArray(t)){if(!t.includes(r.alg))throw $('unexpected JWT "alg" header parameter',ne,{header:r,expected:t,reason:"authorization server metadata"})}else{if(void 0===e)throw $('missing client or server configuration to verify used JWT "alg" header parameter',void 0,{client:n,issuer:t,fallback:e});if("string"==typeof e?r.alg!==e:"function"==typeof e?!e(r.alg):!e.includes(r.alg))throw $('unexpected JWT "alg" header parameter',ne,{header:r,expected:e,reason:"default value"})}else if("string"==typeof n?r.alg!==n:!n.includes(r.alg))throw $('unexpected JWT "alg" header parameter',ne,{header:r,expected:n,reason:"client configuration"})}function Tt(n,t){const{0:e,length:r}=n.getAll(t);if(r>1)throw $('"'.concat(t,'" parameter must be provided only once'),ne);return e}const Qs=Symbol(),qs=Symbol();function Pn(n){return _r.apply(this,arguments)}function _r(){return _r=(0,u.A)(function*(n){let t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jo;try{t=yield n.json()}catch(r){throw e(n),$('failed to parse "response" body as JSON',kn,r)}if(!bn(t))throw $('"response" body must be a top level object',ne,{body:t});return t}),_r.apply(this,arguments)}const vr=Symbol(),ni=Symbol(),ri=new TextEncoder,sn=new TextDecoder;function wr(n){const t=new Uint8Array(n.length);for(let e=0;e<n.length;e++){const r=n.charCodeAt(e);if(r>127)throw new TypeError("non-ASCII string encountered in encode()");t[e]=r}return t}function oi(n){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(n);const t=atob(n),e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function an(n){if(Uint8Array.fromBase64)return Uint8Array.fromBase64("string"==typeof n?n:sn.decode(n),{alphabet:"base64url"});let t=n;t instanceof Uint8Array&&(t=sn.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/");try{return oi(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}}class ke extends Error{constructor(t,e){var r;super(t,e),H(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,null===(r=Error.captureStackTrace)||void 0===r||r.call(Error,this,this.constructor)}}H(ke,"code","ERR_JOSE_GENERIC");class Ye extends ke{constructor(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(t,{cause:{claim:r,reason:o,payload:e}}),H(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),H(this,"claim",void 0),H(this,"reason",void 0),H(this,"payload",void 0),this.claim=r,this.reason=o,this.payload=e}}H(Ye,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class br extends ke{constructor(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(t,{cause:{claim:r,reason:o,payload:e}}),H(this,"code","ERR_JWT_EXPIRED"),H(this,"claim",void 0),H(this,"reason",void 0),H(this,"payload",void 0),this.claim=r,this.reason=o,this.payload=e}}H(br,"code","ERR_JWT_EXPIRED");class ii extends ke{constructor(){super(...arguments),H(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}H(ii,"code","ERR_JOSE_ALG_NOT_ALLOWED");class Ke extends ke{constructor(){super(...arguments),H(this,"code","ERR_JOSE_NOT_SUPPORTED")}}H(Ke,"code","ERR_JOSE_NOT_SUPPORTED"),H(class extends ke{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"decryption operation failed",arguments.length>1?arguments[1]:void 0),H(this,"code","ERR_JWE_DECRYPTION_FAILED")}},"code","ERR_JWE_DECRYPTION_FAILED"),H(class extends ke{constructor(){super(...arguments),H(this,"code","ERR_JWE_INVALID")}},"code","ERR_JWE_INVALID");class Ee extends ke{constructor(){super(...arguments),H(this,"code","ERR_JWS_INVALID")}}H(Ee,"code","ERR_JWS_INVALID");class Ar extends ke{constructor(){super(...arguments),H(this,"code","ERR_JWT_INVALID")}}H(Ar,"code","ERR_JWT_INVALID"),H(class extends ke{constructor(){super(...arguments),H(this,"code","ERR_JWK_INVALID")}},"code","ERR_JWK_INVALID");class Er extends ke{constructor(){super(...arguments),H(this,"code","ERR_JWKS_INVALID")}}H(Er,"code","ERR_JWKS_INVALID");class Sr extends ke{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no applicable key found in the JSON Web Key Set",arguments.length>1?arguments[1]:void 0),H(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}H(Sr,"code","ERR_JWKS_NO_MATCHING_KEY");class si extends ke{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"multiple matching keys found in the JSON Web Key Set",arguments.length>1?arguments[1]:void 0),H(this,Symbol.asyncIterator,void 0),H(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}H(si,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class ai extends ke{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"request timed out",arguments.length>1?arguments[1]:void 0),H(this,"code","ERR_JWKS_TIMEOUT")}}H(ai,"code","ERR_JWKS_TIMEOUT");class ci extends ke{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"signature verification failed",arguments.length>1?arguments[1]:void 0),H(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}H(ci,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");const qe=function(n){return new TypeError("CryptoKey does not support this operation, its ".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"algorithm.name"," must be ").concat(n))},Jt=(n,t)=>n.name===t;function Tr(n){return parseInt(n.name.slice(4),10)}function ui(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),o=2;o<e;o++)r[o-2]=arguments[o];if((r=r.filter(Boolean)).length>2){const s=r.pop();n+="one of type ".concat(r.join(", "),", or ").concat(s,".")}else n+=2===r.length?"one of type ".concat(r[0]," or ").concat(r[1],"."):"of type ".concat(r[0],".");if(null==t)n+=" Received ".concat(t);else if("function"==typeof t&&t.name)n+=" Received function ".concat(t.name);else if("object"==typeof t&&null!=t){var i;null!==(i=t.constructor)&&void 0!==i&&i.name&&(n+=" Received an instance of ".concat(t.constructor.name))}return n}const li=function(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),o=2;o<e;o++)r[o-2]=arguments[o];return ui("Key for the ".concat(n," algorithm must be "),t,...r)},di=n=>{if("CryptoKey"===n?.[Symbol.toStringTag])return!0;try{return n instanceof CryptoKey}catch{return!1}},hi=n=>"KeyObject"===n?.[Symbol.toStringTag],pi=n=>di(n)||hi(n);function ht(n){if("object"!=typeof(t=n)||null===t||"[object Object]"!==Object.prototype.toString.call(n))return!1;var t;if(null===Object.getPrototypeOf(n))return!0;let e=n;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e}const kr=(n,t)=>{if(n.byteLength!==t.length)return!1;for(let e=0;e<n.byteLength;e++)if(n[e]!==t[e])return!1;return!0},cn=n=>{const t=n.data[n.pos++];if(128&t){const e=127&t;let r=0;for(let o=0;o<e;o++)r=r<<8|n.data[n.pos++];return r}return t},un=(n,t,e)=>{if(n.data[n.pos++]!==t)throw new Error(e)},fi=(n,t)=>{const e=n.data.subarray(n.pos,n.pos+t);return n.pos+=t,e},ra=function(){var n=(0,u.A)(function*(t,e,r,o){var i;let s,a;const c="spki"===t,h=()=>c?["verify"]:["sign"];switch(r){case"PS256":case"PS384":case"PS512":s={name:"RSA-PSS",hash:"SHA-".concat(r.slice(-3))},a=h();break;case"RS256":case"RS384":case"RS512":s={name:"RSASSA-PKCS1-v1_5",hash:"SHA-".concat(r.slice(-3))},a=h();break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":s={name:"RSA-OAEP",hash:"SHA-".concat(parseInt(r.slice(-3),10)||1)},a=c?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":case"ES384":case"ES512":s={name:"ECDSA",namedCurve:{ES256:"P-256",ES384:"P-384",ES512:"P-521"}[r]},a=h();break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":try{const l=o.getNamedCurve(e);s="X25519"===l?{name:"X25519"}:{name:"ECDH",namedCurve:l}}catch{throw new Ke("Invalid or unsupported key format")}a=c?[]:["deriveBits"];break;case"Ed25519":case"EdDSA":s={name:"Ed25519"},a=h();break;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":s={name:r},a=h();break;default:throw new Ke('Invalid or unsupported "alg" (Algorithm) value')}return crypto.subtle.importKey(t,e,s,null!==(i=o?.extractable)&&void 0!==i?i:!!c,a)});return function(e,r,o,i){return n.apply(this,arguments)}}(),oa=(n,t,e)=>{var r;const o=oi(n.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""));let i=e;return null!=t&&null!==(r=t.startsWith)&&void 0!==r&&r.call(t,"ECDH-ES")&&(i||(i={}),i.getNamedCurve=s=>{const a={data:s,pos:0};return function(c){un(c,48,"Invalid PKCS#8 structure"),cn(c),un(c,2,"Expected version field");const h=cn(c);c.pos+=h,un(c,48,"Expected algorithm identifier"),cn(c)}(a),(n=>{const t=(o=>{un(o,6,"Expected algorithm OID");const i=cn(o);return fi(o,i)})(n);if(kr(t,[43,101,110]))return"X25519";if(!kr(t,[42,134,72,206,61,2,1]))throw new Error("Unsupported key algorithm");un(n,6,"Expected curve OID");const e=cn(n),r=fi(n,e);for(const{name:o,oid:i}of[{name:"P-256",oid:[42,134,72,206,61,3,1,7]},{name:"P-384",oid:[43,129,4,0,34]},{name:"P-521",oid:[43,129,4,0,35]}])if(kr(r,i))return o;throw new Error("Unsupported named curve")})(a)}),ra("pkcs8",o,t,i)};function In(n){return Pr.apply(this,arguments)}function Pr(){return Pr=(0,u.A)(function*(n){var t,e;if(!n.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:r,keyUsages:o}=function(s){let a,c;switch(s.kty){case"AKP":switch(s.alg){case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":a={name:s.alg},c=s.priv?["sign"]:["verify"];break;default:throw new Ke('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(s.alg){case"PS256":case"PS384":case"PS512":a={name:"RSA-PSS",hash:"SHA-".concat(s.alg.slice(-3))},c=s.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":a={name:"RSASSA-PKCS1-v1_5",hash:"SHA-".concat(s.alg.slice(-3))},c=s.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":a={name:"RSA-OAEP",hash:"SHA-".concat(parseInt(s.alg.slice(-3),10)||1)},c=s.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new Ke('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(s.alg){case"ES256":a={name:"ECDSA",namedCurve:"P-256"},c=s.d?["sign"]:["verify"];break;case"ES384":a={name:"ECDSA",namedCurve:"P-384"},c=s.d?["sign"]:["verify"];break;case"ES512":a={name:"ECDSA",namedCurve:"P-521"},c=s.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":a={name:"ECDH",namedCurve:s.crv},c=s.d?["deriveBits"]:[];break;default:throw new Ke('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(s.alg){case"Ed25519":case"EdDSA":a={name:"Ed25519"},c=s.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":a={name:s.crv},c=s.d?["deriveBits"]:[];break;default:throw new Ke('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new Ke('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:a,keyUsages:c}}(n),i=G({},n);return"AKP"!==i.kty&&delete i.alg,delete i.use,crypto.subtle.importKey("jwk",i,r,null!==(t=n.ext)&&void 0!==t?t:!n.d&&!n.priv,null!==(e=n.key_ops)&&void 0!==e?e:o)}),Pr.apply(this,arguments)}const Ir=n=>ht(n)&&"string"==typeof n.kty;let pt;const mi=function(){var n=(0,u.A)(function*(t,e,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];pt||(pt=new WeakMap);let i=pt.get(t);if(null!=i&&i[r])return i[r];const s=yield In(G(G({},e),{},{alg:r}));return o&&Object.freeze(t),i?i[r]=s:pt.set(t,{[r]:s}),s});return function(e,r,o){return n.apply(this,arguments)}}();function xr(){return xr=(0,u.A)(function*(n,t){if(n instanceof Uint8Array||di(n))return n;if(hi(n)){if("secret"===n.type)return n.export();if("toCryptoKey"in n&&"function"==typeof n.toCryptoKey)try{return((r,o)=>{pt||(pt=new WeakMap);let i=pt.get(r);if(null!=i&&i[o])return i[o];const s="public"===r.type,a=!!s;let c;if("x25519"===r.asymmetricKeyType){switch(o){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}c=r.toCryptoKey(r.asymmetricKeyType,a,s?[]:["deriveBits"])}if("ed25519"===r.asymmetricKeyType){if("EdDSA"!==o&&"Ed25519"!==o)throw new TypeError("given KeyObject instance cannot be used for this algorithm");c=r.toCryptoKey(r.asymmetricKeyType,a,[s?"verify":"sign"])}switch(r.asymmetricKeyType){case"ml-dsa-44":case"ml-dsa-65":case"ml-dsa-87":if(o!==r.asymmetricKeyType.toUpperCase())throw new TypeError("given KeyObject instance cannot be used for this algorithm");c=r.toCryptoKey(r.asymmetricKeyType,a,[s?"verify":"sign"])}if("rsa"===r.asymmetricKeyType){let l;switch(o){case"RSA-OAEP":l="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":l="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":l="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":l="SHA-512";break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}if(o.startsWith("RSA-OAEP"))return r.toCryptoKey({name:"RSA-OAEP",hash:l},a,s?["encrypt"]:["decrypt"]);c=r.toCryptoKey({name:o.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:l},a,[s?"verify":"sign"])}if("ec"===r.asymmetricKeyType){var h;const l=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(null===(h=r.asymmetricKeyDetails)||void 0===h?void 0:h.namedCurve);if(!l)throw new TypeError("given KeyObject instance cannot be used for this algorithm");"ES256"===o&&"P-256"===l&&(c=r.toCryptoKey({name:"ECDSA",namedCurve:l},a,[s?"verify":"sign"])),"ES384"===o&&"P-384"===l&&(c=r.toCryptoKey({name:"ECDSA",namedCurve:l},a,[s?"verify":"sign"])),"ES512"===o&&"P-521"===l&&(c=r.toCryptoKey({name:"ECDSA",namedCurve:l},a,[s?"verify":"sign"])),o.startsWith("ECDH-ES")&&(c=r.toCryptoKey({name:"ECDH",namedCurve:l},a,s?[]:["deriveBits"]))}if(!c)throw new TypeError("given KeyObject instance cannot be used for this algorithm");return i?i[o]=c:pt.set(r,{[o]:c}),c})(n,t)}catch(r){if(r instanceof TypeError)throw r}let e=n.export({format:"jwk"});return mi(n,e,t)}if(Ir(n))return n.k?an(n.k):mi(n,n,t,!0);throw new Error("unreachable")}),xr.apply(this,arguments)}const Ft=n=>n?.[Symbol.toStringTag],Or=(n,t,e)=>{if(void 0!==t.use){let i;switch(e){case"sign":case"verify":i="sig";break;case"encrypt":case"decrypt":i="enc"}if(t.use!==i)throw new TypeError('Invalid key for this operation, its "use" must be "'.concat(i,'" when present'))}if(void 0!==t.alg&&t.alg!==n)throw new TypeError('Invalid key for this operation, its "alg" must be "'.concat(n,'" when present'));if(Array.isArray(t.key_ops)){var r,o;let i;switch(!0){case"sign"===e||"verify"===e:case"dir"===n:case n.includes("CBC-HS"):i=e;break;case n.startsWith("PBES2"):i="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(n):i=!n.includes("GCM")&&n.endsWith("KW")?"encrypt"===e?"wrapKey":"unwrapKey":e;break;case"encrypt"===e&&n.startsWith("RSA"):i="wrapKey";break;case"decrypt"===e:i=n.startsWith("RSA")?"unwrapKey":"deriveBits"}if(i&&!1===(null===(r=t.key_ops)||void 0===r||null===(o=r.includes)||void 0===o?void 0:o.call(r,i)))throw new TypeError('Invalid key for this operation, its "key_ops" must include "'.concat(i,'" when present'))}return!0};var xn,Rr;let et,yi;(typeof navigator>"u"||null===(xn=navigator.userAgent)||void 0===xn||null===(Rr=xn.startsWith)||void 0===Rr||!Rr.call(xn,"Mozilla/5.0 "))&&(yi="".concat("openid-client","/").concat("v6.8.1"),et={"user-agent":yi});const Pe=n=>On.get(n);let On,Rn;function gi(n){return void 0!==n?Bo(n):(Rn||(Rn=new WeakMap),(t,e,r,o)=>{let i;return(i=Rn.get(e))||(function(s,a){if("string"!=typeof s)throw tt("".concat(a," must be a string"),dn);if(0===s.length)throw tt("".concat(a," must not be empty"),ln)}(e.client_secret,'"metadata.client_secret"'),i=Bo(e.client_secret),Rn.set(e,i)),i(t,e,r,o)})}const ft=Ge,ln="ERR_INVALID_ARG_VALUE",dn="ERR_INVALID_ARG_TYPE";function tt(n,t,e){const r=new TypeError(n,{cause:e});return Object.assign(r,{code:t}),r}class Cn extends Error{constructor(t,e){var r;super(t,e),H(this,"code",void 0),this.name=this.constructor.name,this.code=e?.code,null===(r=Error.captureStackTrace)||void 0===r||r.call(Error,this,this.constructor)}}function Oe(n,t,e){return new Cn(n,{cause:t,code:e})}function Re(n){if(n instanceof TypeError||n instanceof Cn||n instanceof Tn||n instanceof Go||n instanceof nr)throw n;if(n instanceof Qn)switch(n.code){case qo:throw Oe("only requests to HTTPS are allowed",n,n.code);case ei:throw Oe("only requests to HTTP or HTTPS are allowed",n,n.code);case mr:throw Oe("unexpected HTTP response status code",n.cause,n.code);case Qo:throw Oe("unexpected response content-type",n.cause,n.code);case kn:throw Oe("parsing error occured",n,n.code);case ne:throw Oe("invalid response encountered",n,n.code);case at:throw Oe("unexpected JWT claim value encountered",n,n.code);case yr:throw Oe("unexpected JSON attribute value encountered",n,n.code);case rn:throw Oe("JWT timestamp claim value failed validation",n,n.code);default:throw Oe(n.message,n,n.code)}if(n instanceof Le)throw Oe("unsupported operation",n,n.code);if(n instanceof DOMException)switch(n.name){case"OperationError":throw Oe("runtime operation error",n,fr);case"NotSupportedError":throw Oe("runtime unsupported operation",n,fr);case"TimeoutError":throw Oe("operation timed out",n,"OAUTH_TIMEOUT");case"AbortError":throw Oe("operation aborted",n,"OAUTH_ABORT")}throw new Cn("something went wrong",{cause:n})}function Cr(){return Cr=(0,u.A)(function*(n,t,e,r,o){const i=yield(c=(0,u.A)(function*(h,l){var m,T;if(!(h instanceof URL))throw tt('"server" must be an instance of URL',dn);const g=!h.href.includes("/.well-known/"),k=null!==(m=l?.timeout)&&void 0!==m?m:30,O=AbortSignal.timeout(1e3*k),E=yield(g?function xs(n,t){return qn.apply(this,arguments)}(h,{algorithm:l?.algorithm,[Ge]:l?.[ft],[He]:null==l||null===(T=l.execute)||void 0===T?void 0:T.includes(Ei),signal:O,headers:new Headers(et)}):(l?.[ft]||fetch)((tr(h,null==l||null===(I=l.execute)||void 0===I||!I.includes(Ei)),h.href),{headers:Object.fromEntries(new Headers(G({accept:"application/json"},et)).entries()),body:void 0,method:"GET",redirect:"manual",signal:O})).then(U=>{return(z=(0,u.A)(function*(B,L){const ee=B;if(!(ee instanceof URL)&&ee!==vr)throw ae('"expectedIssuerIdentifier" must be an instance of URL',"ERR_INVALID_ARG_TYPE");if(!Nt(L,Response))throw ae('"response" must be an instance of Response',"ERR_INVALID_ARG_TYPE");if(200!==L.status)throw $('"response" is not a conform Authorization Server Metadata response (unexpected HTTP status code)',mr,L);on(L);const ie=yield Pn(L);if(ve(ie.issuer,'"response" body "issuer" property',ne,{body:ie}),ee!==vr&&new URL(ie.issuer).href!==ee.href)throw $('"response" body "issuer" property does not match the expected value',yr,{expected:ee.href,body:ie,attribute:"issuer"});return ie}),function(B,L){return z.apply(this,arguments)})(vr,U);var z}).catch(Re);var I,B;return g&&new URL(E.issuer).href!==h.href&&(B=l,!("https://login.microsoftonline.com"!==h.origin||null!=B&&B.algorithm&&"oidc"!==B.algorithm||(E[_i]=!0,0))||function(U,z){return!(!U.hostname.endsWith(".b2clogin.com")||null!=z&&z.algorithm&&"oidc"!==z.algorithm)}(h,l)||(()=>{throw new Cn("discovered metadata issuer does not match the expected issuer",{code:yr,cause:{expected:h.href,body:E,attribute:"issuer"}})})()),E}),function(h,l){return c.apply(this,arguments)})(n,o),s=new Dn(i,t,e,r);var c;let a=Pe(s);if(null!=o&&o[ft]&&(a.fetch=o[ft]),null!=o&&o.timeout&&(a.timeout=o.timeout),null!=o&&o.execute)for(const c of o.execute)c(s);return s}),Cr.apply(this,arguments)}new TextDecoder;const _i=Symbol();class Dn{constructor(t,e,r,o){var i,s,a,c,h;if("string"!=typeof e||!e.length)throw tt('"clientId" must be a non-empty string',dn);if("string"==typeof r&&(r={client_secret:r}),void 0!==(null===(i=r)||void 0===i?void 0:i.client_id)&&e!==r.client_id)throw tt('"clientId" and "metadata.client_id" must be the same',ln);const l=G(G({},structuredClone(r)),{},{client_id:e});let m;l[Xn]=null!==(s=null===(a=r)||void 0===a?void 0:a[Xn])&&void 0!==s?s:0,l[Yn]=null!==(c=null===(h=r)||void 0===h?void 0:h[Yn])&&void 0!==c?c:30,m=o||("string"==typeof l.client_secret&&l.client_secret.length?gi(l.client_secret):(O,E,I,U)=>{I.set("client_id",E.client_id)});let T=Object.freeze(l);const g=structuredClone(t);_i in t&&(g[ni]=O=>{let{claims:{tid:E}}=O;return t.issuer.replace("{tenantid}",E)});let k=Object.freeze(g);On||(On=new WeakMap),On.set(this,{__proto__:null,as:k,c:T,auth:m,tlsOnly:!0,jwksCache:{}})}serverMetadata(){const t=structuredClone(Pe(this).as);return e=t,Object.defineProperties(e,function(r){return{supportsPKCE:{__proto__:null,value(){var o;return!0===(null===(o=r.code_challenge_methods_supported)||void 0===o?void 0:o.includes(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"S256"))}}}}(e)),t;var e}clientMetadata(){return structuredClone(Pe(this).c)}get timeout(){return Pe(this).timeout}set timeout(t){Pe(this).timeout=t}get[ft](){return Pe(this).fetch}set[ft](t){Pe(this).fetch=t}}function hn(n){Object.defineProperties(n,function(t){let e;if(void 0!==t.expires_in){const r=new Date;r.setSeconds(r.getSeconds()+t.expires_in),e=r.getTime()}return{expiresIn:{__proto__:null,value(){if(e){const r=Date.now();return e>r?Math.floor((e-r)/1e3):0}}},claims:{__proto__:null,value(){try{return cr(this)}catch{return}}}}}(n))}function vi(n,t,e){return Dr.apply(this,arguments)}function Dr(){return Dr=(0,u.A)(function*(n,t,e){var r;let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=null===(r=n.headers.get("retry-after"))||void 0===r?void 0:r.trim();if(void 0===i)return;let s;if(/^\d+$/.test(i))s=parseInt(i,10);else{const a=new Date(i);if(Number.isFinite(a.getTime())){const c=new Date,h=a.getTime()-c.getTime();h>0&&(s=Math.ceil(h/1e3))}}if(o&&!Number.isFinite(s))throw new Qn("invalid Retry-After header value",{cause:n});s>t&&(yield wi(s-t,e))}),Dr.apply(this,arguments)}function wi(n,t){return new Promise((e,r)=>{const o=i=>{try{t.throwIfAborted()}catch(a){return void r(a)}if(i<=0)return void e();const s=Math.min(i,5);setTimeout(()=>o(i-s),1e3*s)};o(n)})}function bi(n,t){return Ur.apply(this,arguments)}function Ur(){return Ur=(0,u.A)(function*(n,t){ct(n);const{as:e,c:r,auth:o,fetch:i,tlsOnly:s,timeout:a}=Pe(n);return(c=(0,u.A)(function*(h,l,m,T,g){Ze(h),Xe(l);const k=tn(h,"backchannel_authentication_endpoint",l.use_mtls_endpoint_aliases,!0!==g?.[He]),O=new URLSearchParams(T);O.set("client_id",l.client_id);const E=An(g?.headers);return E.set("accept","application/json"),ir(h,l,m,k,O,E,g)}),function(h,l,m,T,g){return c.apply(this,arguments)})(e,r,o,t,{[Ge]:i,[He]:!s,headers:new Headers(et),signal:kt(a)}).then(c=>{return(h=(0,u.A)(function*(l,m,T){if(Ze(l),Xe(m),!Nt(T,Response))throw ae('"response" must be an instance of Response',"ERR_INVALID_ARG_TYPE");yield rr(T,200,"Backchannel Authentication Endpoint"),on(T);const g=yield Pn(T);ve(g.auth_req_id,'"response" body "auth_req_id" property',ne,{body:g});let k="number"!=typeof g.expires_in?parseFloat(g.expires_in):g.expires_in;return dt(k,!0,'"response" body "expires_in" property',ne,{body:g}),g.expires_in=k,void 0!==g.interval&&dt(g.interval,!1,'"response" body "interval" property',ne,{body:g}),g}),function(l,m,T){return h.apply(this,arguments)})(e,r,c);var h}).catch(Re);var c}),Ur.apply(this,arguments)}function Ai(n,t,e,r){return Mr.apply(this,arguments)}function Mr(){return Mr=(0,u.A)(function*(n,t,e,r){var o,i;ct(n),e=new URLSearchParams(e);let s=null!==(o=t.interval)&&void 0!==o?o:5;const a=null!==(i=r?.signal)&&void 0!==i?i:AbortSignal.timeout(1e3*t.expires_in);try{yield wi(s,a)}catch(L){Re(L)}const{as:c,c:h,auth:l,fetch:m,tlsOnly:T,nonRepudiation:g,timeout:k,decrypt:O}=Pe(n),E=(L,ee)=>Ai(n,G(G({},t),{},{interval:L}),e,G(G({},r),{},{signal:a,flag:ee})),I=yield(L=(0,u.A)(function*(ee,ie,We,Se,st){Ze(ee),Xe(ie),ve(Se,'"authReqId"');const De=new URLSearchParams(st?.additionalParameters);return De.set("auth_req_id",Se),nn(ee,ie,We,"urn:openid:params:grant-type:ciba",De,st)}),function(ee,ie,We,Se,st){return L.apply(this,arguments)})(c,h,l,t.auth_req_id,{[Ge]:m,[He]:!T,additionalParameters:e,DPoP:r?.DPoP,headers:new Headers(et),signal:a.aborted?a:kt(k)}).catch(Re);var L,U;if(503===I.status&&I.headers.has("retry-after"))return yield vi(I,s,a,!0),yield null===(U=I.body)||void 0===U?void 0:U.cancel(),E(s);const z=function(){var L=(0,u.A)(function*(ee,ie,We,Se){return Ht(ee,ie,We,void 0,Se?.[Qe],Se?.recognizedTokenTypes)});return function(ee,ie,We,Se){return L.apply(this,arguments)}}()(c,h,I,{[Qe]:O});let B;try{B=yield z}catch(L){if(pn(L,r))return E(s,mt);if(L instanceof Tn)switch(L.error){case"slow_down":s+=5;case"authorization_pending":return yield vi(L.response,s,a),E(s)}Re(L)}return B.id_token&&(yield g?.(I)),hn(B),B}),Mr.apply(this,arguments)}function Ei(n){Pe(n).tlsOnly=!1}function Si(n,t,e,r,o){return jr.apply(this,arguments)}function jr(){return jr=(0,u.A)(function*(n,t,e,r,o){if(ct(n),!(o?.flag===mt||t instanceof URL||function(L){try{return"Request"===Object.getPrototypeOf(L)[Symbol.toStringTag]}catch{return!1}}(t)))throw tt('"currentUrl" must be an instance of URL, or Request',dn);let i,s;const{as:a,c,auth:h,fetch:l,tlsOnly:m,jarm:T,hybrid:g,nonRepudiation:k,timeout:O,decrypt:E,implicit:I}=Pe(n);if(o?.flag===mt)i=o.authResponse,s=o.redirectUri;else{if(!(t instanceof URL)){const L=t;switch(t=new URL(t.url),L.method){case"GET":break;case"POST":const ee=new URLSearchParams(yield function Ys(n){return gr.apply(this,arguments)}(L));if(g)t.hash=ee.toString();else for(const[ie,We]of ee.entries())t.searchParams.append(ie,We);break;default:throw tt("unexpected Request HTTP method",ln)}}switch(L=t,(L=new URL(L)).search="",L.hash="",s=L.href,!0){case!!T:i=yield T(t,e?.expectedState);break;case!!g:i=yield g(t,e?.expectedNonce,e?.expectedState,e?.maxAge);break;case!!I:throw new TypeError("authorizationCodeGrant() cannot be used by response_type=id_token clients");default:try{i=function ea(n,t,e,r){if(Ze(n),Xe(t),e instanceof URL&&(e=e.searchParams),!(e instanceof URLSearchParams))throw ae('"parameters" must be an instance of URLSearchParams, or URL',"ERR_INVALID_ARG_TYPE");if(Tt(e,"response"))throw $('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()',ne,{parameters:e});const o=Tt(e,"iss"),i=Tt(e,"state");if(!o&&n.authorization_response_iss_parameter_supported)throw $('response parameter "iss" (issuer) missing',ne,{parameters:e});if(o&&o!==n.issuer)throw $('unexpected "iss" (issuer) response parameter value',ne,{expected:n.issuer,parameters:e});switch(r){case void 0:case qs:if(void 0!==i)throw $('unexpected "state" response parameter encountered',ne,{expected:void 0,parameters:e});break;case Qs:break;default:if(ve(r,'"expectedState" argument'),i!==r)throw $(void 0===i?'response parameter "state" missing':'unexpected "state" response parameter value',ne,{expected:r,parameters:e})}if(Tt(e,"error"))throw new Go("authorization response from the server is an error",{cause:e});const s=Tt(e,"id_token"),a=Tt(e,"token");if(void 0!==s||void 0!==a)throw new Le("implicit and hybrid flows are not supported");return c=new URLSearchParams(e),lr.add(c),c;var c}(a,c,t.searchParams,e?.expectedState)}catch(L){Re(L)}}}var L;const U=yield function(){var L=(0,u.A)(function*(ee,ie,We,Se,st,De,Dt){if(Ze(ee),Xe(ie),!lr.has(Se))throw ae('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()',"ERR_INVALID_ARG_VALUE");ve(st,'"redirectUri"');const Hi=Tt(Se,"code");if(!Hi)throw $('no authorization code in "callbackParameters"',ne);const Nn=new URLSearchParams(Dt?.additionalParameters);return Nn.set("redirect_uri",st),Nn.set("code",Hi),De!==$o&&(ve(De,'"codeVerifier"'),Nn.set("code_verifier",De)),nn(ee,ie,We,"authorization_code",Nn,Dt)});return function(ee,ie,We,Se,st,De,Dt){return L.apply(this,arguments)}}()(a,c,h,i,s,e?.pkceCodeVerifier||$o,{additionalParameters:r,[Ge]:l,[He]:!m,DPoP:o?.DPoP,headers:new Headers(et),signal:kt(O)}).catch(Re);"string"!=typeof e?.expectedNonce&&"number"!=typeof e?.maxAge||(e.idTokenExpected=!0);const z=function Js(n,t,e,r){return pr.apply(this,arguments)}(a,c,U,{expectedNonce:e?.expectedNonce,maxAge:e?.maxAge,requireIdToken:e?.idTokenExpected,[Qe]:E});let B;try{B=yield z}catch(L){if(pn(L,o))return Si(n,void 0,e,r,G(G({},o),{},{flag:mt,authResponse:i,redirectUri:s}));Re(L)}return B.id_token&&(yield k?.(U)),hn(B),B}),jr.apply(this,arguments)}function Ti(n,t,e,r){return Lr.apply(this,arguments)}function Lr(){return Lr=(0,u.A)(function*(n,t,e,r){ct(n),e=new URLSearchParams(e);const{as:o,c:i,auth:s,fetch:a,tlsOnly:c,nonRepudiation:h,timeout:l,decrypt:m}=Pe(n),T=yield(O=(0,u.A)(function*(E,I,U,z,B){Ze(E),Xe(I),ve(z,'"refreshToken"');const L=new URLSearchParams(B?.additionalParameters);return L.set("refresh_token",z),nn(E,I,U,"refresh_token",L,B)}),function(E,I,U,z,B){return O.apply(this,arguments)})(o,i,s,t,{[Ge]:a,[He]:!c,additionalParameters:e,DPoP:r?.DPoP,headers:new Headers(et),signal:kt(l)}).catch(Re),g=function(){var O=(0,u.A)(function*(E,I,U,z){return Ht(E,I,U,void 0,z?.[Qe],z?.recognizedTokenTypes)});return function(E,I,U,z){return O.apply(this,arguments)}}()(o,i,T,{[Qe]:m});var O;let k;try{k=yield g}catch(O){if(pn(O,r))return Ti(n,t,e,G(G({},r),{},{flag:mt}));Re(O)}return k.id_token&&(yield h?.(T)),hn(k),k}),Lr.apply(this,arguments)}function ki(n,t,e){return Kr.apply(this,arguments)}function Kr(){return Kr=(0,u.A)(function*(n,t,e){ct(n),t=new URLSearchParams(t);const{as:r,c:o,auth:i,fetch:s,tlsOnly:a,timeout:c}=Pe(n),h=yield(T=(0,u.A)(function*(g,k,O,E,I){return Ze(g),Xe(k),nn(g,k,O,"client_credentials",new URLSearchParams(E),I)}),function(g,k,O,E,I){return T.apply(this,arguments)})(r,o,i,t,{[Ge]:s,[He]:!a,DPoP:e?.DPoP,headers:new Headers(et),signal:kt(c)}).catch(Re),l=function(){var T=(0,u.A)(function*(g,k,O,E){return Ht(g,k,O,void 0,E?.[Qe],E?.recognizedTokenTypes)});return function(g,k,O,E){return T.apply(this,arguments)}}()(r,o,h);var T;let m;try{m=yield l}catch(T){if(pn(T,e))return ki(n,t,G(G({},e),{},{flag:mt}));Re(T)}return hn(m),m}),Kr.apply(this,arguments)}function Wr(n,t){ct(n);const{as:e,c:r,tlsOnly:o,hybrid:i,jarm:s,implicit:a}=Pe(n),c=tn(e,"authorization_endpoint",!1,o);if((t=new URLSearchParams(t)).has("client_id")||t.set("client_id",r.client_id),!t.has("request_uri")&&!t.has("request")){if(t.has("response_type")||t.set("response_type",i?"code id_token":a?"id_token":"code"),a&&!t.has("nonce"))throw tt("response_type=id_token clients must provide a nonce parameter in their authorization request parameters",ln);s&&t.set("response_mode","jwt")}for(const[h,l]of t.entries())c.searchParams.append(h,l);return c}function Pi(n,t,e){return Nr.apply(this,arguments)}function Nr(){return Nr=(0,u.A)(function*(n,t,e){ct(n);const r=Wr(n,t),{as:o,c:i,auth:s,fetch:a,tlsOnly:c,timeout:h}=Pe(n),l=yield(g=(0,u.A)(function*(k,O,E,I,U){var z;Ze(k),Xe(O);const B=tn(k,"pushed_authorization_request_endpoint",O.use_mtls_endpoint_aliases,!0!==U?.[He]),L=new URLSearchParams(I);L.set("client_id",O.client_id);const ee=An(U?.headers);ee.set("accept","application/json"),void 0!==U?.DPoP&&(Zo(U.DPoP),yield U.DPoP.addProof(B,ee,"POST"));const ie=yield ir(k,O,E,B,L,ee,U);return null==U||null===(z=U.DPoP)||void 0===z||z.cacheNonce(ie,B),ie}),function(k,O,E,I,U){return g.apply(this,arguments)})(o,i,s,r.searchParams,{[Ge]:a,[He]:!c,DPoP:e?.DPoP,headers:new Headers(et),signal:kt(h)}).catch(Re),m=function(){var g=(0,u.A)(function*(k,O,E){if(Ze(k),Xe(O),!Nt(E,Response))throw ae('"response" must be an instance of Response',"ERR_INVALID_ARG_TYPE");yield rr(E,201,"Pushed Authorization Request Endpoint"),on(E);const I=yield Pn(E);ve(I.request_uri,'"response" body "request_uri" property',ne,{body:I});let U="number"!=typeof I.expires_in?parseFloat(I.expires_in):I.expires_in;return dt(U,!0,'"response" body "expires_in" property',ne,{body:I}),I.expires_in=U,I});return function(k,O,E){return g.apply(this,arguments)}}()(o,i,l);var g;let T;try{T=yield m}catch(g){if(pn(g,e))return Pi(n,t,G(G({},e),{},{flag:mt}));Re(g)}return Wr(n,{request_uri:T.request_uri})}),Nr.apply(this,arguments)}function ct(n){if(!(n instanceof Dn))throw tt('"config" must be an instance of Configuration',dn);if(Object.getPrototypeOf(n)!==Dn.prototype)throw tt("subclassing Configuration is not allowed",ln)}function kt(n){return n?AbortSignal.timeout(1e3*n):void 0}function pn(n,t){return!(null==t||!t.DPoP||t.flag===mt)&&function(e){if(e instanceof nr){const{0:r,length:o}=e.cause;return 1===o&&"dpop"===r.scheme&&"use_dpop_nonce"===r.parameters.error}return e instanceof Tn&&"use_dpop_nonce"===e.error}(n)}Object.freeze(Dn.prototype);const mt=Symbol();function zr(n,t,e,r){return Hr.apply(this,arguments)}function Hr(){return Hr=(0,u.A)(function*(n,t,e,r){ct(n);const{as:o,c:i,auth:s,fetch:a,tlsOnly:c,timeout:h,decrypt:l}=Pe(n),m=yield(T=(0,u.A)(function*(g,k,O,E,I,U){return Ze(g),Xe(k),ve(E,'"grantType"'),nn(g,k,O,E,new URLSearchParams(I),U)}),function(g,k,O,E,I,U){return T.apply(this,arguments)})(o,i,s,t,new URLSearchParams(e),{[Ge]:a,[He]:!c,DPoP:r?.DPoP,headers:new Headers(et),signal:kt(h)}).then(T=>{let g;return"urn:ietf:params:oauth:grant-type:token-exchange"===t&&(g={n_a:()=>{}}),(k=(0,u.A)(function*(O,E,I,U){return Ht(O,E,I,void 0,U?.[Qe],U?.recognizedTokenTypes)}),function(O,E,I,U){return k.apply(this,arguments)})(o,i,T,{[Qe]:l,recognizedTokenTypes:g});var k}).catch(Re);var T;return hn(m),m}),Hr.apply(this,arguments)}function Jr(){return Jr=(0,u.A)(function*(n,t,e){if(t instanceof Uint8Array){if(!n.startsWith("HS"))throw new TypeError(function(r){for(var o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];return ui("Key must be ",r,...i)}(t,"CryptoKey","KeyObject","JSON Web Key"));return crypto.subtle.importKey("raw",t,{hash:"SHA-".concat(n.slice(-3)),name:"HMAC"},!1,[e])}return function ta(n,t,e){switch(t){case"HS256":case"HS384":case"HS512":{if(!Jt(n.algorithm,"HMAC"))throw qe("HMAC");const r=parseInt(t.slice(2),10);if(Tr(n.algorithm.hash)!==r)throw qe("SHA-".concat(r),"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!Jt(n.algorithm,"RSASSA-PKCS1-v1_5"))throw qe("RSASSA-PKCS1-v1_5");const r=parseInt(t.slice(2),10);if(Tr(n.algorithm.hash)!==r)throw qe("SHA-".concat(r),"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!Jt(n.algorithm,"RSA-PSS"))throw qe("RSA-PSS");const r=parseInt(t.slice(2),10);if(Tr(n.algorithm.hash)!==r)throw qe("SHA-".concat(r),"algorithm.hash");break}case"Ed25519":case"EdDSA":if(!Jt(n.algorithm,"Ed25519"))throw qe("Ed25519");break;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":if(!Jt(n.algorithm,t))throw qe(t);break;case"ES256":case"ES384":case"ES512":{if(!Jt(n.algorithm,"ECDSA"))throw qe("ECDSA");const r=function(o){switch(o){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}(t);if(n.algorithm.namedCurve!==r)throw qe(r,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}!function(r,o){if(o&&!r.usages.includes(o))throw new TypeError("CryptoKey does not support this operation, its usages must include ".concat(o,"."))}(n,e)}(t,n,e),t}),Jr.apply(this,arguments)}function Fr(){return Fr=(0,u.A)(function*(n,t,e,r){const o=yield function la(n,t,e){return Jr.apply(this,arguments)}(n,t,"verify");!function(s,a){if(s.startsWith("RS")||s.startsWith("PS")){const{modulusLength:c}=a.algorithm;if("number"!=typeof c||c<2048)throw new TypeError("".concat(s," requires key modulusLength to be 2048 bits or larger"))}}(n,o);const i=function(s,a){const c="SHA-".concat(s.slice(-3));switch(s){case"HS256":case"HS384":case"HS512":return{hash:c,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:c,name:"RSA-PSS",saltLength:parseInt(s.slice(-3),10)>>3};case"RS256":case"RS384":case"RS512":return{hash:c,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:c,name:"ECDSA",namedCurve:a.namedCurve};case"Ed25519":case"EdDSA":return{name:"Ed25519"};case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return{name:s};default:throw new Ke("alg ".concat(s," is not supported either by JOSE or your javascript runtime"))}}(n,o.algorithm);try{return yield crypto.subtle.verify(i,o,e,r)}catch{return!1}}),Fr.apply(this,arguments)}function Br(){return Br=(0,u.A)(function*(n,t,e){if(!ht(n))throw new Ee("Flattened JWS must be an object");if(void 0===n.protected&&void 0===n.header)throw new Ee('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==n.protected&&"string"!=typeof n.protected)throw new Ee("JWS Protected Header incorrect type");if(void 0===n.payload)throw new Ee("JWS Payload missing");if("string"!=typeof n.signature)throw new Ee("JWS Signature missing or incorrect type");if(void 0!==n.header&&!ht(n.header))throw new Ee("JWS Unprotected Header incorrect type");let r={};if(n.protected)try{const O=an(n.protected);r=JSON.parse(sn.decode(O))}catch{throw new Ee("JWS Protected Header is invalid")}if(!function(){for(var O=arguments.length,E=new Array(O),I=0;I<O;I++)E[I]=arguments[I];const U=E.filter(Boolean);if(0===U.length||1===U.length)return!0;let z;for(const B of U){const L=Object.keys(B);if(z&&0!==z.size)for(const ee of L){if(z.has(ee))return!1;z.add(ee)}else z=new Set(L)}return!0}(r,n.header))throw new Ee("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const o=G(G({},r),n.header);let s=!0;if(function(O,E,I,U,z){if(void 0!==z.crit&&void 0===U?.crit)throw new O('"crit" (Critical) Header Parameter MUST be integrity protected');if(!U||void 0===U.crit)return new Set;if(!Array.isArray(U.crit)||0===U.crit.length||U.crit.some(L=>"string"!=typeof L||0===L.length))throw new O('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let B;B=void 0!==I?new Map([...Object.entries(I),...E.entries()]):E;for(const L of U.crit){if(!B.has(L))throw new Ke('Extension Header Parameter "'.concat(L,'" is not recognized'));if(void 0===z[L])throw new O('Extension Header Parameter "'.concat(L,'" is missing'));if(B.get(L)&&void 0===U[L])throw new O('Extension Header Parameter "'.concat(L,'" MUST be integrity protected'))}return new Set(U.crit)}(Ee,new Map([["b64",!0]]),e?.crit,r,o).has("b64")&&(s=r.b64,"boolean"!=typeof s))throw new Ee('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:a}=o;if("string"!=typeof a||!a)throw new Ee('JWS "alg" (Algorithm) Header Parameter missing or invalid');const c=e&&function(O,E){if(void 0!==E&&(!Array.isArray(E)||E.some(I=>"string"!=typeof I)))throw new TypeError('"'.concat("algorithms",'" option must be an array of strings'));if(E)return new Set(E)}(0,e.algorithms);if(c&&!c.has(a))throw new ii('"alg" (Algorithm) Header Parameter value not allowed');if(s){if("string"!=typeof n.payload)throw new Ee("JWS Payload must be a string")}else if("string"!=typeof n.payload&&!(n.payload instanceof Uint8Array))throw new Ee("JWS Payload must be a string or an Uint8Array instance");let h=!1;"function"==typeof t&&(t=yield t(r,n),h=!0),function sa(n,t,e){switch(n.substring(0,2)){case"A1":case"A2":case"di":case"HS":case"PB":((r,o,i)=>{if(!(o instanceof Uint8Array)){if(Ir(o)){if("oct"===(s=o).kty&&"string"==typeof s.k&&Or(r,o,i))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!pi(o))throw new TypeError(li(r,o,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if("secret"!==o.type)throw new TypeError("".concat(Ft(o),' instances for symmetric algorithms must be of type "secret"'))}var s})(n,t,e);break;default:((r,o,i)=>{if(Ir(o))switch(i){case"decrypt":case"sign":if("oct"!==(s=o).kty&&("AKP"===s.kty&&"string"==typeof s.priv||"string"==typeof s.d)&&Or(r,o,i))return;throw new TypeError("JSON Web Key for this operation must be a private JWK");case"encrypt":case"verify":if((s=>"oct"!==s.kty&&void 0===s.d&&void 0===s.priv)(o)&&Or(r,o,i))return;throw new TypeError("JSON Web Key for this operation must be a public JWK")}var s;if(!pi(o))throw new TypeError(li(r,o,"CryptoKey","KeyObject","JSON Web Key"));if("secret"===o.type)throw new TypeError("".concat(Ft(o),' instances for asymmetric algorithms must not be of type "secret"'));if("public"===o.type)switch(i){case"sign":throw new TypeError("".concat(Ft(o),' instances for asymmetric algorithm signing must be of type "private"'));case"decrypt":throw new TypeError("".concat(Ft(o),' instances for asymmetric algorithm decryption must be of type "private"'))}if("private"===o.type)switch(i){case"verify":throw new TypeError("".concat(Ft(o),' instances for asymmetric algorithm verifying must be of type "public"'));case"encrypt":throw new TypeError("".concat(Ft(o),' instances for asymmetric algorithm encryption must be of type "public"'))}})(n,t,e)}}(a,t,"verify");const l=function(){for(var O=arguments.length,E=new Array(O),I=0;I<O;I++)E[I]=arguments[I];const U=E.reduce((L,ee)=>{let{length:ie}=ee;return L+ie},0),z=new Uint8Array(U);let B=0;for(const L of E)z.set(L,B),B+=L.length;return z}(void 0!==n.protected?wr(n.protected):new Uint8Array,wr("."),"string"==typeof n.payload?s?wr(n.payload):ri.encode(n.payload):n.payload);let m;try{m=an(n.signature)}catch{throw new Ee("Failed to base64url decode the signature")}const T=yield function ia(n,t){return xr.apply(this,arguments)}(t,a);if(!(yield function da(n,t,e,r){return Fr.apply(this,arguments)}(a,T,m,l)))throw new ci;let g;if(s)try{g=an(n.payload)}catch{throw new Ee("Failed to base64url decode the payload")}else g="string"==typeof n.payload?ri.encode(n.payload):n.payload;const k={payload:g};return void 0!==n.protected&&(k.protectedHeader=r),void 0!==n.header&&(k.unprotectedHeader=n.header),h?G(G({},k),{},{key:T}):k}),Br.apply(this,arguments)}const fa=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;function Ii(n){const t=fa.exec(n);if(!t||t[4]&&t[1])throw new TypeError("Invalid time period format");const e=parseFloat(t[2]);let r;switch(t[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":r=Math.round(e);break;case"minute":case"minutes":case"min":case"mins":case"m":r=Math.round(60*e);break;case"hour":case"hours":case"hr":case"hrs":case"h":r=Math.round(3600*e);break;case"day":case"days":case"d":r=Math.round(86400*e);break;case"week":case"weeks":case"w":r=Math.round(604800*e);break;default:r=Math.round(31557600*e)}return"-"===t[1]||"ago"===t[4]?-r:r}const xi=n=>n.includes("/")?n.toLowerCase():"application/".concat(n.toLowerCase());function Vr(){return Vr=(0,u.A)(function*(n,t,e){var r;const o=yield(a=(0,u.A)(function*(c,h,l){if(c instanceof Uint8Array&&(c=sn.decode(c)),"string"!=typeof c)throw new Ee("Compact JWS must be a string or Uint8Array");const{0:m,1:T,2:g,length:k}=c.split(".");if(3!==k)throw new Ee("Invalid Compact JWS");const O=yield function ha(n,t,e){return Br.apply(this,arguments)}({payload:T,protected:m,signature:g},h,l),E={payload:O.payload,protectedHeader:O.protectedHeader};return"function"==typeof h?G(G({},E),{},{key:O.key}):E}),function(c,h,l){return a.apply(this,arguments)})(n,t,e);var a;if(null!==(r=o.protectedHeader.crit)&&void 0!==r&&r.includes("b64")&&!1===o.protectedHeader.b64)throw new Ar("JWTs MUST NOT use unencoded payload");const i=function(a,c){let h,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{h=JSON.parse(sn.decode(c))}catch{}if(!ht(h))throw new Ar("JWT Claims Set must be a top-level JSON object");const{typ:m}=l;if(m&&("string"!=typeof a.typ||xi(a.typ)!==xi(m)))throw new Ye('unexpected "typ" JWT header value',h,"typ","check_failed");const{requiredClaims:T=[],issuer:g,subject:k,audience:O,maxTokenAge:E}=l,I=[...T];void 0!==E&&I.push("iat"),void 0!==O&&I.push("aud"),void 0!==k&&I.push("sub"),void 0!==g&&I.push("iss");for(const L of new Set(I.reverse()))if(!(L in h))throw new Ye('missing required "'.concat(L,'" claim'),h,L,"missing");if(g&&!(Array.isArray(g)?g:[g]).includes(h.iss))throw new Ye('unexpected "iss" claim value',h,"iss","check_failed");if(k&&h.sub!==k)throw new Ye('unexpected "sub" claim value',h,"sub","check_failed");if(O&&!((n,t)=>"string"==typeof n?t.includes(n):!!Array.isArray(n)&&t.some(Set.prototype.has.bind(new Set(n))))(h.aud,"string"==typeof O?[O]:O))throw new Ye('unexpected "aud" claim value',h,"aud","check_failed");let U;switch(typeof l.clockTolerance){case"string":U=Ii(l.clockTolerance);break;case"number":U=l.clockTolerance;break;case"undefined":U=0;break;default:throw new TypeError("Invalid clockTolerance option type")}const{currentDate:z}=l,B=(n=>Math.floor(n.getTime()/1e3))(z||new Date);if((void 0!==h.iat||E)&&"number"!=typeof h.iat)throw new Ye('"iat" claim must be a number',h,"iat","invalid");if(void 0!==h.nbf){if("number"!=typeof h.nbf)throw new Ye('"nbf" claim must be a number',h,"nbf","invalid");if(h.nbf>B+U)throw new Ye('"nbf" claim timestamp check failed',h,"nbf","check_failed")}if(void 0!==h.exp){if("number"!=typeof h.exp)throw new Ye('"exp" claim must be a number',h,"exp","invalid");if(h.exp<=B-U)throw new br('"exp" claim timestamp check failed',h,"exp","check_failed")}if(E){const L=B-h.iat;if(L-U>("number"==typeof E?E:Ii(E)))throw new br('"iat" claim timestamp check failed (too far in the past)',h,"iat","check_failed");if(L<0-U)throw new Ye('"iat" claim timestamp check failed (it should be in the past)',h,"iat","check_failed")}return h}(o.protectedHeader,o.payload,e),s={payload:i,protectedHeader:o.protectedHeader};return"function"==typeof t?G(G({},s),{},{key:o.key}):s}),Vr.apply(this,arguments)}function ga(n){return ht(n)}var Un,Gr,Mn=new WeakMap,Zr=new WeakMap;class _a{constructor(t){if(be(this,Mn,void 0),be(this,Zr,new WeakMap),!((e=t)&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(ga)))throw new Er("JSON Web Key Set malformed");var e;me(Mn,this,structuredClone(t))}jwks(){return N(Mn,this)}getKey(t,e){var r=this;return(0,u.A)(function*(){const{alg:o,kid:i}=G(G({},t),e?.header),s=function(l){switch("string"==typeof l&&l.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";case"ML":return"AKP";default:throw new Ke('Unsupported "alg" value for a JSON Web Key Set')}}(o),a=N(Mn,r).keys.filter(l=>{let m=s===l.kty;if(m&&"string"==typeof i&&(m=i===l.kid),!m||"string"!=typeof l.alg&&"AKP"!==s||(m=o===l.alg),m&&"string"==typeof l.use&&(m="sig"===l.use),m&&Array.isArray(l.key_ops)&&(m=l.key_ops.includes("verify")),m)switch(o){case"ES256":m="P-256"===l.crv;break;case"ES384":m="P-384"===l.crv;break;case"ES512":m="P-521"===l.crv;break;case"Ed25519":case"EdDSA":m="Ed25519"===l.crv}return m}),{0:c,length:h}=a;if(0===h)throw new Sr;if(1!==h){const l=new si,m=N(Zr,r);throw l[Symbol.asyncIterator]=function Ss(n){return function(){return new en(n.apply(this,arguments))}}(function*(){for(const T of a)try{yield yield Es(Oi(m,T,o))}catch{}}),l}return Oi(N(Zr,r),c,o)})()}}function Oi(n,t,e){return Xr.apply(this,arguments)}function Xr(){return Xr=(0,u.A)(function*(n,t,e){const r=n.get(t)||n.set(t,{}).get(t);if(void 0===r[e]){const o=yield(i=(0,u.A)(function*(s,a,c){var h;if(!ht(s))throw new TypeError("JWK must be an object");let l;switch(null!=a||(a=s.alg),null!=l||(l=null!==(h=c?.extractable)&&void 0!==h?h:s.ext),s.kty){case"oct":if("string"!=typeof s.k||!s.k)throw new TypeError('missing "k" (Key Value) Parameter value');return an(s.k);case"RSA":if("oth"in s&&void 0!==s.oth)throw new Ke('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');return In(G(G({},s),{},{alg:a,ext:l}));case"AKP":if("string"!=typeof s.alg||!s.alg)throw new TypeError('missing "alg" (Algorithm) Parameter value');if(void 0!==a&&a!==s.alg)throw new TypeError("JWK alg and alg option value mismatch");return In(G(G({},s),{},{ext:l}));case"EC":case"OKP":return In(G(G({},s),{},{alg:a,ext:l}));default:throw new Ke('Unsupported "kty" (Key Type) Parameter value')}}),function(s,a,c){return i.apply(this,arguments)})(G(G({},t),{},{ext:!0}),e);if(o instanceof Uint8Array||"public"!==o.type)throw new Er("JSON Web Key Set members must be public keys");r[e]=o}var i;return r[e]}),Xr.apply(this,arguments)}function Ri(n){const t=new _a(n),e=function(){var r=(0,u.A)(function*(o,i){return t.getKey(o,i)});return function(i,s){return r.apply(this,arguments)}}();return Object.defineProperties(e,{jwks:{value:()=>structuredClone(t.jwks()),enumerable:!1,configurable:!1,writable:!1}}),e}let Yr;(typeof navigator>"u"||null===(Un=navigator.userAgent)||void 0===Un||null===(Gr=Un.startsWith)||void 0===Gr||!Gr.call(Un,"Mozilla/5.0 "))&&(Yr="".concat("jose","/").concat("v6.1.3"));const Ci=Symbol(),$r=Symbol();var Qr=new WeakMap,qr=new WeakMap,eo=new WeakMap,jn=new WeakMap,Pt=new WeakMap,ut=new WeakMap,yt=new WeakMap,to=new WeakMap,It=new WeakMap,xt=new WeakMap;class va{constructor(t,e){if(be(this,Qr,void 0),be(this,qr,void 0),be(this,eo,void 0),be(this,jn,void 0),be(this,Pt,void 0),be(this,ut,void 0),be(this,yt,void 0),be(this,to,void 0),be(this,It,void 0),be(this,xt,void 0),!(t instanceof URL))throw new TypeError("url must be an instance of URL");var r,o;me(Qr,this,new URL(t.href)),me(qr,this,"number"==typeof e?.timeoutDuration?e?.timeoutDuration:5e3),me(eo,this,"number"==typeof e?.cooldownDuration?e?.cooldownDuration:3e4),me(jn,this,"number"==typeof e?.cacheMaxAge?e?.cacheMaxAge:6e5),me(yt,this,new Headers(e?.headers)),Yr&&!N(yt,this).has("User-Agent")&&N(yt,this).set("User-Agent",Yr),N(yt,this).has("accept")||(N(yt,this).set("accept","application/json"),N(yt,this).append("accept","application/jwk-set+json")),me(to,this,e?.[Ci]),void 0!==e?.[$r]&&(me(xt,this,e?.[$r]),r=e?.[$r],o=N(jn,this),"object"==typeof r&&null!==r&&"uat"in r&&"number"==typeof r.uat&&!(Date.now()-r.uat>=o)&&"jwks"in r&&ht(r.jwks)&&Array.isArray(r.jwks.keys)&&Array.prototype.every.call(r.jwks.keys,ht)&&(me(Pt,this,N(xt,this).uat),me(It,this,Ri(N(xt,this).jwks))))}pendingFetch(){return!!N(ut,this)}coolingDown(){return"number"==typeof N(Pt,this)&&Date.now()<N(Pt,this)+N(eo,this)}fresh(){return"number"==typeof N(Pt,this)&&Date.now()<N(Pt,this)+N(jn,this)}jwks(){var t;return null===(t=N(It,this))||void 0===t?void 0:t.jwks()}getKey(t,e){var r=this;return(0,u.A)(function*(){N(It,r)&&r.fresh()||(yield r.reload());try{return yield N(It,r).call(r,t,e)}catch(o){if(o instanceof Sr&&!1===r.coolingDown())return yield r.reload(),N(It,r).call(r,t,e);throw o}})()}reload(){var t=this;return(0,u.A)(function*(){var e;N(ut,t)&&(typeof WebSocketPair<"u"||typeof navigator<"u"&&"Cloudflare-Workers"===navigator.userAgent||typeof EdgeRuntime<"u"&&"vercel"===EdgeRuntime)&&me(ut,t,void 0),N(ut,t)||me(ut,t,(e=(0,u.A)(function*(r,o,i){const a=yield(arguments.length>3&&void 0!==arguments[3]?arguments[3]:fetch)(r,{method:"GET",signal:i,redirect:"manual",headers:o}).catch(c=>{throw"TimeoutError"===c.name?new ai:c});if(200!==a.status)throw new ke("Expected 200 OK from the JSON Web Key Set HTTP response");try{return yield a.json()}catch{throw new ke("Failed to parse the JSON Web Key Set HTTP response as JSON")}}),function(r,o,i){return e.apply(this,arguments)})(N(Qr,t).href,N(yt,t),AbortSignal.timeout(N(qr,t)),N(to,t)).then(e=>{me(It,t,Ri(e)),N(xt,t)&&(N(xt,t).uat=Date.now(),N(xt,t).jwks=e),me(Pt,t,Date.now()),me(ut,t,void 0)}).catch(e=>{throw me(ut,t,void 0),e})),yield N(ut,t)})()}}const wa=["mfaToken"],ba=["mfaToken"];var Ot,Ln,Rt,gt,Bt,le,fn,we,Di=class extends Error{constructor(n,t){super(t),H(this,"code",void 0),this.name="NotSupportedError",this.code=n}},lt=class extends Error{constructor(n,t,e){super(t),H(this,"cause",void 0),H(this,"code",void 0),this.code=n,this.cause=e&&{error:e.error,error_description:e.error_description,message:e.message}}},Aa=class extends lt{constructor(n,t){super("token_by_code_error",n,t),this.name="TokenByCodeError"}},Ea=class extends lt{constructor(n,t){super("token_by_client_credentials_error",n,t),this.name="TokenByClientCredentialsError"}},Sa=class extends lt{constructor(n,t){super("token_by_refresh_token_error",n,t),this.name="TokenByRefreshTokenError"}},no=class extends lt{constructor(n,t){super("token_for_connection_error",n,t),this.name="TokenForConnectionErrorCode"}},nt=class extends lt{constructor(n,t){super("token_exchange_error",n,t),this.name="TokenExchangeError"}},_t=class extends Error{constructor(n){super(n),H(this,"code","verify_logout_token_error"),this.name="VerifyLogoutTokenError"}},ro=class extends lt{constructor(n){super("backchannel_authentication_error","There was an error when trying to use Client-Initiated Backchannel Authentication.",n),H(this,"code","backchannel_authentication_error"),this.name="BackchannelAuthenticationError"}},Ta=class extends lt{constructor(n){super("build_authorization_url_error","There was an error when trying to build the authorization URL.",n),this.name="BuildAuthorizationUrlError"}},ka=class extends lt{constructor(n){super("build_link_user_url_error","There was an error when trying to build the Link User URL.",n),this.name="BuildLinkUserUrlError"}},Pa=class extends lt{constructor(n){super("build_unlink_user_url_error","There was an error when trying to build the Unlink User URL.",n),this.name="BuildUnlinkUserUrlError"}},Ia=class extends Error{constructor(){super("The client secret or client assertion signing key must be provided."),H(this,"code","missing_client_auth_error"),this.name="MissingClientAuthError"}};function oo(n){return Object.entries(n).filter(t=>{let[,e]=t;return void 0!==e}).reduce((t,e)=>G(G({},t),{},{[e[0]]:e[1]}),{})}var Kn=class extends Error{constructor(n,t,e){super(t),H(this,"cause",void 0),H(this,"code",void 0),this.code=n,this.cause=e&&{error:e.error,error_description:e.error_description,message:e.message}}},Ui=class extends Kn{constructor(n,t){super("mfa_list_authenticators_error",n,t),this.name="MfaListAuthenticatorsError"}},Mi=class extends Kn{constructor(n,t){super("mfa_enrollment_error",n,t),this.name="MfaEnrollmentError"}},xa=class extends Kn{constructor(n,t){super("mfa_delete_authenticator_error",n,t),this.name="MfaDeleteAuthenticatorError"}},ji=class extends Kn{constructor(n,t){super("mfa_challenge_error",n,t),this.name="MfaChallengeError"}};function Oa(n){return{id:n.id,authenticatorType:n.authenticator_type,active:n.active,name:n.name,oobChannels:n.oob_channels,type:n.type}}var Ra=(Ot=new WeakMap,Ln=new WeakMap,Rt=new WeakMap,class{constructor(n){var t;be(this,Ot,void 0),be(this,Ln,void 0),be(this,Rt,void 0),me(Ot,this,"https://".concat(n.domain)),me(Ln,this,n.clientId),me(Rt,this,null!==(t=n.customFetch)&&void 0!==t?t:function(){return fetch(...arguments)})}listAuthenticators(n){var t=this;return(0,u.A)(function*(){const e="".concat(N(Ot,t),"/mfa/authenticators"),{mfaToken:r}=n,o=yield N(Rt,t).call(t,e,{method:"GET",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});if(!o.ok){const i=yield o.json();throw new Ui(i.error_description||"Failed to list authenticators",i)}return(yield o.json()).map(Oa)})()}enrollAuthenticator(n){var t=this;return(0,u.A)(function*(){const e="".concat(N(Ot,t),"/mfa/associate"),{mfaToken:r}=n,o=Wo(n,wa),i={authenticator_types:o.authenticatorTypes};"oobChannels"in o&&(i.oob_channels=o.oobChannels),"phoneNumber"in o&&o.phoneNumber&&(i.phone_number=o.phoneNumber),"email"in o&&o.email&&(i.email=o.email);const s=yield N(Rt,t).call(t,e,{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify(i)});if(!s.ok){const a=yield s.json();throw new Mi(a.error_description||"Failed to enroll authenticator",a)}return function(a){if("otp"===a.authenticator_type)return{authenticatorType:"otp",secret:a.secret,barcodeUri:a.barcode_uri,recoveryCodes:a.recovery_codes,id:a.id};if("oob"===a.authenticator_type)return{authenticatorType:"oob",oobChannel:a.oob_channel,oobCode:a.oob_code,bindingMethod:a.binding_method,id:a.id};throw new Error("Unexpected authenticator type: ".concat(a.authenticator_type))}(yield s.json())})()}deleteAuthenticator(n){var t=this;return(0,u.A)(function*(){const{authenticatorId:e,mfaToken:r}=n,o="".concat(N(Ot,t),"/mfa/authenticators/").concat(encodeURIComponent(e)),i=yield N(Rt,t).call(t,o,{method:"DELETE",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});if(!i.ok){const s=yield i.json();throw new xa(s.error_description||"Failed to delete authenticator",s)}})()}challengeAuthenticator(n){var t=this;return(0,u.A)(function*(){const e="".concat(N(Ot,t),"/mfa/challenge"),{mfaToken:r}=n,o=Wo(n,ba),i={mfa_token:r,client_id:N(Ln,t),challenge_type:o.challengeType};o.authenticatorId&&(i.authenticator_id=o.authenticatorId);const s=yield N(Rt,t).call(t,e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!s.ok){const a=yield s.json();throw new ji(a.error_description||"Failed to challenge authenticator",a)}return function(a){const c={challengeType:a.challenge_type};return void 0!==a.oob_code&&(c.oobCode=a.oob_code),void 0!==a.binding_method&&(c.bindingMethod=a.binding_method),c}(yield s.json())})()}}),Ct=class Ji{constructor(t,e,r,o,i,s,a){H(this,"accessToken",void 0),H(this,"idToken",void 0),H(this,"refreshToken",void 0),H(this,"expiresAt",void 0),H(this,"scope",void 0),H(this,"claims",void 0),H(this,"authorizationDetails",void 0),H(this,"tokenType",void 0),H(this,"issuedTokenType",void 0),this.accessToken=t,this.idToken=r,this.refreshToken=o,this.expiresAt=e,this.scope=i,this.claims=s,this.authorizationDetails=a}static fromTokenEndpointResponse(t){const e=t.id_token?t.claims():void 0,r=new Ji(t.access_token,Math.floor(Date.now()/1e3)+Number(t.expires_in),t.id_token,t.refresh_token,t.scope,e,t.authorization_details);return r.tokenType=t.token_type,r.issuedTokenType=t.issued_token_type,r}},io="openid profile email offline_access",Ca=Object.freeze(new Set(["grant_type","client_id","client_secret","client_assertion","client_assertion_type","subject_token","subject_token_type","requested_token_type","actor_token","actor_token_type","audience","aud","resource","resources","resource_indicator","scope","connection","login_hint","organization","assertion"]));function Li(n){if(null==n)throw new nt("subject_token is required");if("string"!=typeof n)throw new nt("subject_token must be a string");if(0===n.trim().length)throw new nt("subject_token cannot be blank or whitespace");if(n!==n.trim())throw new nt("subject_token must not include leading or trailing whitespace");if(/^bearer\s+/i.test(n))throw new nt("subject_token must not include the 'Bearer ' prefix")}function Ki(n,t){if(t)for(const[e,r]of Object.entries(t))if(!Ca.has(e))if(Array.isArray(r)){if(r.length>20)throw new nt("Parameter '".concat(e,"' exceeds maximum array size of ").concat(20));r.forEach(o=>{n.append(e,o)})}else n.append(e,r)}var Da=(gt=new WeakMap,Bt=new WeakMap,le=new WeakMap,fn=new WeakMap,we=new WeakSet,class{constructor(n){if(Lo(this,e=we),e.add(this),be(this,gt,void 0),be(this,Bt,void 0),be(this,le,void 0),be(this,fn,void 0),H(this,"mfa",void 0),me(le,this,n),n.useMtls&&!n.customFetch)throw new Di("mtls_without_custom_fetch_not_supported","Using mTLS without a custom fetch implementation is not supported");var e;this.mfa=new Ra({domain:N(le,this).domain,clientId:N(le,this).clientId,customFetch:N(le,this).customFetch})}buildAuthorizationUrl(n){var t=this;return(0,u.A)(function*(){const{serverMetadata:e}=yield _e(we,t,Je).call(t);if(null!=n&&n.pushedAuthorizationRequests&&!e.pushed_authorization_request_endpoint)throw new Di("par_not_supported_error","The Auth0 tenant does not have pushed authorization requests enabled. Learn how to enable it here: https://auth0.com/docs/get-started/applications/configure-par");try{return yield _e(we,t,lo).call(t,n)}catch(r){throw new Ta(r)}})()}buildLinkUserUrl(n){var t=this;return(0,u.A)(function*(){try{const e=yield _e(we,t,lo).call(t,{authorizationParams:G(G({},n.authorizationParams),{},{requested_connection:n.connection,requested_connection_scope:n.connectionScope,scope:"openid link_account offline_access",id_token_hint:n.idToken})});return{linkUserUrl:e.authorizationUrl,codeVerifier:e.codeVerifier}}catch(e){throw new ka(e)}})()}buildUnlinkUserUrl(n){var t=this;return(0,u.A)(function*(){try{const e=yield _e(we,t,lo).call(t,{authorizationParams:G(G({},n.authorizationParams),{},{requested_connection:n.connection,scope:"openid unlink_account",id_token_hint:n.idToken})});return{unlinkUserUrl:e.authorizationUrl,codeVerifier:e.codeVerifier}}catch(e){throw new Pa(e)}})()}backchannelAuthentication(n){var t=this;return(0,u.A)(function*(){const{configuration:e,serverMetadata:r}=yield _e(we,t,Je).call(t),o=oo(G(G({},N(le,t).authorizationParams),n?.authorizationParams)),i=new URLSearchParams(G(G({scope:io},o),{},{client_id:N(le,t).clientId,binding_message:n.bindingMessage,login_hint:JSON.stringify({format:"iss_sub",iss:r.issuer,sub:n.loginHint.sub})}));n.requestedExpiry&&i.append("requested_expiry",n.requestedExpiry.toString()),n.authorizationDetails&&i.append("authorization_details",JSON.stringify(n.authorizationDetails));try{const s=yield bi(e,i),a=yield Ai(e,s);return Ct.fromTokenEndpointResponse(a)}catch(s){throw new ro(s)}})()}initiateBackchannelAuthentication(n){var t=this;return(0,u.A)(function*(){const{configuration:e,serverMetadata:r}=yield _e(we,t,Je).call(t),o=oo(G(G({},N(le,t).authorizationParams),n?.authorizationParams)),i=new URLSearchParams(G(G({scope:io},o),{},{client_id:N(le,t).clientId,binding_message:n.bindingMessage,login_hint:JSON.stringify({format:"iss_sub",iss:r.issuer,sub:n.loginHint.sub})}));n.requestedExpiry&&i.append("requested_expiry",n.requestedExpiry.toString()),n.authorizationDetails&&i.append("authorization_details",JSON.stringify(n.authorizationDetails));try{const s=yield bi(e,i);return{authReqId:s.auth_req_id,expiresIn:s.expires_in,interval:s.interval}}catch(s){throw new ro(s)}})()}backchannelAuthenticationGrant(n){var t=this;return(0,u.A)(function*(){let{authReqId:e}=n;const{configuration:r}=yield _e(we,t,Je).call(t),o=new URLSearchParams({auth_req_id:e});try{const i=yield zr(r,"urn:openid:params:grant-type:ciba",o);return Ct.fromTokenEndpointResponse(i)}catch(i){throw new ro(i)}})()}getTokenForConnection(n){var t=this;return(0,u.A)(function*(){var e;if(n.refreshToken&&n.accessToken)throw new no("Either a refresh or access token should be specified, but not both.");const r=null!==(e=n.accessToken)&&void 0!==e?e:n.refreshToken;if(!r)throw new no("Either a refresh or access token must be specified.");try{return yield t.exchangeToken({connection:n.connection,subjectToken:r,subjectTokenType:n.accessToken?"urn:ietf:params:oauth:token-type:access_token":"urn:ietf:params:oauth:token-type:refresh_token",loginHint:n.loginHint})}catch(o){throw o instanceof nt?new no(o.message,o.cause):o}})()}exchangeToken(n){var t=this;return(0,u.A)(function*(){return"connection"in n?_e(we,t,Ua).call(t,n):_e(we,t,Ma).call(t,n)})()}getTokenByCode(n,t){var e=this;return(0,u.A)(function*(){const{configuration:r}=yield _e(we,e,Je).call(e);try{const o=yield Si(r,n,{pkceCodeVerifier:t.codeVerifier});return Ct.fromTokenEndpointResponse(o)}catch(o){throw new Aa("There was an error while trying to request a token.",o)}})()}getTokenByRefreshToken(n){var t=this;return(0,u.A)(function*(){const{configuration:e}=yield _e(we,t,Je).call(t);try{const r=yield Ti(e,n.refreshToken);return Ct.fromTokenEndpointResponse(r)}catch(r){throw new Sa("The access token has expired and there was an error while trying to refresh it.",r)}})()}getTokenByClientCredentials(n){var t=this;return(0,u.A)(function*(){const{configuration:e}=yield _e(we,t,Je).call(t);try{const r=new URLSearchParams({audience:n.audience});n.organization&&r.append("organization",n.organization);const o=yield ki(e,r);return Ct.fromTokenEndpointResponse(o)}catch(r){throw new Ea("There was an error while trying to request a token.",r)}})()}buildLogoutUrl(n){var t=this;return(0,u.A)(function*(){const{configuration:e,serverMetadata:r}=yield _e(we,t,Je).call(t);if(!r.end_session_endpoint){const o=new URL("https://".concat(N(le,t).domain,"/v2/logout"));return o.searchParams.set("returnTo",n.returnTo),o.searchParams.set("client_id",N(le,t).clientId),o}return function(o,i){ct(o);const{as:s,c:a,tlsOnly:c}=Pe(o),h=tn(s,"end_session_endpoint",!1,c);(i=new URLSearchParams(i)).has("client_id")||i.set("client_id",a.client_id);for(const[l,m]of i.entries())h.searchParams.append(l,m);return h}(e,{post_logout_redirect_uri:n.returnTo})})()}verifyLogoutToken(n){var t=this;return(0,u.A)(function*(){const{serverMetadata:e}=yield _e(we,t,Je).call(t);N(fn,t)||me(fn,t,function(o,i){const s=new va(o,i),a=function(){var c=(0,u.A)(function*(h,l){return s.getKey(h,l)});return function(l,m){return c.apply(this,arguments)}}();return Object.defineProperties(a,{coolingDown:{get:()=>s.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>s.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>s.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>s.pendingFetch(),enumerable:!0,configurable:!1},jwks:{value:()=>s.jwks(),enumerable:!0,configurable:!1,writable:!1}}),a}(new URL(e.jwks_uri),{[Ci]:N(le,t).customFetch}));const{payload:r}=yield function ya(n,t,e){return Vr.apply(this,arguments)}(n.logoutToken,N(fn,t),{issuer:e.issuer,audience:N(le,t).clientId,algorithms:["RS256"],requiredClaims:["iat"]});if(!("sid"in r)&&!("sub"in r))throw new _t('either "sid" or "sub" (or both) claims must be present');if("sid"in r&&"string"!=typeof r.sid)throw new _t('"sid" claim must be a string');if("sub"in r&&"string"!=typeof r.sub)throw new _t('"sub" claim must be a string');if("nonce"in r)throw new _t('"nonce" claim is prohibited');if(!("events"in r))throw new _t('"events" claim is missing');if("object"!=typeof r.events||null===r.events)throw new _t('"events" claim must be an object');if(!("http://schemas.openid.net/event/backchannel-logout"in r.events))throw new _t('"http://schemas.openid.net/event/backchannel-logout" member is missing in the "events" claim');if("object"!=typeof r.events["http://schemas.openid.net/event/backchannel-logout"])throw new _t('"http://schemas.openid.net/event/backchannel-logout" member in the "events" claim must be an object');return{sid:r.sid,sub:r.sub}})()}});function Je(){return so.apply(this,arguments)}function so(){return so=(0,u.A)(function*(){if(N(gt,this)&&N(Bt,this))return{configuration:N(gt,this),serverMetadata:N(Bt,this)};const n=yield _e(we,this,ja).call(this);return me(gt,this,yield function ua(n,t,e,r,o){return Cr.apply(this,arguments)}(new URL("https://".concat(N(le,this).domain)),N(le,this).clientId,{use_mtls_endpoint_aliases:N(le,this).useMtls},n,{[ft]:N(le,this).customFetch})),me(Bt,this,N(gt,this).serverMetadata()),N(gt,this)[ft]=N(le,this).customFetch||fetch,{configuration:N(gt,this),serverMetadata:N(Bt,this)}}),so.apply(this,arguments)}function Ua(n){return ao.apply(this,arguments)}function ao(){return ao=(0,u.A)(function*(n){var t,e;const{configuration:r}=yield _e(we,this,Je).call(this);if("audience"in n||"resource"in n)throw new nt("audience and resource parameters are not supported for Token Vault exchanges");Li(n.subjectToken);const o=new URLSearchParams({connection:n.connection,subject_token:n.subjectToken,subject_token_type:null!==(t=n.subjectTokenType)&&void 0!==t?t:"urn:ietf:params:oauth:token-type:access_token",requested_token_type:null!==(e=n.requestedTokenType)&&void 0!==e?e:"http://auth0.com/oauth/token-type/federated-connection-access-token"});n.loginHint&&o.append("login_hint",n.loginHint),n.scope&&o.append("scope",n.scope),Ki(o,n.extra);try{const i=yield zr(r,"urn:auth0:params:oauth:grant-type:token-exchange:federated-connection-access-token",o);return Ct.fromTokenEndpointResponse(i)}catch(i){throw new nt("Failed to exchange token for connection '".concat(n.connection,"'."),i)}}),ao.apply(this,arguments)}function Ma(n){return co.apply(this,arguments)}function co(){return co=(0,u.A)(function*(n){const{configuration:t}=yield _e(we,this,Je).call(this);Li(n.subjectToken);const e=new URLSearchParams({subject_token_type:n.subjectTokenType,subject_token:n.subjectToken});n.audience&&e.append("audience",n.audience),n.scope&&e.append("scope",n.scope),n.requestedTokenType&&e.append("requested_token_type",n.requestedTokenType),n.organization&&e.append("organization",n.organization),Ki(e,n.extra);try{const r=yield zr(t,"urn:ietf:params:oauth:grant-type:token-exchange",e);return Ct.fromTokenEndpointResponse(r)}catch(r){throw new nt("Failed to exchange token of type '".concat(n.subjectTokenType,"'").concat(n.audience?" for audience '".concat(n.audience,"'"):"","."),r)}}),co.apply(this,arguments)}function ja(){return uo.apply(this,arguments)}function uo(){return uo=(0,u.A)(function*(){if(!N(le,this).clientSecret&&!N(le,this).clientAssertionSigningKey&&!N(le,this).useMtls)throw new Ia;if(N(le,this).useMtls)return(t,e,r,o)=>{r.set("client_id",e.client_id)};let n=N(le,this).clientAssertionSigningKey;return!n||n instanceof CryptoKey||(n=yield(t=(0,u.A)(function*(e,r,o){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw new TypeError('"pkcs8" must be PKCS#8 formatted string');return oa(e,r,o)}),function(e,r,o){return t.apply(this,arguments)})(n,N(le,this).clientAssertionSigningAlg||"RS256")),n?function(t){return function Rs(n,t){const{key:e,kid:r}=(o=n)instanceof CryptoKey?{key:o}:o?.key instanceof CryptoKey?(void 0!==o.kid&&ve(o.kid,'"kid"'),{key:o.key,kid:o.kid}):{};var o;return function Is(n,t){if(function(e,r){if(!(e instanceof CryptoKey))throw ae("".concat(r," must be a CryptoKey"),"ERR_INVALID_ARG_TYPE")}(n,t),"private"!==n.type)throw ae("".concat(t," must be a private CryptoKey"),"ERR_INVALID_ARG_VALUE")}(e,'"clientPrivateKey.key"'),function(){var i=(0,u.A)(function*(s,a,c,h){var l;const m={alg:Os(e),kid:r},T=function(g,k){const O=Sn()+En(k);return{jti:Fo(),aud:g.issuer,exp:O+60,iat:O,nbf:O,iss:k.client_id,sub:k.client_id}}(s,a);var g;null==t||null===(l=t[Ts])||void 0===l||l.call(t,m,T),c.set("client_id",a.client_id),c.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),c.set("client_assertion",yield(g=(0,u.A)(function*(k,O,E){if(!E.usages.includes("sign"))throw ae('CryptoKey instances used for signing assertions must include "sign" in their "usages"',"ERR_INVALID_ARG_VALUE");const I="".concat(St(zt(JSON.stringify(k))),".").concat(St(zt(JSON.stringify(O)))),U=St(yield crypto.subtle.sign(function(z){switch(z.algorithm.name){case"ECDSA":return{name:z.algorithm.name,hash:Xs(z)};case"RSA-PSS":switch(ti(z),z.algorithm.hash.name){case"SHA-256":case"SHA-384":case"SHA-512":return{name:z.algorithm.name,saltLength:parseInt(z.algorithm.hash.name.slice(-3),10)>>3};default:throw new Le("unsupported RSA-PSS hash name",{cause:z})}case"RSASSA-PKCS1-v1_5":return ti(z),z.algorithm.name;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":case"Ed25519":return z.algorithm.name}throw new Le("unsupported CryptoKey algorithm name",{cause:z})}(E),E,zt(I)));return"".concat(I,".").concat(U)}),function(k,O,E){return g.apply(this,arguments)})(m,T,e))});return function(s,a,c,h){return i.apply(this,arguments)}}()}(t,void 0)}(n):gi(N(le,this).clientSecret);var t}),uo.apply(this,arguments)}function lo(n){return ho.apply(this,arguments)}function ho(){return ho=(0,u.A)(function*(n){const{configuration:t}=yield _e(we,this,Je).call(this),e=function ca(){return Fo()}(),r=yield function aa(n){return(t=(0,u.A)(function*(e){return ve(e,"codeVerifier"),St(yield crypto.subtle.digest("SHA-256",zt(e)))}),function(e){return t.apply(this,arguments)})(n);var t}(e),o=oo(G(G({},N(le,this).authorizationParams),n?.authorizationParams)),i=new URLSearchParams(G(G({scope:io},o),{},{client_id:N(le,this).clientId,code_challenge:r,code_challenge_method:"S256"}));return{authorizationUrl:null!=n&&n.pushedAuthorizationRequests?yield Pi(t,i):yield Wr(t,i),codeVerifier:e}}),ho.apply(this,arguments)}class vt extends x{constructor(t,e){super(t,e),Object.setPrototypeOf(this,vt.prototype)}static fromPayload(t){let{error:e,error_description:r}=t;return new vt(e,r)}}class Wn extends vt{constructor(t,e){super(t,e),Object.setPrototypeOf(this,Wn.prototype)}}class po extends vt{constructor(t,e){super(t,e),Object.setPrototypeOf(this,po.prototype)}}class fo extends vt{constructor(t,e){super(t,e),Object.setPrototypeOf(this,fo.prototype)}}class Vt extends vt{constructor(t,e){super(t,e),Object.setPrototypeOf(this,Vt.prototype)}}class mo extends vt{constructor(t,e){super(t,e),Object.setPrototypeOf(this,mo.prototype)}}class La{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e5;this.contexts=new Map,this.ttlMs=t}set(t,e){this.cleanup(),this.contexts.set(t,Object.assign(Object.assign({},e),{createdAt:Date.now()}))}get(t){const e=this.contexts.get(t);if(e){if(!(Date.now()-e.createdAt>this.ttlMs))return e;this.contexts.delete(t)}}remove(t){this.contexts.delete(t)}cleanup(){const t=Date.now();for(const[e,r]of this.contexts)t-r.createdAt>this.ttlMs&&this.contexts.delete(e)}get size(){return this.contexts.size}}class Ka{constructor(t,e){this.authJsMfaClient=t,this.auth0Client=e,this.contextManager=new La}setMFAAuthDetails(t,e,r,o){this.contextManager.set(t,{scope:e,audience:r,mfaRequirements:o})}getAuthenticators(t){var e=this;return(0,u.A)(function*(){var r,o;const i=e.contextManager.get(t);if(null===(r=i?.mfaRequirements)||void 0===r||!r.challenge||0===i.mfaRequirements.challenge.length)throw new Wn("invalid_request","challengeType is required and must contain at least one challenge type, please check mfa_required error payload");const s=i.mfaRequirements.challenge.map(a=>a.type);try{return(yield e.authJsMfaClient.listAuthenticators({mfaToken:t})).filter(a=>!!a.type&&s.includes(a.type))}catch(a){throw a instanceof Ui?new Wn(null===(o=a.cause)||void 0===o?void 0:o.error,a.message):a}})()}enroll(t){var e=this;return(0,u.A)(function*(){var r;const o=function(i){const s=vs[i.factorType];return Object.assign(Object.assign(Object.assign({mfaToken:i.mfaToken,authenticatorTypes:s.authenticatorTypes},s.oobChannels&&{oobChannels:s.oobChannels}),"phoneNumber"in i&&{phoneNumber:i.phoneNumber}),"email"in i&&{email:i.email})}(t);try{return yield e.authJsMfaClient.enrollAuthenticator(o)}catch(i){throw i instanceof Mi?new po(null===(r=i.cause)||void 0===r?void 0:r.error,i.message):i}})()}challenge(t){var e=this;return(0,u.A)(function*(){var r;try{const o={challengeType:t.challengeType,mfaToken:t.mfaToken};return t.authenticatorId&&(o.authenticatorId=t.authenticatorId),yield e.authJsMfaClient.challengeAuthenticator(o)}catch(o){throw o instanceof ji?new fo(null===(r=o.cause)||void 0===r?void 0:r.error,o.message):o}})()}getEnrollmentFactors(t){var e=this;return(0,u.A)(function*(){const r=e.contextManager.get(t);if(!r||!r.mfaRequirements)throw new mo("mfa_context_not_found","MFA context not found for this MFA token. Please retry the original request to get a new MFA token.");return r.mfaRequirements.enroll&&0!==r.mfaRequirements.enroll.length?r.mfaRequirements.enroll:[]})()}verify(t){var e=this;return(0,u.A)(function*(){const r=e.contextManager.get(t.mfaToken);if(!r)throw new Vt("mfa_context_not_found","MFA context not found for this MFA token. Please retry the original request to get a new MFA token.");const o="otp"in(a=t)&&a.otp?"http://auth0.com/oauth/grant-type/mfa-otp":"oobCode"in a&&a.oobCode?"http://auth0.com/oauth/grant-type/mfa-oob":"recoveryCode"in a&&a.recoveryCode?"http://auth0.com/oauth/grant-type/mfa-recovery-code":void 0;var a;if(!o)throw new Vt("invalid_request","Unable to determine grant type. Provide one of: otp, oobCode, or recoveryCode.");const i=r.scope,s=r.audience;try{const a=yield e.auth0Client._requestTokenForMfa({grant_type:o,mfaToken:t.mfaToken,scope:i,audience:s,otp:t.otp,oob_code:t.oobCode,binding_code:t.bindingCode,recovery_code:t.recoveryCode});return e.contextManager.remove(t.mfaToken),a}catch(a){if(a instanceof wt)e.setMFAAuthDetails(a.mfa_token,i,s,a.mfa_requirements);else if(a instanceof Vt)throw new Vt(a.error,a.error_description);throw a}})()}}const mn=new fe;class Wa{constructor(t){var e=this;let r,o;if(this.userCache=(new To).enclosedCache,this.activeLockKeys=new Set,this.defaultOptions={authorizationParams:{scope:"openid profile email"},useRefreshTokensFallback:!1,useFormData:!0},this._releaseLockOnPageHide=(0,u.A)(function*(){const l=Array.from(e.activeLockKeys);for(const m of l)yield mn.releaseLock(m);e.activeLockKeys.clear(),window.removeEventListener("pagehide",e._releaseLockOnPageHide)}),this.options=Object.assign(Object.assign(Object.assign({},this.defaultOptions),t),{authorizationParams:Object.assign(Object.assign({},this.defaultOptions.authorizationParams),t.authorizationParams)}),typeof window<"u"&&(()=>{if(!Lt())throw new Error("For security reasons, `window.crypto` is required to run `auth0-spa-js`.");if(void 0===Lt().subtle)throw new Error("\n      auth0-spa-js must run on a secure origin. See https://github.com/auth0/auth0-spa-js/blob/main/FAQ.md#why-do-i-get-auth0-spa-js-must-run-on-a-secure-origin for more information.\n    ")})(),t.cache&&t.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),t.cache)o=t.cache;else{if(r=t.cacheLocation||"memory",!Do(r))throw new Error('Invalid cache location "'.concat(r,'"'));o=Do(r)()}this.httpTimeoutMs=t.httpTimeoutInSeconds?1e3*t.httpTimeoutInSeconds:1e4,this.cookieStorage=!1===t.legacySameSiteCookie?Kt:us,this.orgHintCookieName="auth0.".concat(this.options.clientId,".organization_hint"),this.isAuthenticatedCookieName=(()=>"auth0.".concat(this.options.clientId,".is.authenticated"))(),this.sessionCheckExpiryDays=t.sessionCheckExpiryDays||1;const s=t.useCookiesForTransactions?this.cookieStorage:ls;var a,l,m;this.scope=function(l,m){for(var T=arguments.length,g=new Array(T>2?T-2:0),k=2;k<T;k++)g[k-2]=arguments[k];if("object"!=typeof l)return{default:gn(m,l,...g)};let O={default:gn(m,...g)};return Object.keys(l).forEach(E=>{O[E]=gn(m,l[E],...g)}),O}(this.options.authorizationParams.scope,"openid",this.options.useRefreshTokens?"offline_access":""),this.transactionManager=new rs(s,this.options.clientId,this.options.cookieDomain),this.nowProvider=this.options.nowProvider||W,this.cacheManager=new ns(o,o.allKeys?void 0:new ps(o,this.options.clientId),this.nowProvider),this.dpop=this.options.useDpop?new ys(this.options.clientId):void 0,this.domainUrl=/^https?:\/\//.test(a=this.options.domain)?a:"https://".concat(a),this.tokenIssuer=(m=this.domainUrl,(l=this.options.issuer)?l.startsWith("https://")?l:"https://".concat(l,"/"):"".concat(m,"/"));const c="".concat(this.domainUrl,"/me/"),h=this.createFetcher(Object.assign(Object.assign({},this.options.useDpop&&{dpopNonceId:"__auth0_my_account_api__"}),{getAccessToken:()=>this.getTokenSilently({authorizationParams:{scope:"create:me:connected_accounts",audience:c},detailedResponse:!0})}));this.myAccountApi=new _s(h,c),this.authJsClient=new Da({domain:this.options.domain,clientId:this.options.clientId}),this.mfa=new Ka(this.authJsClient.mfa,this),typeof window<"u"&&window.Worker&&this.options.useRefreshTokens&&"memory"===r&&(this.worker=this.options.workerUrl?new Worker(this.options.workerUrl):new hs)}getConfiguration(){return Object.freeze({domain:this.options.domain,clientId:this.options.clientId})}_url(t){const r=y(this.options.auth0Client||q,!0),o=encodeURIComponent(btoa(JSON.stringify(r)));return"".concat(this.domainUrl).concat(t,"&auth0Client=").concat(o)}_authorizeUrl(t){return this._url("/authorize?".concat(_(t)))}_verifyIdToken(t,e,r){var o=this;return(0,u.A)(function*(){const i=yield o.nowProvider();return(n=>{if(!n.id_token)throw new Error("ID token is required but missing");const t=(i=>{const s=i.split("."),[a,c,h]=s;if(3!==s.length||!a||!c||!h)throw new Error("ID token could not be decoded");const l=JSON.parse(A(c)),m={__raw:i},T={};return Object.keys(l).forEach(g=>{m[g]=l[g],os.includes(g)||(T[g]=l[g])}),{encoded:{header:a,payload:c,signature:h},header:JSON.parse(A(a)),claims:m,user:T}})(n.id_token);if(!t.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(t.claims.iss!==n.iss)throw new Error('Issuer (iss) claim mismatch in the ID token; expected "'.concat(n.iss,'", found "').concat(t.claims.iss,'"'));if(!t.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if("RS256"!==t.header.alg)throw new Error('Signature algorithm of "'.concat(t.header.alg,'" is not supported. Expected the ID token to be signed with "RS256".'));if(!t.claims.aud||"string"!=typeof t.claims.aud&&!Array.isArray(t.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(n.aud))throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(n.aud,'" but was not one of "').concat(t.claims.aud.join(", "),'"'));if(t.claims.aud.length>1){if(!t.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(t.claims.azp!==n.aud)throw new Error('Authorized Party (azp) claim mismatch in the ID token; expected "'.concat(n.aud,'", found "').concat(t.claims.azp,'"'))}}else if(t.claims.aud!==n.aud)throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(n.aud,'" but found "').concat(t.claims.aud,'"'));if(n.nonce){if(!t.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(t.claims.nonce!==n.nonce)throw new Error('Nonce (nonce) claim mismatch in the ID token; expected "'.concat(n.nonce,'", found "').concat(t.claims.nonce,'"'))}if(n.max_age&&!$t(t.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(null==t.claims.exp||!$t(t.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!$t(t.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");const e=n.leeway||60,r=new Date(n.now||Date.now()),o=new Date(0);if(o.setUTCSeconds(t.claims.exp+e),r>o)throw new Error("Expiration Time (exp) claim error in the ID token; current time (".concat(r,") is after expiration time (").concat(o,")"));if(null!=t.claims.nbf&&$t(t.claims.nbf)){const i=new Date(0);if(i.setUTCSeconds(t.claims.nbf-e),r<i)throw new Error("Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Current time (".concat(r,") is before ").concat(i))}if(null!=t.claims.auth_time&&$t(t.claims.auth_time)){const i=new Date(0);if(i.setUTCSeconds(parseInt(t.claims.auth_time)+n.max_age+e),r>i)throw new Error("Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Current time (".concat(r,") is after last auth at ").concat(i))}if(n.organization){const i=n.organization.trim();if(i.startsWith("org_")){const s=i;if(!t.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(s!==t.claims.org_id)throw new Error('Organization ID (org_id) claim mismatch in the ID token; expected "'.concat(s,'", found "').concat(t.claims.org_id,'"'))}else{const s=i.toLowerCase();if(!t.claims.org_name)throw new Error("Organization Name (org_name) claim must be a string present in the ID token");if(s!==t.claims.org_name)throw new Error('Organization Name (org_name) claim mismatch in the ID token; expected "'.concat(s,'", found "').concat(t.claims.org_name,'"'))}}return t})({iss:o.tokenIssuer,aud:o.options.clientId,id_token:t,nonce:e,organization:r,leeway:o.options.leeway,max_age:(s=o.options.authorizationParams.max_age,"string"!=typeof s?s:parseInt(s,10)||void 0),now:i});var s})()}_processOrgHint(t){t?this.cookieStorage.save(this.orgHintCookieName,t,{daysUntilExpire:this.sessionCheckExpiryDays,cookieDomain:this.options.cookieDomain}):this.cookieStorage.remove(this.orgHintCookieName,{cookieDomain:this.options.cookieDomain})}_prepareAuthorizeUrl(t,e,r){var o=this;return(0,u.A)(function*(){var i;const s=Yt(bt()),a=Yt(bt()),c=bt(),h=yield b(c),l=M(h),m=yield null===(i=o.dpop)||void 0===i?void 0:i.calculateThumbprint(),T=(k=o.options,O=o.scope,E=t,I=s,U=a,z=l,B=t.redirect_uri||o.options.authorizationParams.redirect_uri||r,L=e?.response_mode,ee=m,Object.assign(Object.assign(Object.assign({client_id:k.clientId},k.authorizationParams),E),{scope:_n(O,E.scope,E.audience),response_type:"code",response_mode:L||"query",state:I,nonce:U,redirect_uri:B||k.authorizationParams.redirect_uri,code_challenge:z,code_challenge_method:"S256",dpop_jkt:ee})),g=o._authorizeUrl(T);var k,O,E,I,U,z,B,L,ee;return{nonce:a,code_verifier:c,scope:T.scope,audience:T.audience||"default",redirect_uri:T.redirect_uri,state:s,url:g}})()}loginWithPopup(t,e){var r=this;return(0,u.A)(function*(){var o;if(t=t||{},!(e=e||{}).popup&&(e.popup=(()=>{const h=window.screenX+(window.innerWidth-400)/2,l=window.screenY+(window.innerHeight-600)/2;return window.open("","auth0:authorize:popup","left=".concat(h,",top=").concat(l,",width=").concat(400,",height=").concat(600,",resizable,scrollbars=yes,status=1"))})(),!e.popup))throw new Zt;const i=yield r._prepareAuthorizeUrl(t.authorizationParams||{},{response_mode:"web_message"},window.location.origin);e.popup.location.href=i.url;const s=yield(c=Object.assign(Object.assign({},e),{timeoutInSeconds:e.timeoutInSeconds||r.options.authorizeTimeoutInSeconds||60}),new Promise((h,l)=>{let m;const T=setInterval(()=>{c.popup&&c.popup.closed&&(clearInterval(T),clearTimeout(g),window.removeEventListener("message",m,!1),l(new Be(c.popup)))},1e3),g=setTimeout(()=>{clearInterval(T),l(new Ue(c.popup)),window.removeEventListener("message",m,!1)},1e3*(c.timeoutInSeconds||60));m=function(k){if(k.data&&"authorization_response"===k.data.type){if(clearTimeout(g),clearInterval(T),window.removeEventListener("message",m,!1),!1!==c.closePopup&&c.popup.close(),k.data.response.error)return l(x.fromPayload(k.data.response));h(k.data.response)}},window.addEventListener("message",m)}));var c;if(i.state!==s.state)throw new x("state_mismatch","Invalid state");const a=(null===(o=t.authorizationParams)||void 0===o?void 0:o.organization)||r.options.authorizationParams.organization;yield r._requestToken({audience:i.audience,scope:i.scope,code_verifier:i.code_verifier,grant_type:"authorization_code",code:s.code,redirect_uri:i.redirect_uri},{nonceIn:i.nonce,organization:a})})()}getUser(){var t=this;return(0,u.A)(function*(){var e;const r=yield t._getIdTokenFromCache();return null===(e=r?.decodedToken)||void 0===e?void 0:e.user})()}getIdTokenClaims(){var t=this;return(0,u.A)(function*(){var e;const r=yield t._getIdTokenFromCache();return null===(e=r?.decodedToken)||void 0===e?void 0:e.claims})()}loginWithRedirect(){var t=arguments,e=this;return(0,u.A)(function*(){var r;const o=Uo(t.length>0&&void 0!==t[0]?t[0]:{}),{openUrl:i,fragment:s,appState:a}=o,c=w(o,["openUrl","fragment","appState"]),h=(null===(r=c.authorizationParams)||void 0===r?void 0:r.organization)||e.options.authorizationParams.organization,l=yield e._prepareAuthorizeUrl(c.authorizationParams||{}),{url:m}=l,T=w(l,["url"]);e.transactionManager.create(Object.assign(Object.assign(Object.assign({},T),{appState:a,response_type:At.Code}),h&&{organization:h}));const g=s?"".concat(m,"#").concat(s):m;i?yield i(g):window.location.assign(g)})()}handleRedirectCallback(){var t=arguments,e=this;return(0,u.A)(function*(){const r=(t.length>0&&void 0!==t[0]?t[0]:window.location.href).split("?").slice(1);if(0===r.length)throw new Error("There are no query params available for parsing.");const o=e.transactionManager.get();if(!o)throw new x("missing_transaction","Invalid state");e.transactionManager.remove();const i=(s=>{s.indexOf("#")>-1&&(s=s.substring(0,s.indexOf("#")));const a=new URLSearchParams(s);return{state:a.get("state"),code:a.get("code")||void 0,connect_code:a.get("connect_code")||void 0,error:a.get("error")||void 0,error_description:a.get("error_description")||void 0}})(r.join(""));return o.response_type===At.ConnectCode?e._handleConnectAccountRedirectCallback(i,o):e._handleLoginRedirectCallback(i,o)})()}_handleLoginRedirectCallback(t,e){var r=this;return(0,u.A)(function*(){const{code:o,state:i,error:s,error_description:a}=t;if(s)throw new X(s,a||s,i,e.appState);if(!e.code_verifier||e.state&&e.state!==i)throw new x("state_mismatch","Invalid state");const c=e.organization,h=e.nonce,l=e.redirect_uri;return yield r._requestToken(Object.assign({audience:e.audience,scope:e.scope,code_verifier:e.code_verifier,grant_type:"authorization_code",code:o},l?{redirect_uri:l}:{}),{nonceIn:h,organization:c}),{appState:e.appState,response_type:At.Code}})()}_handleConnectAccountRedirectCallback(t,e){var r=this;return(0,u.A)(function*(){const{connect_code:o,state:i,error:s,error_description:a}=t;if(s)throw new de(s,a||s,e.connection,i,e.appState);if(!o)throw new x("missing_connect_code","Missing connect code");if(!(e.code_verifier&&e.state&&e.auth_session&&e.redirect_uri&&e.state===i))throw new x("state_mismatch","Invalid state");const c=yield r.myAccountApi.completeAccount({auth_session:e.auth_session,connect_code:o,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier});return Object.assign(Object.assign({},c),{appState:e.appState,response_type:At.ConnectCode})})()}checkSession(t){var e=this;return(0,u.A)(function*(){if(!e.cookieStorage.get(e.isAuthenticatedCookieName)){if(!e.cookieStorage.get("auth0.is.authenticated"))return;e.cookieStorage.save(e.isAuthenticatedCookieName,!0,{daysUntilExpire:e.sessionCheckExpiryDays,cookieDomain:e.options.cookieDomain}),e.cookieStorage.remove("auth0.is.authenticated")}try{yield e.getTokenSilently(t)}catch{}})()}getTokenSilently(){var t=arguments,e=this;return(0,u.A)(function*(){let r=t.length>0&&void 0!==t[0]?t[0]:{};var o,i;const s=Object.assign(Object.assign({cacheMode:"on"},r),{authorizationParams:Object.assign(Object.assign(Object.assign({},e.options.authorizationParams),r.authorizationParams),{scope:_n(e.scope,null===(o=r.authorizationParams)||void 0===o?void 0:o.scope,(null===(i=r.authorizationParams)||void 0===i?void 0:i.audience)||e.options.authorizationParams.audience)})}),a=yield((c,h)=>{let l=Vn[h];return l||(l=e._getTokenSilently(s).finally(()=>{delete Vn[h],l=null}),Vn[h]=l),l})(0,"".concat(e.options.clientId,"::").concat(s.authorizationParams.audience,"::").concat(s.authorizationParams.scope));return r.detailedResponse?a:a?.access_token})()}_getTokenSilently(t){var e=this;return(0,u.A)(function*(){const{cacheMode:r}=t,o=w(t,["cacheMode"]);if("off"!==r){const c=yield e._getEntryFromCache({scope:o.authorizationParams.scope,audience:o.authorizationParams.audience||"default",clientId:e.options.clientId,cacheMode:r});if(c)return c}if("cache-only"===r)return;const i=(s=e.options.clientId,a=o.authorizationParams.audience||"default","".concat("auth0.lock.getTokenSilently",".").concat(s,".").concat(a));var s,a;if(!(yield Co(()=>mn.acquireLock(i,5e3),10)))throw new Te;e.activeLockKeys.add(i),1===e.activeLockKeys.size&&window.addEventListener("pagehide",e._releaseLockOnPageHide);try{if("off"!==r){const k=yield e._getEntryFromCache({scope:o.authorizationParams.scope,audience:o.authorizationParams.audience||"default",clientId:e.options.clientId});if(k)return k}const c=e.options.useRefreshTokens?yield e._getTokenUsingRefreshToken(o):yield e._getTokenFromIFrame(o),{id_token:h,token_type:l,access_token:m,oauthTokenScope:T,expires_in:g}=c;return Object.assign(Object.assign({id_token:h,token_type:l,access_token:m},T?{scope:T}:null),{expires_in:g})}finally{yield mn.releaseLock(i),e.activeLockKeys.delete(i),0===e.activeLockKeys.size&&window.removeEventListener("pagehide",e._releaseLockOnPageHide)}})()}getTokenWithPopup(){var t=arguments,e=this;return(0,u.A)(function*(){let r=t.length>0&&void 0!==t[0]?t[0]:{},o=t.length>1&&void 0!==t[1]?t[1]:{};var i,s;const a=Object.assign(Object.assign({},r),{authorizationParams:Object.assign(Object.assign(Object.assign({},e.options.authorizationParams),r.authorizationParams),{scope:_n(e.scope,null===(i=r.authorizationParams)||void 0===i?void 0:i.scope,(null===(s=r.authorizationParams)||void 0===s?void 0:s.audience)||e.options.authorizationParams.audience)})});return o=Object.assign(Object.assign({},ye),o),yield e.loginWithPopup(a,o),(yield e.cacheManager.get(new ze({scope:a.authorizationParams.scope,audience:a.authorizationParams.audience||"default",clientId:e.options.clientId}),void 0,e.options.useMrrt)).access_token})()}isAuthenticated(){var t=this;return(0,u.A)(function*(){return!!(yield t.getUser())})()}_buildLogoutUrl(t){null!==t.clientId?t.clientId=t.clientId||this.options.clientId:delete t.clientId;const e=t.logoutParams||{},{federated:r}=e,o=w(e,["federated"]),i=r?"&federated":"";return this._url("/v2/logout?".concat(_(Object.assign({clientId:t.clientId},o))))+i}logout(){var t=arguments,e=this;return(0,u.A)(function*(){let r=t.length>0&&void 0!==t[0]?t[0]:{};var o;const i=Uo(r),{openUrl:s}=i,a=w(i,["openUrl"]);null===r.clientId?yield e.cacheManager.clear():yield e.cacheManager.clear(r.clientId||e.options.clientId),e.cookieStorage.remove(e.orgHintCookieName,{cookieDomain:e.options.cookieDomain}),e.cookieStorage.remove(e.isAuthenticatedCookieName,{cookieDomain:e.options.cookieDomain}),e.userCache.remove("@@user@@"),yield null===(o=e.dpop)||void 0===o?void 0:o.clear();const c=e._buildLogoutUrl(a);s?yield s(c):!1!==s&&window.location.assign(c)})()}_getTokenFromIFrame(t){var e=this;return(0,u.A)(function*(){const r=(o=e.options.clientId,"".concat("auth0.lock.getTokenFromIFrame",".").concat(o));var o;if(!(yield Co(()=>mn.acquireLock(r,5e3),10)))throw new Te;try{const i=Object.assign(Object.assign({},t.authorizationParams),{prompt:"none"}),s=e.cookieStorage.get(e.orgHintCookieName);s&&!i.organization&&(i.organization=s);const{url:a,state:c,nonce:h,code_verifier:l,redirect_uri:m,scope:T,audience:g}=yield e._prepareAuthorizeUrl(i,{response_mode:"web_message"},window.location.origin);if(window.crossOriginIsolated)throw new x("login_required","The application is running in a Cross-Origin Isolated context, silently retrieving a token without refresh token is not possible.");const k=t.timeoutInSeconds||e.options.authorizeTimeoutInSeconds;let O;try{O=new URL(e.domainUrl).origin}catch{O=e.domainUrl}const E=yield function(U,z){let B=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60;return new Promise((L,ee)=>{const ie=window.document.createElement("iframe");ie.setAttribute("width","0"),ie.setAttribute("height","0"),ie.style.display="none";const We=()=>{window.document.body.contains(ie)&&(window.document.body.removeChild(ie),window.removeEventListener("message",Se,!1))};let Se;const st=setTimeout(()=>{ee(new Te),We()},1e3*B);Se=function(De){if(De.origin!=z||!De.data||"authorization_response"!==De.data.type)return;const Dt=De.source;Dt&&Dt.close(),De.data.response.error?ee(x.fromPayload(De.data.response)):L(De.data.response),clearTimeout(st),window.removeEventListener("message",Se,!1),setTimeout(We,2e3)},window.addEventListener("message",Se,!1),window.document.body.appendChild(ie),ie.setAttribute("src",U)})}(a,O,k);if(c!==E.state)throw new x("state_mismatch","Invalid state");const I=yield e._requestToken(Object.assign(Object.assign({},t.authorizationParams),{code_verifier:l,code:E.code,grant_type:"authorization_code",redirect_uri:m,timeout:t.authorizationParams.timeout||e.httpTimeoutMs}),{nonceIn:h,organization:i.organization});return Object.assign(Object.assign({},I),{scope:T,oauthTokenScope:I.scope,audience:g})}catch(i){throw"login_required"===i.error&&e.logout({openUrl:!1}),i}finally{yield mn.releaseLock(r)}})()}_getTokenUsingRefreshToken(t){var e=this;return(0,u.A)(function*(){var r,o;const i=yield e.cacheManager.get(new ze({scope:t.authorizationParams.scope,audience:t.authorizationParams.audience||"default",clientId:e.options.clientId}),void 0,e.options.useMrrt);if(!(i&&i.refresh_token||e.worker)){if(e.options.useRefreshTokensFallback)return yield e._getTokenFromIFrame(t);throw new Ut(t.authorizationParams.audience||"default",t.authorizationParams.scope)}const s=t.authorizationParams.redirect_uri||e.options.authorizationParams.redirect_uri||window.location.origin,a="number"==typeof t.timeoutInSeconds?1e3*t.timeoutInSeconds:null,c=((g,k,O,E)=>{var I;if(g&&O&&E){if(k.audience!==O)return k.scope;const U=E.split(" "),z=(null===(I=k.scope)||void 0===I?void 0:I.split(" "))||[],B=z.every(L=>U.includes(L));return U.length>=z.length&&B?E:k.scope}return k.scope})(e.options.useMrrt,t.authorizationParams,i?.audience,i?.scope);try{const g=yield e._requestToken(Object.assign(Object.assign(Object.assign({},t.authorizationParams),{grant_type:"refresh_token",refresh_token:i&&i.refresh_token,redirect_uri:s}),a&&{timeout:a}),{scopesToRequest:c});if(g.refresh_token&&i?.refresh_token&&(yield e.cacheManager.updateEntry(i.refresh_token,g.refresh_token)),e.options.useMrrt&&(h=i?.audience,l=i?.scope,!(h===t.authorizationParams.audience&&Mo(t.authorizationParams.scope,l)||Mo(c,g.scope)))){if(e.options.useRefreshTokensFallback)return yield e._getTokenFromIFrame(t);yield e.cacheManager.remove(e.options.clientId,t.authorizationParams.audience,t.authorizationParams.scope);const k=((O,E)=>{const I=O?.split(" ")||[],U=E?.split(" ")||[];return I.filter(z=>-1==U.indexOf(z)).join(",")})(c,g.scope);throw new Xt(t.authorizationParams.audience||"default",k)}return Object.assign(Object.assign({},g),{scope:t.authorizationParams.scope,oauthTokenScope:g.scope,audience:t.authorizationParams.audience||"default"})}catch(g){if((g.message.indexOf("Missing Refresh Token")>-1||g.message&&g.message.indexOf("invalid refresh token")>-1)&&e.options.useRefreshTokensFallback)return yield e._getTokenFromIFrame(t);throw g instanceof wt&&e.mfa.setMFAAuthDetails(g.mfa_token,null===(r=t.authorizationParams)||void 0===r?void 0:r.scope,null===(o=t.authorizationParams)||void 0===o?void 0:o.audience,g.mfa_requirements),g}var h,l})()}_saveEntryInCache(t){var e=this;return(0,u.A)(function*(){const{id_token:r,decodedToken:o}=t,i=w(t,["id_token","decodedToken"]);e.userCache.set("@@user@@",{id_token:r,decodedToken:o}),yield e.cacheManager.setIdToken(e.options.clientId,t.id_token,t.decodedToken),yield e.cacheManager.set(i)})()}_getIdTokenFromCache(){var t=this;return(0,u.A)(function*(){const e=t.options.authorizationParams.audience||"default",r=t.scope[e],o=yield t.cacheManager.getIdToken(new ze({clientId:t.options.clientId,audience:e,scope:r})),i=t.userCache.get("@@user@@");return o&&o.id_token===i?.id_token?i:(t.userCache.set("@@user@@",o),o)})()}_getEntryFromCache(t){var e=this;return(0,u.A)(function*(){let{scope:r,audience:o,clientId:i,cacheMode:s}=t;const a=yield e.cacheManager.get(new ze({scope:r,audience:o,clientId:i}),60,e.options.useMrrt,s);if(a&&a.access_token){const{token_type:c,access_token:h,oauthTokenScope:l,expires_in:m}=a,T=yield e._getIdTokenFromCache();return T&&Object.assign(Object.assign({id_token:T.id_token,token_type:c||"Bearer",access_token:h},l?{scope:l}:null),{expires_in:m})}})()}_requestToken(t,e){var r=this;return(0,u.A)(function*(){var o,i;const{nonceIn:s,organization:a,scopesToRequest:c}=e||{},h=yield function qi(n,t){return Fn.apply(this,arguments)}(Object.assign(Object.assign({baseUrl:r.domainUrl,client_id:r.options.clientId,auth0Client:r.options.auth0Client,useFormData:r.options.useFormData,timeout:r.httpTimeoutMs,useMrrt:r.options.useMrrt,dpop:r.dpop},t),{scope:c||t.scope}),r.worker),l=yield r._verifyIdToken(h.id_token,s,a);if("authorization_code"===t.grant_type){const m=yield r._getIdTokenFromCache();null!==(i=null===(o=m?.decodedToken)||void 0===o?void 0:o.claims)&&void 0!==i&&i.sub&&m.decodedToken.claims.sub!==l.claims.sub&&(yield r.cacheManager.clear(r.options.clientId),r.userCache.remove("@@user@@"))}return yield r._saveEntryInCache(Object.assign(Object.assign(Object.assign(Object.assign({},h),{decodedToken:l,scope:t.scope,audience:t.audience||"default"}),h.scope?{oauthTokenScope:h.scope}:null),{client_id:r.options.clientId})),r.cookieStorage.save(r.isAuthenticatedCookieName,!0,{daysUntilExpire:r.sessionCheckExpiryDays,cookieDomain:r.options.cookieDomain}),r._processOrgHint(a||l.claims.org_id),Object.assign(Object.assign({},h),{decodedToken:l})})()}exchangeToken(t){var e=this;return(0,u.A)(function*(){return e._requestToken({grant_type:"urn:ietf:params:oauth:grant-type:token-exchange",subject_token:t.subject_token,subject_token_type:t.subject_token_type,scope:_n(e.scope,t.scope,t.audience||e.options.authorizationParams.audience),audience:t.audience||e.options.authorizationParams.audience,organization:t.organization||e.options.authorizationParams.organization})})()}_assertDpop(t){if(!t)throw new Error("`useDpop` option must be enabled before using DPoP.")}getDpopNonce(t){return this._assertDpop(this.dpop),this.dpop.getNonce(t)}setDpopNonce(t,e){return this._assertDpop(this.dpop),this.dpop.setNonce(t,e)}generateDpopProof(t){return this._assertDpop(this.dpop),this.dpop.generateProof(t)}createFetcher(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new gs(t,{isDpopEnabled:()=>!!this.options.useDpop,getAccessToken:e=>{var r;return this.getTokenSilently({authorizationParams:{scope:null===(r=e?.scope)||void 0===r?void 0:r.join(" "),audience:e?.audience},detailedResponse:!0})},getDpopNonce:()=>this.getDpopNonce(t.dpopNonceId),setDpopNonce:e=>this.setDpopNonce(e,t.dpopNonceId),generateDpopProof:e=>this.generateDpopProof(e)})}connectAccountWithRedirect(t){var e=this;return(0,u.A)(function*(){const{openUrl:r,appState:o,connection:i,scopes:s,authorization_params:a,redirectUri:c=e.options.authorizationParams.redirect_uri||window.location.origin}=t;if(!i)throw new Error("connection is required");const h=Yt(bt()),l=bt(),m=yield b(l),T=M(m),{connect_uri:g,connect_params:k,auth_session:O}=yield e.myAccountApi.connectAccount({connection:i,scopes:s,redirect_uri:c,state:h,code_challenge:T,code_challenge_method:"S256",authorization_params:a});e.transactionManager.create({state:h,code_verifier:l,auth_session:O,redirect_uri:c,appState:o,connection:i,response_type:At.ConnectCode});const E=new URL(g);E.searchParams.set("ticket",k.ticket),r?yield r(E.toString()):window.location.assign(E)})()}_requestTokenForMfa(t,e){var r=this;return(0,u.A)(function*(){const{mfaToken:o}=t,i=w(t,["mfaToken"]);return r._requestToken(Object.assign(Object.assign({},i),{mfa_token:o}),e)})()}}function yo(){return yo=(0,u.A)(function*(n){const t=new Wa(n);return yield t.checkSession(),t}),yo.apply(this,arguments)}const Ie={domain:"dev-26sow24tone5na8a.us.auth0.com",clientId:"lT0H33rFRamTUtbbXwPwO7M0SdT8Qq26",redirectUri:"https://opensourcekd.github.io/all-mfe-builds/mfe-USERS_CRUD/",logoutUri:"https://opensourcekd.github.io/all-mfe-builds/mfe-USERS_CRUD/",scope:"openid profile email",audience:void 0,connection:void 0},rt={TOKEN_STORAGE:"sessionStorage",USER_INFO_STORAGE:"sessionStorage"},ot={ACCESS_TOKEN:"auth0_access_token",USER_INFO:"auth0_user_info"};function Gt(n,t){return("localStorage"===t?localStorage:sessionStorage).getItem(n)}function go(n,t,e){("localStorage"===e?localStorage:sessionStorage).setItem(n,t)}function _o(n,t){("localStorage"===t?localStorage:sessionStorage).removeItem(n)}var vo=d(4230);let Wi=(()=>{class n{constructor(){this.eventSubject=new p.Subject,this.events$=this.eventSubject.asObservable(),console.log("[EventBusService] Event bus initialized")}sendEvent(e){this.eventSubject.next(e)}getEvents(){return this.events$}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ni=(()=>{class n{constructor(e,r){this.http=e,this.eventBus=r,this.id="auth of pokemon",this.STANDARD_JWT_CLAIMS=["sub","name","email","email_verified","preferred_username","given_name","family_name","nickname","locale","picture","phone","phone_verified","updated_at","iss","aud","exp","iat","auth_time","nonce","acr","amr","azp","at_hash","c_hash"],this.auth0Client=null,this.userSubject=new p.BehaviorSubject(this.getUserInfoFromStorage()),this.user$=this.userSubject.asObservable(),console.log("[AuthService - USERS_CRUD MFE] Initializing Auth0 authentication service"),console.log("[AuthService - USERS_CRUD MFE] This is the USERS_CRUD version, different from shell"),this.initializationPromise=this.initializeAuth0()}sayHi(){console.log("In sayHI() function of mfe-USERS_CRUD auth service")}initializeAuth0(){var e=this;return(0,u.A)(function*(){try{if(console.log("[AuthService] Starting Auth0 client initialization..."),!Ie||"object"!=typeof Ie)throw new Error("[AuthService] AUTH0_CONFIG is not defined or invalid");if(!Ie.domain||!Ie.clientId)throw new Error("[AuthService] AUTH0_CONFIG is missing required fields (domain, clientId)");e.auth0Client=yield function Na(n){return yo.apply(this,arguments)}({domain:Ie.domain,clientId:Ie.clientId,authorizationParams:{redirect_uri:Ie.redirectUri,scope:Ie.scope,...Ie.audience&&{audience:Ie.audience}},cacheLocation:"memory",useRefreshTokens:!0}),console.log("[AuthService] Auth0 client initialized successfully")}catch(r){throw console.error("[AuthService] Failed to initialize Auth0 client:",r),r}})()}ensureInitialized(){var e=this;return(0,u.A)(function*(){if(yield e.initializationPromise,!e.auth0Client)throw new Error("[AuthService] Auth0 client failed to initialize")})()}login(e,r){var o=this;return(0,u.A)(function*(){e&&console.log(`[AuthService] Logging in: ${e}`);try{let a;if(yield o.ensureInitialized(),!window.location.pathname.includes("auth-callback")&&window.location.search){const h=window.location.search;a={returnTo:h},console.log("[AuthService] Preserving URL parameters through auth flow:",h)}const c={redirect_uri:Ie.redirectUri,scope:Ie.scope,...Ie.audience&&{audience:Ie.audience},...Ie.connection&&{connection:Ie.connection}};r?.invitation&&(c.invitation=r.invitation,console.log("[AuthService] Including invitation parameter:",r.invitation)),r?.organization&&(c.organization=r.organization,console.log("[AuthService] Including organization parameter:",r.organization)),console.log("[AuthService] Starting Auth0 login redirect..."),yield o.auth0Client.loginWithRedirect({authorizationParams:c,...a&&{appState:a}})}catch(i){throw console.error("[AuthService] Login failed:",i),i}})()}handleCallback(){var e=this;return(0,u.A)(function*(){try{console.log("[AuthService] Processing Auth0 callback..."),yield e.ensureInitialized();const r=yield e.auth0Client.handleRedirectCallback();console.log("[AuthService] Callback processed successfully"),r.appState?console.log("[AuthService] Restored appState from auth flow:",JSON.stringify(r.appState)):console.log("[AuthService] No appState restored (user may not have started from invitation link)");const o=yield e.auth0Client.getUser();if(!o)return console.warn("[AuthService] No user info returned from Auth0"),{success:!1};e.logUserClaims(o),e.setUserInfo(o);const i=yield e.auth0Client.getTokenSilently();return e.setToken(i),console.log("[AuthService] Authentication successful"),{success:!0,appState:r.appState}}catch(r){return console.error("[AuthService] Error processing callback:",r),console.error("[AuthService] Error details:",JSON.stringify(r,null,2)),{success:!1}}})()}logUserClaims(e){console.log("=".repeat(80)),console.log("[AuthService] \u{1f50d} AUTH0 ID TOKEN - ALL CLAIMS:"),console.log("=".repeat(80)),this.logStandardClaims(e);const r=this.getCustomClaims(e);this.logClaims("\n\u{1f511} Custom Claims (Auth0):",r,e);const o=this.getAdditionalClaims(e);this.logClaims("\n\u{1f527} Additional Claims:",o,e),console.log("\n\u{1f4e6} Complete User Object (JSON):"),console.log(JSON.stringify(e,null,2)),console.log("=".repeat(80))}logStandardClaims(e){console.log("\n\u{1f4cb} Standard OIDC Claims:"),["sub","name","email","email_verified","preferred_username","given_name","family_name","nickname","locale","picture","phone","phone_verified","updated_at"].forEach(o=>{console.log(`  \u2022 ${"sub"===o?`${o} (Subject/User ID)`:o}:`,e[o])})}logClaims(e,r,o){console.log(e),0!==r.length?r.forEach(i=>{const s=o[i],a="object"==typeof s?JSON.stringify(s,null,2):s;console.log(`  \u2022 ${i}:`,a)}):console.log("  No custom claims found")}getCustomClaims(e){return Object.keys(e).filter(r=>!this.STANDARD_JWT_CLAIMS.includes(r)&&this.isNamespacedClaim(r))}getAdditionalClaims(e){return Object.keys(e).filter(r=>!this.STANDARD_JWT_CLAIMS.includes(r)&&!this.isNamespacedClaim(r))}isNamespacedClaim(e){return e.startsWith("http://")||e.startsWith("https://")}logout(){var e=this;return(0,u.A)(function*(){_o(ot.ACCESS_TOKEN,rt.TOKEN_STORAGE),_o(ot.USER_INFO,rt.USER_INFO_STORAGE),e.userSubject.next(null),e.emitAuthEvent("logout",null),console.log("[AuthService] User logged out, clearing Auth0 session");try{yield e.ensureInitialized(),yield e.auth0Client.logout({logoutParams:{returnTo:Ie.logoutUri}})}catch(r){console.error("[AuthService] Error during Auth0 logout:",r)}})()}getToken(){var e=this;return(0,u.A)(function*(){const r=Gt(ot.ACCESS_TOKEN,rt.TOKEN_STORAGE);if(r)return r;try{yield e.ensureInitialized();const o=yield e.auth0Client.getTokenSilently();return e.setToken(o),o}catch(o){return console.error("[AuthService] Error getting token from Auth0:",o),null}})()}getTokenSync(){return Gt(ot.ACCESS_TOKEN,rt.TOKEN_STORAGE)}setToken(e){go(ot.ACCESS_TOKEN,e,rt.TOKEN_STORAGE),this.emitAuthEvent("token_updated",{token:e})}isAuthenticated(){var e=this;return(0,u.A)(function*(){try{return yield e.ensureInitialized(),yield e.auth0Client.isAuthenticated()}catch(r){return console.error("[AuthService] Error checking authentication status:",r),!!Gt(ot.ACCESS_TOKEN,rt.TOKEN_STORAGE)}})()}isAuthenticatedSync(){return!!Gt(ot.ACCESS_TOKEN,rt.TOKEN_STORAGE)}getUser(){return this.userSubject.value}getUserData(){const e=this.getUser();if(!e)return null;const r=this.extractClaimValue(e,"role","user"),o=this.extractClaimValue(e,["org","organization"],"default");return{id:e.sub,name:e.name||e.email||"User",email:e.email||"",role:r,org:o}}extractClaimValue(e,r,o){const i=Array.isArray(r)?r:[r];for(const a of i){const c=e[a];if(c)return c}const s=this.getCustomClaims(e);for(const a of i){const c=s.find(h=>h.toLowerCase().includes(a.toLowerCase()));if(c&&e[c]){const h=e[c];return Array.isArray(h)?h[0]:h}}return o}getUserInfoFromStorage(){const e=Gt(ot.USER_INFO,rt.USER_INFO_STORAGE);return e?JSON.parse(e):null}setUserInfo(e){go(ot.USER_INFO,JSON.stringify(e),rt.USER_INFO_STORAGE),this.userSubject.next(e),console.log("[AuthService] \u{1f4be} User info stored in sessionStorage:"),console.log("  Standard claims:",{sub:e.sub,name:e.name,email:e.email,email_verified:e.email_verified});const r=this.getCustomClaims(e);r.length>0&&(console.log("  Custom claims stored:"),r.forEach(o=>{console.log(`    \u2022 ${o}:`,e[o])})),this.emitAuthEvent("user_info_updated",e)}emitAuthEvent(e,r){const o={type:`auth:${e}`,payload:r,timestamp:(new Date).toISOString()};this.eventBus.sendEvent(JSON.stringify(o)),console.log("[AuthService] Auth event emitted:",o.type)}static{this.\u0275fac=function(r){return new(r||n)(f.\u0275\u0275inject(vo.HttpClient),f.\u0275\u0275inject(Wi))}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),za=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=f.\u0275\u0275defineComponent({type:n,selectors:[["org-core-services"]],standalone:!0,features:[f.\u0275\u0275StandaloneFeature],decls:2,vars:0,template:function(r,o){1&r&&(f.\u0275\u0275elementStart(0,"p"),f.\u0275\u0275text(1," core-services works! "),f.\u0275\u0275elementEnd())}})}}return n})();var Ce=function(n){return n.SUPER_ADMIN="super-admin",n.ORG_ADMIN="org-admin",n.TEAM_LEAD="team-lead",n.SALES_EXECUTIVE="sales-executive",n}(Ce||{});let Ha=(()=>{class n{constructor(e){this.currentUserSubject=new p.BehaviorSubject(this.getDummyUser()),this.currentUser$=this.currentUserSubject.asObservable(),this.dataService=e}getCurrentUser(){return this.currentUserSubject.value}setCurrentUser(e){this.currentUserSubject.next(e)}hasRole(e){return this.getCurrentUser()?.role===e}hasAnyRole(e){const r=this.getCurrentUser();return!!r&&e.includes(r.role)}isAdmin(){return this.hasAnyRole([Ce.SUPER_ADMIN,Ce.ORG_ADMIN])}isTeamLeadOrHigher(){return this.hasAnyRole([Ce.SUPER_ADMIN,Ce.ORG_ADMIN,Ce.TEAM_LEAD])}getAllUsers(){return[{id:"user-1",name:"John Admin",email:"john.admin@company.com",role:Ce.SUPER_ADMIN},{id:"user-2",name:"Sarah Manager",email:"sarah.manager@company.com",role:Ce.ORG_ADMIN},{id:"user-3",name:"Mike Lead",email:"mike.lead@company.com",role:Ce.TEAM_LEAD,teamId:"team-1"},{id:"user-4",name:"Alice Sales",email:"alice.sales@company.com",role:Ce.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"},{id:"user-5",name:"Bob Sales",email:"bob.sales@company.com",role:Ce.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"},{id:"user-6",name:"Carol Sales",email:"carol.sales@company.com",role:Ce.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"}]}getViewableUsers(){const e=this.getCurrentUser();if(!e)return[];const r=this.getAllUsers();return this.isTeamLeadOrHigher()?r.filter(o=>o.role===Ce.SALES_EXECUTIVE||o.id===e.id):r.filter(o=>o.id===e.id)}getDummyUser(){return{id:"user-4",name:"Alice Sales",email:"alice.sales@company.com",role:Ce.SALES_EXECUTIVE,teamId:"team-1",managerId:"user-3"}}static{this.\u0275fac=function(r){return new(r||n)(f.\u0275\u0275inject("DataService",8))}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var wo=d(3103),Fe=function(n){return n.COMPLETED="completed",n.PENDING="pending",n.CANCELLED="cancelled",n}(Fe||{}),it=function(n){return n.ELECTRONICS="Electronics",n.SOFTWARE="Software",n.SERVICES="Services",n.HARDWARE="Hardware",n}(it||{});let Ja=(()=>{class n{constructor(e){this.dummySalesData=this.generateDummyData(),this.dataService=e}getSalesHistory(e,r,o){if(this.dataService)return this.dataService.getSalesHistory(e,r,o);let i=this.dummySalesData.filter(s=>s.salesExecutiveId===e);return r&&(i=i.filter(s=>s.date>=r)),o&&(i=i.filter(s=>s.date<=o)),(0,p.of)(i).pipe((0,wo.c)(300))}getSalesSummary(e){if(this.dataService)return this.dataService.getSalesSummary(e);const r=this.dummySalesData.filter(i=>i.salesExecutiveId===e),o={totalSales:r.filter(i=>i.status===Fe.COMPLETED).reduce((i,s)=>i+s.amount,0),totalCommission:r.filter(i=>i.status===Fe.COMPLETED).reduce((i,s)=>i+s.commission,0),completedCount:r.filter(i=>i.status===Fe.COMPLETED).length,pendingCount:r.filter(i=>i.status===Fe.PENDING).length,cancelledCount:r.filter(i=>i.status===Fe.CANCELLED).length};return(0,p.of)(o).pipe((0,wo.c)(300))}getAllSales(){return this.dataService?this.dataService.getAllSales():(0,p.of)(this.dummySalesData).pipe((0,wo.c)(300))}generateDummyData(){const e=[{name:"Enterprise Software License",category:it.SOFTWARE,basePrice:5e4},{name:"Cloud Storage Solution",category:it.SERVICES,basePrice:25e3},{name:"Server Hardware",category:it.HARDWARE,basePrice:35e3},{name:"IoT Device Package",category:it.ELECTRONICS,basePrice:15e3},{name:"Consulting Services",category:it.SERVICES,basePrice:2e4},{name:"Mobile App Development",category:it.SOFTWARE,basePrice:45e3},{name:"Security Suite",category:it.SOFTWARE,basePrice:3e4},{name:"Network Infrastructure",category:it.HARDWARE,basePrice:6e4}],r=["Acme Corporation","Tech Innovations Inc","Global Solutions Ltd","Digital Dynamics","Future Systems","Smart Technologies","Enterprise Solutions","Cloud Masters"],o=["North","South","East","West","Central"],i=[{id:"user-4",name:"Alice Sales"},{id:"user-5",name:"Bob Sales"},{id:"user-6",name:"Carol Sales"}],s=[Fe.COMPLETED,Fe.COMPLETED,Fe.COMPLETED,Fe.PENDING,Fe.CANCELLED],a=[];let c=1;for(let h=0;h<50;h++){const l=i[h%i.length],m=e[Math.floor(Math.random()*e.length)],T=r[Math.floor(Math.random()*r.length)],g=o[Math.floor(Math.random()*o.length)],k=s[Math.floor(Math.random()*s.length)],O=m.basePrice+(1e4*Math.random()-5e3),E=.05*O,I=new Date;I.setDate(I.getDate()-Math.floor(180*Math.random())),a.push({id:"sale-"+c++,salesExecutiveId:l.id,salesExecutiveName:l.name,productName:m.name,productCategory:m.category,amount:Math.round(O),commission:Math.round(E),status:k,date:I,clientName:T,region:g})}return a.sort((h,l)=>l.date.getTime()-h.date.getTime())}static{this.\u0275fac=function(r){return new(r||n)(f.\u0275\u0275inject("DataService",8))}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var zi=function(n){return n.SUPER_ADMIN="super-admin",n.ORG_ADMIN="org-admin",n.TEAM_LEAD="team-lead",n.MEMBER="member",n}(zi||{}),Me=d(6354),ce=d(9437);const bo={useRealAuth0:!1,domain:"dev-26sow24tone5na8a.us.auth0.com",clientId:"lT0H33rFRamTUtbbXwPwO7M0SdT8Qq26",redirectUri:"https://opensourcekd.github.io/all-mfe-builds/mfe-USERS_CRUD/",scope:"openid profile email",audience:void 0,managementApiAudience:void 0};let yn=(()=>{class n{get domain(){return bo.domain}get managementApiUrl(){return`https://${this.domain}/api/v2`}constructor(e,r){this.http=e,this.authService=r}getHeaders(){const e=this.authService.getTokenSync();return new vo.HttpHeaders({"Content-Type":"application/json",Authorization:e?`Bearer ${e}`:""})}getCurrentUser(){return this.http.get(`https://${this.domain}/userinfo`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}getUserInfo(){return this.http.get(`https://${this.domain}/userinfo`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}listUsers(e){const r=new URLSearchParams(e||{}).toString();return this.http.get(r?`${this.managementApiUrl}/users?${r}`:`${this.managementApiUrl}/users`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}getUserById(e){return this.http.get(`${this.managementApiUrl}/users/${e}`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}createUser(e){return this.http.post(`${this.managementApiUrl}/users`,e,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}updateUser(e,r){return this.http.patch(`${this.managementApiUrl}/users/${e}`,r,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}deleteUser(e){return this.http.delete(`${this.managementApiUrl}/users/${e}`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}blockUser(e,r=!0){return this.http.patch(`${this.managementApiUrl}/users/${e}`,{blocked:r},{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}listOrganizations(e){const r=new URLSearchParams(e||{}).toString();return this.http.get(r?`${this.managementApiUrl}/organizations?${r}`:`${this.managementApiUrl}/organizations`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}getOrganizationById(e){return this.http.get(`${this.managementApiUrl}/organizations/${e}`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}createOrganization(e){return this.http.post(`${this.managementApiUrl}/organizations`,e,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}updateOrganization(e,r){return this.http.patch(`${this.managementApiUrl}/organizations/${e}`,r,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}listRoles(e){const r=new URLSearchParams(e||{}).toString();return this.http.get(r?`${this.managementApiUrl}/roles?${r}`:`${this.managementApiUrl}/roles`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}getRoleById(e){return this.http.get(`${this.managementApiUrl}/roles/${e}`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}createRole(e){return this.http.post(`${this.managementApiUrl}/roles`,e,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}updateRole(e,r){return this.http.patch(`${this.managementApiUrl}/roles/${e}`,r,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}listUserRoles(e){return this.http.get(`${this.managementApiUrl}/users/${e}/roles`,{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}assignRolesToUser(e,r){return this.http.post(`${this.managementApiUrl}/users/${e}/roles`,{roles:r},{headers:this.getHeaders()}).pipe((0,ce.W)(this.handleError))}handleError(e){return console.error("Auth0 API Error:",e),(0,p.throwError)(()=>e)}static{this.\u0275fac=function(r){return new(r||n)(f.\u0275\u0275inject(vo.HttpClient),f.\u0275\u0275inject(Ni))}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Fa=(()=>{class n{constructor(e){this.auth0Api=e,this.organizationsCache=[],this.organizationsSubject=new p.BehaviorSubject([]),this.organizations$=this.organizationsSubject.asObservable(),this.loadOrganizations()}loadOrganizations(){this.auth0Api.listOrganizations().pipe((0,Me.T)(e=>this.mapAuth0OrgsToOrganizations(e)),(0,ce.W)(e=>(console.error("Error loading organizations from Auth0:",e),(0,p.of)([])))).subscribe(e=>{e&&e.length>0&&(this.organizationsCache=e,this.organizationsSubject.next(this.organizationsCache))})}mapAuth0OrgsToOrganizations(e){return e&&Array.isArray(e)?e.map(r=>({id:r.id,name:r.name,description:r.display_name||r.name,createdAt:r.created_at?new Date(r.created_at):new Date,updatedAt:r.updated_at?new Date(r.updated_at):new Date,isActive:!0,settings:{timezone:"UTC",currency:"USD",locale:"en-US"}})):[]}getAll(){return this.auth0Api.listOrganizations().pipe((0,Me.T)(e=>this.mapAuth0OrgsToOrganizations(e)),(0,ce.W)(e=>(console.error("Error getting organizations:",e),(0,p.of)(this.organizationsCache))))}getById(e){return this.getAll().pipe((0,Me.T)(r=>r.find(o=>o.id===e)))}create(e){return this.auth0Api.createOrganization({name:e.name,display_name:e.description}).pipe((0,Me.T)(o=>{const i={id:o.id,name:o.name,description:o.display_name||o.name,createdAt:new Date(o.created_at),updatedAt:new Date(o.updated_at||o.created_at),isActive:!0,settings:e.settings||{timezone:"UTC",currency:"USD",locale:"en-US"}};return this.organizationsCache.push(i),this.organizationsSubject.next(this.organizationsCache),i}),(0,ce.W)(o=>{console.error("Creating organizations in Auth0 requires admin privileges:",o);const i={...e,id:`org-${Date.now()}`,createdAt:new Date,updatedAt:new Date};return(0,p.of)(i)}))}update(e,r){const o={};return r.name&&(o.name=r.name),r.description&&(o.display_name=r.description),this.auth0Api.updateOrganization(e,o).pipe((0,Me.T)(i=>{const s=this.organizationsCache.findIndex(a=>a.id===e);return-1!==s?(this.organizationsCache[s]={...this.organizationsCache[s],...r,updatedAt:new Date},this.organizationsSubject.next(this.organizationsCache),this.organizationsCache[s]):null}),(0,ce.W)(i=>{console.warn("Updating organizations in Auth0 requires specific permissions:",i);const s=this.organizationsCache.findIndex(a=>a.id===e);return-1!==s?(this.organizationsCache[s]={...this.organizationsCache[s],...r,updatedAt:new Date},this.organizationsSubject.next(this.organizationsCache),(0,p.of)(this.organizationsCache[s])):(0,p.of)(null)}))}delete(e){return console.warn("Deleting organizations should be done with caution and may not be supported via Auth0 API"),(0,p.of)(!1)}static{this.\u0275fac=function(r){return new(r||n)(f.\u0275\u0275inject(yn))}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ba=(()=>{class n{constructor(e){this.auth0Api=e,this.teamsCache=[],this.teamsSubject=new p.BehaviorSubject([]),this.teams$=this.teamsSubject.asObservable(),this.loadTeams()}loadTeams(){this.teamsCache=this.getDummyTeams(),this.teamsSubject.next(this.teamsCache)}getDummyTeams(){return[{id:"team1",name:"Engineering",description:"Engineering team",organizationId:"org1",leadId:"1",createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),isActive:!0},{id:"team2",name:"Product",description:"Product team",organizationId:"org1",leadId:"2",createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),isActive:!0},{id:"team3",name:"Design",description:"Design team",organizationId:"org2",leadId:"3",createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),isActive:!0}]}getAll(){return(0,p.of)(this.teamsCache)}getByOrganization(e){return this.getAll().pipe((0,Me.T)(r=>r.filter(o=>o.organizationId===e)))}getById(e){const r=this.teamsCache.find(o=>o.id===e);return(0,p.of)(r)}create(e){const r={id:`team-${Date.now()}`,name:e.name,description:e.description,organizationId:e.organizationId,leadId:e.leadId,createdAt:new Date,updatedAt:new Date,isActive:!0};return this.teamsCache.push(r),this.teamsSubject.next(this.teamsCache),(0,p.of)(r)}update(e,r){const o=this.teamsCache.findIndex(i=>i.id===e);return-1!==o?(this.teamsCache[o]={...this.teamsCache[o],...r,updatedAt:new Date},this.teamsSubject.next(this.teamsCache),(0,p.of)(this.teamsCache[o])):(0,p.of)(null)}delete(e){const r=this.teamsCache.findIndex(o=>o.id===e);return-1!==r?(this.teamsCache[r].isActive=!1,this.teamsCache[r].updatedAt=new Date,this.teamsSubject.next(this.teamsCache),(0,p.of)(!0)):(0,p.of)(!1)}static{this.\u0275fac=function(r){return new(r||n)(f.\u0275\u0275inject(yn))}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Va=(()=>{class n{constructor(e){this.auth0Api=e,this.usersCache=[],this.usersSubject=new p.BehaviorSubject([]),this.users$=this.usersSubject.asObservable(),this.currentAuth0User=null,this.loadUsers()}loadUsers(){if(!bo.useRealAuth0)return this.usersCache=this.getDummyUsers(),void this.usersSubject.next(this.usersCache);(0,p.forkJoin)({authUser:this.auth0Api.getCurrentUser().pipe((0,ce.W)(()=>(0,p.of)(null))),userInfo:this.auth0Api.getUserInfo().pipe((0,ce.W)(()=>(0,p.of)(null)))}).subscribe(({authUser:e,userInfo:r})=>{const o=this.getDummyUsers();if(e||r){const i=this.mapAuth0UserToUser(e||r);this.currentAuth0User=i,this.usersCache=[i,...o.slice(1)]}else console.log("Could not fetch real user from Auth0 API, using dummy data"),this.usersCache=o;this.usersSubject.next(this.usersCache)})}getDummyUsers(){return[{id:"1",name:"John Doe",email:"john.doe@example.com",organizationId:"org1",teamId:"team1",roleId:"super-admin",isActive:!0,createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15")},{id:"2",name:"Jane Smith",email:"jane.smith@example.com",organizationId:"org1",teamId:"team2",roleId:"org-admin",isActive:!0,createdAt:new Date("2024-02-10"),updatedAt:new Date("2024-02-10")},{id:"3",name:"Bob Johnson",email:"bob.johnson@example.com",organizationId:"org2",teamId:"team3",roleId:"team-lead",isActive:!0,createdAt:new Date("2024-03-05"),updatedAt:new Date("2024-03-05")},{id:"4",name:"Alice Brown",email:"alice.brown@example.com",organizationId:"org1",teamId:"team1",roleId:"member",isActive:!1,createdAt:new Date("2024-01-20"),updatedAt:new Date("2024-05-10")}]}mapAuth0UserToUser(e){return e?{id:e.user_id||e.sub||"1",name:this.extractUserName(e),email:e.email||"user@example.com",organizationId:e.org_id||"default-org",teamId:"default-team",roleId:"member",isActive:!e.blocked,createdAt:e.created_at?new Date(e.created_at):new Date,updatedAt:e.updated_at?new Date(e.updated_at):new Date,auth0UserId:e.user_id||e.sub}:this.getDummyUsers()[0]}extractUserName(e){return e.name?e.name:e.nickname?e.nickname:`${e.given_name||""} ${e.family_name||""}`.trim()||(e.email?e.email.split("@")[0]:`User ${e.user_id||e.sub}`)}mapAuth0UsersToUsers(e){return e&&Array.isArray(e)?e.map(r=>({id:r.user_id,name:this.extractUserName(r),email:r.email||"",organizationId:r.org_id||"default-org",teamId:"default-team",roleId:"default-role",isActive:!r.blocked,createdAt:r.created_at?new Date(r.created_at):new Date,updatedAt:r.updated_at?new Date(r.updated_at):new Date,auth0UserId:r.user_id})):[]}mapUserToAuth0Format(e){return{email:e.email,name:e.name,nickname:e.name,blocked:!e.isActive,connection:"Username-Password-Authentication",email_verified:!1,user_metadata:{organizationId:e.organizationId,teamId:e.teamId,roleId:e.roleId}}}getAll(){return(0,p.of)(this.usersCache)}getCurrentAuth0User(){return this.currentAuth0User}getByOrganization(e){return this.getAll().pipe((0,Me.T)(r=>r.filter(o=>o.organizationId===e)))}getByTeam(e){return this.getAll().pipe((0,Me.T)(r=>r.filter(o=>o.teamId===e)))}getById(e){const r=this.usersCache.find(o=>o.id===e);return r?(0,p.of)(r):this.auth0Api.getUserById(e).pipe((0,Me.T)(o=>{const i=this.mapAuth0UsersToUsers([o]);return i.length>0?i[0]:void 0}),(0,ce.W)(o=>(console.error("Error getting user by ID (Management API not available):",o),(0,p.of)(void 0))))}create(e){const r=this.mapUserToAuth0Format(e);return this.auth0Api.createUser(r).pipe((0,Me.T)(o=>{const i={id:o.user_id||`user-${Date.now()}`,name:e.name,email:e.email,organizationId:e.organizationId,teamId:e.teamId,roleId:e.roleId,isActive:e.isActive,createdAt:new Date,updatedAt:new Date,auth0UserId:o.user_id};return this.usersCache.push(i),this.usersSubject.next(this.usersCache),i}),(0,ce.W)(o=>{console.error("Error creating user (Management API not available):",o);const i={id:`local-${Date.now()}`,name:e.name,email:e.email,organizationId:e.organizationId,teamId:e.teamId,roleId:e.roleId,isActive:e.isActive,createdAt:new Date,updatedAt:new Date};return this.usersCache.push(i),this.usersSubject.next(this.usersCache),(0,p.of)(i)}))}update(e,r){const o=this.mapUserToAuth0Format(r);return this.auth0Api.updateUser(e,o).pipe((0,Me.T)(i=>{const s=this.usersCache.findIndex(a=>a.id===e);return-1!==s?(this.usersCache[s]={...this.usersCache[s],...r,updatedAt:new Date},this.usersSubject.next(this.usersCache),this.usersCache[s]):null}),(0,ce.W)(i=>{console.error("Error updating user (Management API not available):",i);const s=this.usersCache.findIndex(a=>a.id===e);return-1!==s?(this.usersCache[s]={...this.usersCache[s],...r,updatedAt:new Date},this.usersSubject.next(this.usersCache),(0,p.of)(this.usersCache[s])):(0,p.of)(null)}))}delete(e){return this.auth0Api.blockUser(e,!0).pipe((0,Me.T)(()=>{const r=this.usersCache.findIndex(o=>o.id===e);return-1!==r&&(this.usersCache[r].isActive=!1,this.usersCache[r].updatedAt=new Date,this.usersSubject.next(this.usersCache),!0)}),(0,ce.W)(r=>{console.error("Error deleting user (Management API not available):",r);const o=this.usersCache.findIndex(i=>i.id===e);return-1!==o&&(this.usersCache[o].isActive=!1,this.usersCache[o].updatedAt=new Date,this.usersSubject.next(this.usersCache)),(0,p.of)(!0)}))}static{this.\u0275fac=function(r){return new(r||n)(f.\u0275\u0275inject(yn))}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ga=(()=>{class n{constructor(e){this.auth0Api=e,this.systemRoles=[{id:"role-1",name:"Super Admin",description:"Full system access",permissions:["*"],isSystemRole:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"role-2",name:"Organization Admin",description:"Full access within organization",permissions:["org:*","team:*","user:*"],isSystemRole:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"role-3",name:"Team Lead",description:"Manage team and team members",permissions:["team:read","team:update","user:read","user:update"],isSystemRole:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")},{id:"role-4",name:"Member",description:"Basic member access",permissions:["user:read"],isSystemRole:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01")}],this.rolesCache=[...this.systemRoles],this.rolesSubject=new p.BehaviorSubject(this.rolesCache),this.roles$=this.rolesSubject.asObservable(),this.loadCustomRoles()}loadCustomRoles(){this.auth0Api.listRoles().pipe((0,Me.T)(e=>this.mapAuth0RolesToRoles(e)),(0,ce.W)(e=>(console.error("Error loading custom roles from Auth0:",e),(0,p.of)([])))).subscribe(e=>{this.rolesCache=[...this.systemRoles,...e],this.rolesSubject.next(this.rolesCache)})}mapAuth0RolesToRoles(e){return e&&Array.isArray(e)?e.map(r=>({id:r.id,name:r.name,description:r.description||"",permissions:[],isSystemRole:!1,createdAt:new Date,updatedAt:new Date})):[]}getAll(){return(0,p.of)(this.rolesCache)}getById(e){const r=this.rolesCache.find(o=>o.id===e);return(0,p.of)(r)}getSystemRoles(){const e=this.rolesCache.filter(r=>r.isSystemRole);return(0,p.of)(e)}getCustomRoles(){const e=this.rolesCache.filter(r=>!r.isSystemRole);return(0,p.of)(e)}create(e){return this.auth0Api.createRole({name:e.name,description:e.description}).pipe((0,Me.T)(o=>{const i={id:o.id,name:o.name,description:o.description||"",permissions:e.permissions,isSystemRole:!1,createdAt:new Date,updatedAt:new Date};return this.rolesCache.push(i),this.rolesSubject.next(this.rolesCache),i}),(0,ce.W)(o=>{console.error("Error creating role in Auth0:",o);const i={...e,id:`role-${Date.now()}`,createdAt:new Date,updatedAt:new Date};return this.rolesCache.push(i),this.rolesSubject.next(this.rolesCache),(0,p.of)(i)}))}update(e,r){const o=this.rolesCache.findIndex(i=>i.id===e);return-1===o||this.rolesCache[o].isSystemRole?(0,p.of)(null):(this.rolesCache[o]={...this.rolesCache[o],...r,updatedAt:new Date},this.rolesSubject.next(this.rolesCache),(0,p.of)(this.rolesCache[o]))}delete(e){const r=this.rolesCache.findIndex(o=>o.id===e);return-1===r||this.rolesCache[r].isSystemRole?(0,p.of)(!1):(this.rolesCache.splice(r,1),this.rolesSubject.next(this.rolesCache),(0,p.of)(!0))}static{this.\u0275fac=function(r){return new(r||n)(f.\u0275\u0275inject(yn))}}static{this.\u0275prov=f.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})()},1985:(F,P,d)=>{d.d(P,{c:()=>R});var f=d(7707),v=d(3961),u=d(3494),p=d(1203),w=d(1026),D=d(8071),C=d(9786);let R=(()=>{class V{constructor(Y){Y&&(this._subscribe=Y)}lift(Y){const se=new V;return se.source=this,se.operator=Y,se}subscribe(Y,se,pe){const ue=function J(V){return V&&V instanceof f.vU||function K(V){return V&&(0,D.T)(V.next)&&(0,D.T)(V.error)&&(0,D.T)(V.complete)}(V)&&(0,v.Uv)(V)}(Y)?Y:new f.Ms(Y,se,pe);return(0,C.Y)(()=>{const{operator:fe,source:ye}=this;ue.add(fe?fe.call(ue,ye):ye?this._subscribe(ue):this._trySubscribe(ue))}),ue}_trySubscribe(Y){try{return this._subscribe(Y)}catch(se){Y.error(se)}}forEach(Y,se){return new(se=S(se))((pe,ue)=>{const fe=new f.Ms({next:ye=>{try{Y(ye)}catch(q){ue(q),fe.unsubscribe()}},error:ue,complete:pe});this.subscribe(fe)})}_subscribe(Y){var se;return null===(se=this.source)||void 0===se?void 0:se.subscribe(Y)}[u.s](){return this}pipe(...Y){return(0,p.m)(Y)(this)}toPromise(Y){return new(Y=S(Y))((se,pe)=>{let ue;this.subscribe(fe=>ue=fe,fe=>pe(fe),()=>se(ue))})}}return V.create=te=>new V(te),V})();function S(V){var te;return null!==(te=V??w.$.Promise)&&void 0!==te?te:Promise}},8399:(F,P,d)=>{d.d(P,{_:()=>v});var f=d(6129);class v{constructor(p,w=v.now){this.schedulerActionCtor=p,this.now=w}schedule(p,w=0,D){return new this.schedulerActionCtor(this,p).schedule(D,w)}}v.now=f.U.now},7707:(F,P,d)=>{d.d(P,{Ms:()=>pe,vU:()=>V});var f=d(8071),v=d(3961),u=d(1026),p=d(5334),w=d(5343);const D=S("C",void 0,void 0);function S(W,x,X){return{kind:W,value:x,error:X}}var K=d(9270),J=d(9786);class V extends v.yU{constructor(x){super(),this.isStopped=!1,x?(this.destination=x,(0,v.Uv)(x)&&x.add(this)):this.destination=q}static create(x,X,de){return new pe(x,X,de)}next(x){this.isStopped?ye(function R(W){return S("N",W,void 0)}(x),this):this._next(x)}error(x){this.isStopped?ye(function C(W){return S("E",void 0,W)}(x),this):(this.isStopped=!0,this._error(x))}complete(){this.isStopped?ye(D,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(x){this.destination.next(x)}_error(x){try{this.destination.error(x)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const te=Function.prototype.bind;function Y(W,x){return te.call(W,x)}class se{constructor(x){this.partialObserver=x}next(x){const{partialObserver:X}=this;if(X.next)try{X.next(x)}catch(de){ue(de)}}error(x){const{partialObserver:X}=this;if(X.error)try{X.error(x)}catch(de){ue(de)}else ue(x)}complete(){const{partialObserver:x}=this;if(x.complete)try{x.complete()}catch(X){ue(X)}}}class pe extends V{constructor(x,X,de){let Te;if(super(),(0,f.T)(x)||!x)Te={next:x??void 0,error:X??void 0,complete:de??void 0};else{let Ue;this&&u.$.useDeprecatedNextContext?(Ue=Object.create(x),Ue.unsubscribe=()=>this.unsubscribe(),Te={next:x.next&&Y(x.next,Ue),error:x.error&&Y(x.error,Ue),complete:x.complete&&Y(x.complete,Ue)}):Te=x}this.destination=new se(Te)}}function ue(W){u.$.useDeprecatedSynchronousErrorHandling?(0,J.l)(W):(0,p.m)(W)}function ye(W,x){const{onStoppedNotification:X}=u.$;X&&K.f.setTimeout(()=>X(W,x))}const q={closed:!0,next:w.l,error:function fe(W){throw W},complete:w.l}},3961:(F,P,d)=>{d.d(P,{Kn:()=>w,Uv:()=>D,yU:()=>p});var f=d(8071),v=d(4079),u=d(7908);class p{constructor(S){this.initialTeardown=S,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let S;if(!this.closed){this.closed=!0;const{_parentage:K}=this;if(K)if(this._parentage=null,Array.isArray(K))for(const te of K)te.remove(this);else K.remove(this);const{initialTeardown:J}=this;if((0,f.T)(J))try{J()}catch(te){S=te instanceof v.Z?te.errors:[te]}const{_finalizers:V}=this;if(V){this._finalizers=null;for(const te of V)try{C(te)}catch(Y){S=S??[],Y instanceof v.Z?S=[...S,...Y.errors]:S.push(Y)}}if(S)throw new v.Z(S)}}add(S){var K;if(S&&S!==this)if(this.closed)C(S);else{if(S instanceof p){if(S.closed||S._hasParent(this))return;S._addParent(this)}(this._finalizers=null!==(K=this._finalizers)&&void 0!==K?K:[]).push(S)}}_hasParent(S){const{_parentage:K}=this;return K===S||Array.isArray(K)&&K.includes(S)}_addParent(S){const{_parentage:K}=this;this._parentage=Array.isArray(K)?(K.push(S),K):K?[K,S]:S}_removeParent(S){const{_parentage:K}=this;K===S?this._parentage=null:Array.isArray(K)&&(0,u.o)(K,S)}remove(S){const{_finalizers:K}=this;K&&(0,u.o)(K,S),S instanceof p&&S._removeParent(this)}}p.EMPTY=(()=>{const R=new p;return R.closed=!0,R})();const w=p.EMPTY;function D(R){return R instanceof p||R&&"closed"in R&&(0,f.T)(R.remove)&&(0,f.T)(R.add)&&(0,f.T)(R.unsubscribe)}function C(R){(0,f.T)(R)?R():R.unsubscribe()}},1026:(F,P,d)=>{d.d(P,{$:()=>f});const f={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2688:(F,P,d)=>{d.d(P,{x:()=>p});var f=d(9131),v=d(9326),u=d(9724);function p(...w){return(0,f.K)()((0,u.H)(w,(0,v.lI)(w)))}},983:(F,P,d)=>{d.d(P,{I:()=>u,w:()=>v});var f=d(1985);const v=new f.c(w=>w.complete());function u(w){return w?function p(w){return new f.c(D=>w.schedule(()=>D.complete()))}(w):v}},9724:(F,P,d)=>{d.d(P,{H:()=>u});var f=d(5894),v=d(8750);function u(p,w){return w?(0,f.c)(p,w):(0,v.Tg)(p)}},8750:(F,P,d)=>{d.d(P,{Tg:()=>te});var f=d(1635),v=d(7441),u=d(9858),p=d(1985),w=d(5055),D=d(7953),C=d(591),R=d(5397),S=d(5196),K=d(8071),J=d(5334),V=d(3494);function te(W){if(W instanceof p.c)return W;if(null!=W){if((0,w.l)(W))return function Y(W){return new p.c(x=>{const X=W[V.s]();if((0,K.T)(X.subscribe))return X.subscribe(x);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(W);if((0,v.X)(W))return function se(W){return new p.c(x=>{for(let X=0;X<W.length&&!x.closed;X++)x.next(W[X]);x.complete()})}(W);if((0,u.y)(W))return function pe(W){return new p.c(x=>{W.then(X=>{x.closed||(x.next(X),x.complete())},X=>x.error(X)).then(null,J.m)})}(W);if((0,D.T)(W))return fe(W);if((0,R.x)(W))return function ue(W){return new p.c(x=>{for(const X of W)if(x.next(X),x.closed)return;x.complete()})}(W);if((0,S.U)(W))return function ye(W){return fe((0,S.C)(W))}(W)}throw(0,C.L)(W)}function fe(W){return new p.c(x=>{(function q(W,x){var X,de,Te,Ue;return(0,f.sH)(this,void 0,void 0,function*(){try{for(X=(0,f.xN)(W);!(de=yield X.next()).done;)if(x.next(de.value),x.closed)return}catch(Be){Te={error:Be}}finally{try{de&&!de.done&&(Ue=X.return)&&(yield Ue.call(X))}finally{if(Te)throw Te.error}}x.complete()})})(W,x).catch(X=>x.error(X))})}},1807:(F,P,d)=>{d.d(P,{O:()=>w});var f=d(1985),v=d(3236),u=d(9470),p=d(8211);function w(D=0,C,R=v.b){let S=-1;return null!=C&&((0,u.m)(C)?R=C:S=C),new f.c(K=>{let J=(0,p.v)(D)?+D-R.now():D;J<0&&(J=0);let V=0;return R.schedule(function(){K.closed||(K.next(V++),0<=S?this.schedule(void 0,S):K.complete())},J)})}},4360:(F,P,d)=>{d.d(P,{H:()=>u,_:()=>v});var f=d(7707);function v(p,w,D,C,R){return new u(p,w,D,C,R)}class u extends f.vU{constructor(w,D,C,R,S,K){super(w),this.onFinalize=S,this.shouldUnsubscribe=K,this._next=D?function(J){try{D(J)}catch(V){w.error(V)}}:super._next,this._error=R?function(J){try{R(J)}catch(V){w.error(V)}finally{this.unsubscribe()}}:super._error,this._complete=C?function(){try{C()}catch(J){w.error(J)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var w;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:D}=this;super.unsubscribe(),!D&&(null===(w=this.onFinalize)||void 0===w||w.call(this))}}}},9437:(F,P,d)=>{d.d(P,{W:()=>p});var f=d(8750),v=d(4360),u=d(9974);function p(w){return(0,u.N)((D,C)=>{let K,R=null,S=!1;R=D.subscribe((0,v._)(C,void 0,void 0,J=>{K=(0,f.Tg)(w(J,p(w)(D))),R?(R.unsubscribe(),R=null,K.subscribe(C)):S=!0})),S&&(R.unsubscribe(),R=null,K.subscribe(C))})}},9131:(F,P,d)=>{d.d(P,{K:()=>v});var f=d(6365);function v(){return(0,f.U)(1)}},3103:(F,P,d)=>{d.d(P,{c:()=>p});var f=d(3236),v=d(3183),u=d(1807);function p(w,D=f.E){const C=(0,u.O)(w,D);return(0,v.o)(()=>C)}},3183:(F,P,d)=>{d.d(P,{o:()=>C});var f=d(2688),v=d(6697),u=d(3557),p=d(3703),w=d(3028),D=d(8750);function C(R,S){return S?K=>(0,f.x)(S.pipe((0,v.s)(1),(0,u.w)()),K.pipe(C(R))):(0,w.Z)((K,J)=>(0,D.Tg)(R(K,J)).pipe((0,v.s)(1),(0,p.u)(K)))}},3557:(F,P,d)=>{d.d(P,{w:()=>p});var f=d(9974),v=d(4360),u=d(5343);function p(){return(0,f.N)((w,D)=>{w.subscribe((0,v._)(D,u.l))})}},6354:(F,P,d)=>{d.d(P,{T:()=>u});var f=d(9974),v=d(4360);function u(p,w){return(0,f.N)((D,C)=>{let R=0;D.subscribe((0,v._)(C,S=>{C.next(p.call(w,S,R++))}))})}},3703:(F,P,d)=>{d.d(P,{u:()=>v});var f=d(6354);function v(u){return(0,f.T)(()=>u)}},6365:(F,P,d)=>{d.d(P,{U:()=>u});var f=d(3028),v=d(3669);function u(p=1/0){return(0,f.Z)(v.D,p)}},5412:(F,P,d)=>{d.d(P,{h:()=>p});var f=d(8750),v=d(5225),u=d(4360);function p(w,D,C,R,S,K,J,V){const te=[];let Y=0,se=0,pe=!1;const ue=()=>{pe&&!te.length&&!Y&&D.complete()},fe=q=>Y<R?ye(q):te.push(q),ye=q=>{K&&D.next(q),Y++;let W=!1;(0,f.Tg)(C(q,se++)).subscribe((0,u._)(D,x=>{S?.(x),K?fe(x):D.next(x)},()=>{W=!0},void 0,()=>{if(W)try{for(Y--;te.length&&Y<R;){const x=te.shift();J?(0,v.N)(D,J,()=>ye(x)):ye(x)}ue()}catch(x){D.error(x)}}))};return w.subscribe((0,u._)(D,fe,()=>{pe=!0,ue()})),()=>{V?.()}}},3028:(F,P,d)=>{d.d(P,{Z:()=>D});var f=d(6354),v=d(8750),u=d(9974),p=d(5412),w=d(8071);function D(C,R,S=1/0){return(0,w.T)(R)?D((K,J)=>(0,f.T)((V,te)=>R(K,V,J,te))((0,v.Tg)(C(K,J))),S):("number"==typeof R&&(S=R),(0,u.N)((K,J)=>(0,p.h)(K,J,C,S)))}},941:(F,P,d)=>{d.d(P,{Q:()=>p});var f=d(5225),v=d(9974),u=d(4360);function p(w,D=0){return(0,v.N)((C,R)=>{C.subscribe((0,u._)(R,S=>(0,f.N)(R,w,()=>R.next(S),D),()=>(0,f.N)(R,w,()=>R.complete(),D),S=>(0,f.N)(R,w,()=>R.error(S),D)))})}},6745:(F,P,d)=>{d.d(P,{_:()=>v});var f=d(9974);function v(u,p=0){return(0,f.N)((w,D)=>{D.add(u.schedule(()=>w.subscribe(D),p))})}},6697:(F,P,d)=>{d.d(P,{s:()=>p});var f=d(983),v=d(9974),u=d(4360);function p(w){return w<=0?()=>f.w:(0,v.N)((D,C)=>{let R=0;D.subscribe((0,u._)(C,S=>{++R<=w&&(C.next(S),w<=R&&C.complete())}))})}},7119:(F,P,d)=>{d.d(P,{S:()=>w});var f=d(1985),v=d(4761),u=d(8071),p=d(5225);function w(D,C){return new f.c(R=>{let S;return(0,p.N)(R,C,()=>{S=D[v.l](),(0,p.N)(R,C,()=>{let K,J;try{({value:K,done:J}=S.next())}catch(V){return void R.error(V)}J?R.complete():R.next(K)},0,!0)}),()=>(0,u.T)(S?.return)&&S.return()})}},5894:(F,P,d)=>{d.d(P,{c:()=>ye});var f=d(8750),v=d(941),u=d(6745),D=d(1985),R=d(7119),S=d(5225);function K(q,W){if(!q)throw new Error("Iterable cannot be null");return new D.c(x=>{(0,S.N)(x,W,()=>{const X=q[Symbol.asyncIterator]();(0,S.N)(x,W,()=>{X.next().then(de=>{de.done?x.complete():x.next(de.value)})},0,!0)})})}var J=d(5055),V=d(9858),te=d(7441),Y=d(5397),se=d(7953),pe=d(591),ue=d(5196);function ye(q,W){if(null!=q){if((0,J.l)(q))return function p(q,W){return(0,f.Tg)(q).pipe((0,u._)(W),(0,v.Q)(W))}(q,W);if((0,te.X)(q))return function C(q,W){return new D.c(x=>{let X=0;return W.schedule(function(){X===q.length?x.complete():(x.next(q[X++]),x.closed||this.schedule())})})}(q,W);if((0,V.y)(q))return function w(q,W){return(0,f.Tg)(q).pipe((0,u._)(W),(0,v.Q)(W))}(q,W);if((0,se.T)(q))return K(q,W);if((0,Y.x)(q))return(0,R.S)(q,W);if((0,ue.U)(q))return function fe(q,W){return K((0,ue.C)(q),W)}(q,W)}throw(0,pe.L)(q)}},6780:(F,P,d)=>{d.d(P,{R:()=>w});var f=d(3961);class v extends f.yU{constructor(C,R){super()}schedule(C,R=0){return this}}const u={setInterval(D,C,...R){const{delegate:S}=u;return S?.setInterval?S.setInterval(D,C,...R):setInterval(D,C,...R)},clearInterval(D){const{delegate:C}=u;return(C?.clearInterval||clearInterval)(D)},delegate:void 0};var p=d(7908);class w extends v{constructor(C,R){super(C,R),this.scheduler=C,this.work=R,this.pending=!1}schedule(C,R=0){var S;if(this.closed)return this;this.state=C;const K=this.id,J=this.scheduler;return null!=K&&(this.id=this.recycleAsyncId(J,K,R)),this.pending=!0,this.delay=R,this.id=null!==(S=this.id)&&void 0!==S?S:this.requestAsyncId(J,this.id,R),this}requestAsyncId(C,R,S=0){return u.setInterval(C.flush.bind(C,this),S)}recycleAsyncId(C,R,S=0){if(null!=S&&this.delay===S&&!1===this.pending)return R;null!=R&&u.clearInterval(R)}execute(C,R){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const S=this._execute(C,R);if(S)return S;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(C,R){let K,S=!1;try{this.work(C)}catch(J){S=!0,K=J||new Error("Scheduled action threw falsy error")}if(S)return this.unsubscribe(),K}unsubscribe(){if(!this.closed){const{id:C,scheduler:R}=this,{actions:S}=R;this.work=this.state=this.scheduler=null,this.pending=!1,(0,p.o)(S,this),null!=C&&(this.id=this.recycleAsyncId(R,C,null)),this.delay=null,super.unsubscribe()}}}},707:(F,P,d)=>{d.d(P,{q:()=>v});var f=d(8399);class v extends f._{constructor(p,w=f._.now){super(p,w),this.actions=[],this._active=!1}flush(p){const{actions:w}=this;if(this._active)return void w.push(p);let D;this._active=!0;do{if(D=p.execute(p.state,p.delay))break}while(p=w.shift());if(this._active=!1,D){for(;p=w.shift();)p.unsubscribe();throw D}}}},3236:(F,P,d)=>{d.d(P,{E:()=>u,b:()=>p});var f=d(6780);const u=new(d(707).q)(f.R),p=u},6129:(F,P,d)=>{d.d(P,{U:()=>f});const f={now:()=>(f.delegate||Date).now(),delegate:void 0}},9270:(F,P,d)=>{d.d(P,{f:()=>f});const f={setTimeout(v,u,...p){const{delegate:w}=f;return w?.setTimeout?w.setTimeout(v,u,...p):setTimeout(v,u,...p)},clearTimeout(v){const{delegate:u}=f;return(u?.clearTimeout||clearTimeout)(v)},delegate:void 0}},4761:(F,P,d)=>{d.d(P,{l:()=>v});const v=function f(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},3494:(F,P,d)=>{d.d(P,{s:()=>f});const f="function"==typeof Symbol&&Symbol.observable||"@@observable"},4079:(F,P,d)=>{d.d(P,{Z:()=>v});const v=(0,d(1853).L)(u=>function(w){u(this),this.message=w?`${w.length} errors occurred during unsubscription:\n${w.map((D,C)=>`${C+1}) ${D.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=w})},9326:(F,P,d)=>{d.d(P,{R0:()=>D,lI:()=>w,ms:()=>p});var f=d(8071),v=d(9470);function u(C){return C[C.length-1]}function p(C){return(0,f.T)(u(C))?C.pop():void 0}function w(C){return(0,v.m)(u(C))?C.pop():void 0}function D(C,R){return"number"==typeof u(C)?C.pop():R}},7908:(F,P,d)=>{function f(v,u){if(v){const p=v.indexOf(u);0<=p&&v.splice(p,1)}}d.d(P,{o:()=>f})},1853:(F,P,d)=>{function f(v){const p=v(w=>{Error.call(w),w.stack=(new Error).stack});return p.prototype=Object.create(Error.prototype),p.prototype.constructor=p,p}d.d(P,{L:()=>f})},9786:(F,P,d)=>{d.d(P,{Y:()=>u,l:()=>p});var f=d(1026);let v=null;function u(w){if(f.$.useDeprecatedSynchronousErrorHandling){const D=!v;if(D&&(v={errorThrown:!1,error:null}),w(),D){const{errorThrown:C,error:R}=v;if(v=null,C)throw R}}else w()}function p(w){f.$.useDeprecatedSynchronousErrorHandling&&v&&(v.errorThrown=!0,v.error=w)}},5225:(F,P,d)=>{function f(v,u,p,w=0,D=!1){const C=u.schedule(function(){p(),D?v.add(this.schedule(null,w)):this.unsubscribe()},w);if(v.add(C),!D)return C}d.d(P,{N:()=>f})},3669:(F,P,d)=>{function f(v){return v}d.d(P,{D:()=>f})},7441:(F,P,d)=>{d.d(P,{X:()=>f});const f=v=>v&&"number"==typeof v.length&&"function"!=typeof v},7953:(F,P,d)=>{d.d(P,{T:()=>v});var f=d(8071);function v(u){return Symbol.asyncIterator&&(0,f.T)(u?.[Symbol.asyncIterator])}},8211:(F,P,d)=>{function f(v){return v instanceof Date&&!isNaN(v)}d.d(P,{v:()=>f})},8071:(F,P,d)=>{function f(v){return"function"==typeof v}d.d(P,{T:()=>f})},5055:(F,P,d)=>{d.d(P,{l:()=>u});var f=d(3494),v=d(8071);function u(p){return(0,v.T)(p[f.s])}},5397:(F,P,d)=>{d.d(P,{x:()=>u});var f=d(4761),v=d(8071);function u(p){return(0,v.T)(p?.[f.l])}},9858:(F,P,d)=>{d.d(P,{y:()=>v});var f=d(8071);function v(u){return(0,f.T)(u?.then)}},5196:(F,P,d)=>{d.d(P,{C:()=>u,U:()=>p});var f=d(1635),v=d(8071);function u(w){return(0,f.AQ)(this,arguments,function*(){const C=w.getReader();try{for(;;){const{value:R,done:S}=yield(0,f.N3)(C.read());if(S)return yield(0,f.N3)(void 0);yield yield(0,f.N3)(R)}}finally{C.releaseLock()}})}function p(w){return(0,v.T)(w?.getReader)}},9470:(F,P,d)=>{d.d(P,{m:()=>v});var f=d(8071);function v(u){return u&&(0,f.T)(u.schedule)}},9974:(F,P,d)=>{d.d(P,{N:()=>u,S:()=>v});var f=d(8071);function v(p){return(0,f.T)(p?.lift)}function u(p){return w=>{if(v(w))return w.lift(function(D){try{return p(D,this)}catch(C){this.error(C)}});throw new TypeError("Unable to lift unknown Observable type")}}},5343:(F,P,d)=>{function f(){}d.d(P,{l:()=>f})},1203:(F,P,d)=>{d.d(P,{F:()=>v,m:()=>u});var f=d(3669);function v(...p){return u(p)}function u(p){return 0===p.length?f.D:1===p.length?p[0]:function(D){return p.reduce((C,R)=>R(C),D)}}},5334:(F,P,d)=>{d.d(P,{m:()=>u});var f=d(1026),v=d(9270);function u(p){v.f.setTimeout(()=>{const{onUnhandledError:w}=f.$;if(!w)throw p;w(p)})}},591:(F,P,d)=>{function f(v){return new TypeError(`You provided ${null!==v&&"object"==typeof v?"an invalid object":`'${v}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}d.d(P,{L:()=>f})},467:(F,P,d)=>{function f(u,p,w,D,C,R,S){try{var K=u[R](S),J=K.value}catch(V){return void w(V)}K.done?p(J):Promise.resolve(J).then(D,C)}function v(u){return function(){var p=this,w=arguments;return new Promise(function(D,C){var R=u.apply(p,w);function S(J){f(R,D,C,S,K,"next",J)}function K(J){f(R,D,C,S,K,"throw",J)}S(void 0)})}}d.d(P,{A:()=>v})},1635:(F,P,d)=>{function V(y,_,b,A){return new(b||(b=Promise))(function(j,Z){function re(he){try{Q(A.next(he))}catch(ge){Z(ge)}}function Ae(he){try{Q(A.throw(he))}catch(ge){Z(ge)}}function Q(he){he.done?j(he.value):function M(j){return j instanceof b?j:new b(function(Z){Z(j)})}(he.value).then(re,Ae)}Q((A=A.apply(y,_||[])).next())})}function W(y){return this instanceof W?(this.v=y,this):new W(y)}function x(y,_,b){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var M,A=b.apply(y,_||[]),j=[];return M=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),re("next"),re("throw"),re("return",function Z(oe){return function(xe){return Promise.resolve(xe).then(oe,ge)}}),M[Symbol.asyncIterator]=function(){return this},M;function re(oe,xe){A[oe]&&(M[oe]=function(je){return new Promise(function(Ne,$e){j.push([oe,je,Ne,$e])>1||Ae(oe,je)})},xe&&(M[oe]=xe(M[oe])))}function Ae(oe,xe){try{!function Q(oe){oe.value instanceof W?Promise.resolve(oe.value.v).then(he,ge):Ve(j[0][2],oe)}(A[oe](xe))}catch(je){Ve(j[0][3],je)}}function he(oe){Ae("next",oe)}function ge(oe){Ae("throw",oe)}function Ve(oe,xe){oe(xe),j.shift(),j.length&&Ae(j[0][0],j[0][1])}}function de(y){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var b,_=y[Symbol.asyncIterator];return _?_.call(y):(y=function pe(y){var _="function"==typeof Symbol&&Symbol.iterator,b=_&&y[_],A=0;if(b)return b.call(y);if(y&&"number"==typeof y.length)return{next:function(){return y&&A>=y.length&&(y=void 0),{value:y&&y[A++],done:!y}}};throw new TypeError(_?"Object is not iterable.":"Symbol.iterator is not defined.")}(y),b={},A("next"),A("throw"),A("return"),b[Symbol.asyncIterator]=function(){return this},b);function A(j){b[j]=y[j]&&function(Z){return new Promise(function(re,Ae){!function M(j,Z,re,Ae){Promise.resolve(Ae).then(function(Q){j({value:Q,done:re})},Z)}(re,Ae,(Z=y[j](Z)).done,Z.value)})}}}d.d(P,{AQ:()=>x,N3:()=>W,sH:()=>V,xN:()=>de}),"function"==typeof SuppressedError&&SuppressedError}}]);